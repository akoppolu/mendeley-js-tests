'use strict';

var _regeneratorRuntime = require('babel-runtime/regenerator')['default'];

var _interopRequireDefault = require('babel-runtime/helpers/interop-require-default')['default'];

var _this = this;

var _wd = require('wd');

var _wd2 = _interopRequireDefault(_wd);

var _chai = require('chai');

var _chai2 = _interopRequireDefault(_chai);

var _chaiAsPromised = require('chai-as-promised');

var _chaiAsPromised2 = _interopRequireDefault(_chaiAsPromised);

var _libServer = require('../../lib/server');

_chai2['default'].should();
_chai2['default'].use(_chaiAsPromised2['default']);

var TEST_PORT = 4788;
var TEST_HOST = "localhost";

var server = undefined,
    driver = undefined;

describe('Driver', function () {
  before(function callee$1$0() {
    return _regeneratorRuntime.async(function callee$1$0$(context$2$0) {
      while (1) switch (context$2$0.prev = context$2$0.next) {
        case 0:
          context$2$0.next = 2;
          return _regeneratorRuntime.awrap((0, _libServer.startServer)(TEST_PORT, TEST_HOST));

        case 2:
          server = context$2$0.sent;

        case 3:
        case 'end':
          return context$2$0.stop();
      }
    }, null, _this);
  });

  after(function callee$1$0() {
    return _regeneratorRuntime.async(function callee$1$0$(context$2$0) {
      while (1) switch (context$2$0.prev = context$2$0.next) {
        case 0:
          context$2$0.next = 2;
          return _regeneratorRuntime.awrap(server.close());

        case 2:
        case 'end':
          return context$2$0.stop();
      }
    }, null, _this);
  });

  beforeEach(function callee$1$0() {
    return _regeneratorRuntime.async(function callee$1$0$(context$2$0) {
      while (1) switch (context$2$0.prev = context$2$0.next) {
        case 0:
          driver = _wd2['default'].promiseChainRemote(TEST_HOST, TEST_PORT);

        case 1:
        case 'end':
          return context$2$0.stop();
      }
    }, null, _this);
  });

  afterEach(function callee$1$0() {
    return _regeneratorRuntime.async(function callee$1$0$(context$2$0) {
      while (1) switch (context$2$0.prev = context$2$0.next) {
        case 0:
          context$2$0.next = 2;
          return _regeneratorRuntime.awrap(driver.quit());

        case 2:
        case 'end':
          return context$2$0.stop();
      }
    }, null, _this);
  });

  it('should run a basic session using a real client', function callee$1$0() {
    var button;
    return _regeneratorRuntime.async(function callee$1$0$(context$2$0) {
      while (1) switch (context$2$0.prev = context$2$0.next) {
        case 0:
          context$2$0.next = 2;
          return _regeneratorRuntime.awrap(driver.init({
            app: "Calculator",
            platformName: "Mac",
            deviceName: "Mac"
          }));

        case 2:
          context$2$0.next = 4;
          return _regeneratorRuntime.awrap(driver.elementByXPath("/AXApplication[@AXTitle='Calculator']/AXWindow[0]/AXGroup[1]/AXButton[@AXDescription='nine']"));

        case 4:
          button = context$2$0.sent;
          context$2$0.next = 7;
          return _regeneratorRuntime.awrap(button.click());

        case 7:
        case 'end':
          return context$2$0.stop();
      }
    }, null, _this);
  });
});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInRlc3QvZTJlL2RyaXZlci1lMmUtc3BlY3MuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7a0JBQWUsSUFBSTs7OztvQkFDRixNQUFNOzs7OzhCQUNJLGtCQUFrQjs7Ozt5QkFDakIsa0JBQWtCOztBQUM5QyxrQkFBSyxNQUFNLEVBQUUsQ0FBQztBQUNkLGtCQUFLLEdBQUcsNkJBQWdCLENBQUM7O0FBRXpCLElBQU0sU0FBUyxHQUFHLElBQUksQ0FBQztBQUN2QixJQUFNLFNBQVMsR0FBRyxXQUFXLENBQUM7O0FBRTlCLElBQUksTUFBTSxZQUFBO0lBQUUsTUFBTSxZQUFBLENBQUM7O0FBRW5CLFFBQVEsQ0FBQyxRQUFRLEVBQUUsWUFBTTtBQUN2QixRQUFNLENBQUM7Ozs7OzJDQUNVLDRCQUFZLFNBQVMsRUFBRSxTQUFTLENBQUM7OztBQUFoRCxnQkFBTTs7Ozs7OztHQUNQLENBQUMsQ0FBQzs7QUFFSCxPQUFLLENBQUM7Ozs7OzJDQUNFLE1BQU0sQ0FBQyxLQUFLLEVBQUU7Ozs7Ozs7R0FDckIsQ0FBQyxDQUFDOztBQUVILFlBQVUsQ0FBQzs7OztBQUNULGdCQUFNLEdBQUcsZ0JBQUcsa0JBQWtCLENBQUMsU0FBUyxFQUFFLFNBQVMsQ0FBQyxDQUFDOzs7Ozs7O0dBQ3RELENBQUMsQ0FBQzs7QUFFSCxXQUFTLENBQUM7Ozs7OzJDQUNGLE1BQU0sQ0FBQyxJQUFJLEVBQUU7Ozs7Ozs7R0FDcEIsQ0FBQyxDQUFDOztBQUVILElBQUUsQ0FBQyxnREFBZ0QsRUFBRTtRQU0vQyxNQUFNOzs7OzsyQ0FMSixNQUFNLENBQUMsSUFBSSxDQUFDO0FBQ2hCLGVBQUcsRUFBRSxZQUFZO0FBQ2pCLHdCQUFZLEVBQUUsS0FBSztBQUNuQixzQkFBVSxFQUFFLEtBQUs7V0FDbEIsQ0FBQzs7OzsyQ0FDaUIsTUFBTSxDQUFDLGNBQWMsQ0FBQyw4RkFBOEYsQ0FBQzs7O0FBQXBJLGdCQUFNOzsyQ0FDSixNQUFNLENBQUMsS0FBSyxFQUFFOzs7Ozs7O0dBQ3JCLENBQUMsQ0FBQztDQUNKLENBQUMsQ0FBQyIsImZpbGUiOiJ0ZXN0L2UyZS9kcml2ZXItZTJlLXNwZWNzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHdkIGZyb20gJ3dkJztcbmltcG9ydCBjaGFpIGZyb20gJ2NoYWknO1xuaW1wb3J0IGNoYWlBc1Byb21pc2VkIGZyb20gJ2NoYWktYXMtcHJvbWlzZWQnO1xuaW1wb3J0IHsgc3RhcnRTZXJ2ZXIgfSBmcm9tICcuLi8uLi9saWIvc2VydmVyJztcbmNoYWkuc2hvdWxkKCk7XG5jaGFpLnVzZShjaGFpQXNQcm9taXNlZCk7XG5cbmNvbnN0IFRFU1RfUE9SVCA9IDQ3ODg7XG5jb25zdCBURVNUX0hPU1QgPSBcImxvY2FsaG9zdFwiO1xuXG5sZXQgc2VydmVyLCBkcml2ZXI7XG5cbmRlc2NyaWJlKCdEcml2ZXInLCAoKSA9PiB7XG4gIGJlZm9yZShhc3luYyAoKSA9PiB7XG4gICAgc2VydmVyID0gYXdhaXQgc3RhcnRTZXJ2ZXIoVEVTVF9QT1JULCBURVNUX0hPU1QpO1xuICB9KTtcblxuICBhZnRlcihhc3luYyAoKSA9PiB7XG4gICAgYXdhaXQgc2VydmVyLmNsb3NlKCk7XG4gIH0pO1xuXG4gIGJlZm9yZUVhY2goYXN5bmMgKCkgPT4ge1xuICAgIGRyaXZlciA9IHdkLnByb21pc2VDaGFpblJlbW90ZShURVNUX0hPU1QsIFRFU1RfUE9SVCk7XG4gIH0pO1xuXG4gIGFmdGVyRWFjaChhc3luYyAoKSA9PiB7XG4gICAgYXdhaXQgZHJpdmVyLnF1aXQoKTtcbiAgfSk7XG5cbiAgaXQoJ3Nob3VsZCBydW4gYSBiYXNpYyBzZXNzaW9uIHVzaW5nIGEgcmVhbCBjbGllbnQnLCBhc3luYyAoKSA9PiB7XG4gICAgYXdhaXQgZHJpdmVyLmluaXQoe1xuICAgICAgYXBwOiBcIkNhbGN1bGF0b3JcIixcbiAgICAgIHBsYXRmb3JtTmFtZTogXCJNYWNcIixcbiAgICAgIGRldmljZU5hbWU6IFwiTWFjXCIsXG4gICAgfSk7XG4gICAgbGV0IGJ1dHRvbiA9IGF3YWl0IGRyaXZlci5lbGVtZW50QnlYUGF0aChcIi9BWEFwcGxpY2F0aW9uW0BBWFRpdGxlPSdDYWxjdWxhdG9yJ10vQVhXaW5kb3dbMF0vQVhHcm91cFsxXS9BWEJ1dHRvbltAQVhEZXNjcmlwdGlvbj0nbmluZSddXCIpO1xuICAgIGF3YWl0IGJ1dHRvbi5jbGljaygpO1xuICB9KTtcbn0pO1xuIl0sInNvdXJjZVJvb3QiOiIuLi8uLi8uLiJ9
