'use strict';

var _regeneratorRuntime = require('babel-runtime/regenerator')['default'];

var _interopRequireDefault = require('babel-runtime/helpers/interop-require-default')['default'];

var _helpersEnv = require('../helpers/env');

var _helpersEnv2 = _interopRequireDefault(_helpersEnv);

var _setupBase = require("../setup-base");

var _setupBase2 = _interopRequireDefault(_setupBase);

var _desired = require('./desired');

var _desired2 = _interopRequireDefault(_desired);

var _lodash = require('lodash');

var _lodash2 = _interopRequireDefault(_lodash);

describe('uicatalog - basic', function () {
  var textTag = _helpersEnv2['default'].IOS7 ? '@label' : '@value';

  describe('api', function () {
    var _this = this;

    var session = (0, _setupBase2['default'])(this, _desired2['default']);
    var driver = session.driver;

    describe('getStrings', function () {
      it('should return default strings', function callee$3$0() {
        var strings;
        return _regeneratorRuntime.async(function callee$3$0$(context$4$0) {
          while (1) switch (context$4$0.prev = context$4$0.next) {
            case 0:
              context$4$0.next = 2;
              return _regeneratorRuntime.awrap(driver.getStrings());

            case 2:
              strings = context$4$0.sent;

              _lodash2['default'].keys(strings).length.should.be.above(10);

            case 4:
            case 'end':
              return context$4$0.stop();
          }
        }, null, _this);
      });
      it('should return English strings', function callee$3$0() {
        var strings;
        return _regeneratorRuntime.async(function callee$3$0$(context$4$0) {
          while (1) switch (context$4$0.prev = context$4$0.next) {
            case 0:
              context$4$0.next = 2;
              return _regeneratorRuntime.awrap(driver.getStrings('en'));

            case 2:
              strings = context$4$0.sent;

              _lodash2['default'].keys(strings).length.should.be.above(10);

            case 4:
            case 'end':
              return context$4$0.stop();
          }
        }, null, _this);
      });
      it('should return English strings with string file', function callee$3$0() {
        var strings;
        return _regeneratorRuntime.async(function callee$3$0$(context$4$0) {
          while (1) switch (context$4$0.prev = context$4$0.next) {
            case 0:
              context$4$0.next = 2;
              return _regeneratorRuntime.awrap(driver.getStrings('en', 'Localizable.strings'));

            case 2:
              strings = context$4$0.sent;

              _lodash2['default'].keys(strings).length.should.be.above(10);

            case 4:
            case 'end':
              return context$4$0.stop();
          }
        }, null, _this);
      });
    });

    describe('elements', function () {
      beforeEach(function callee$3$0() {
        return _regeneratorRuntime.async(function callee$3$0$(context$4$0) {
          while (1) switch (context$4$0.prev = context$4$0.next) {
            case 0:
              context$4$0.prev = 0;
              context$4$0.next = 3;
              return _regeneratorRuntime.awrap(driver.back());

            case 3:
              context$4$0.next = 7;
              break;

            case 5:
              context$4$0.prev = 5;
              context$4$0.t0 = context$4$0['catch'](0);

            case 7:
            case 'end':
              return context$4$0.stop();
          }
        }, null, _this, [[0, 5]]);
      });

      it('should confirm element is not visible', function callee$3$0() {
        var el1, el2;
        return _regeneratorRuntime.async(function callee$3$0$(context$4$0) {
          while (1) switch (context$4$0.prev = context$4$0.next) {
            case 0:
              context$4$0.next = 2;
              return _regeneratorRuntime.awrap(driver.findElement('xpath', '//UIAStaticText[contains(' + textTag + ', \'Buttons\')]'));

            case 2:
              el1 = context$4$0.sent;
              context$4$0.next = 5;
              return _regeneratorRuntime.awrap(driver.click(el1));

            case 5:
              context$4$0.next = 7;
              return _regeneratorRuntime.awrap(driver.findElement('xpath', "//UIANavigationBar/UIAImage"));

            case 7:
              el2 = context$4$0.sent;
              context$4$0.next = 10;
              return _regeneratorRuntime.awrap(driver.elementDisplayed(el2));

            case 10:
              context$4$0.sent.should.not.be.ok;

            case 11:
            case 'end':
              return context$4$0.stop();
          }
        }, null, _this);
      });

      it('should confirm element is visible', function callee$3$0() {
        var el1, el2;
        return _regeneratorRuntime.async(function callee$3$0$(context$4$0) {
          while (1) switch (context$4$0.prev = context$4$0.next) {
            case 0:
              context$4$0.next = 2;
              return _regeneratorRuntime.awrap(driver.findElement('xpath', '//UIAStaticText[contains(' + textTag + ', \'Buttons\')]'));

            case 2:
              el1 = context$4$0.sent;
              context$4$0.next = 5;
              return _regeneratorRuntime.awrap(driver.click(el1));

            case 5:
              context$4$0.next = 7;
              return _regeneratorRuntime.awrap(driver.findElement('xpath', "//UIATableGroup[@name = 'SYSTEM (CONTACT ADD)']"));

            case 7:
              el2 = context$4$0.sent;
              context$4$0.next = 10;
              return _regeneratorRuntime.awrap(driver.elementDisplayed(el2));

            case 10:
              context$4$0.sent.should.be.ok;

            case 11:
            case 'end':
              return context$4$0.stop();
          }
        }, null, _this);
      });

      it('should confirm element is selected', function callee$3$0() {
        var el1, el2;
        return _regeneratorRuntime.async(function callee$3$0$(context$4$0) {
          while (1) switch (context$4$0.prev = context$4$0.next) {
            case 0:
              context$4$0.next = 2;
              return _regeneratorRuntime.awrap(driver.execute("mobile: scroll", { direction: 'down' }));

            case 2:
              context$4$0.next = 4;
              return _regeneratorRuntime.awrap(driver.findElement('xpath', "//UIAStaticText[contains(@label, 'Switches')]"));

            case 4:
              el1 = context$4$0.sent;
              context$4$0.next = 7;
              return _regeneratorRuntime.awrap(driver.click(el1));

            case 7:
              context$4$0.next = 9;
              return _regeneratorRuntime.awrap(driver.findElement('class name', 'UIASwitch'));

            case 9:
              el2 = context$4$0.sent;
              context$4$0.next = 12;
              return _regeneratorRuntime.awrap(driver.elementSelected(el2));

            case 12:
              context$4$0.sent.should.be.ok;

            case 13:
            case 'end':
              return context$4$0.stop();
          }
        }, null, _this);
      });

      it('should confirm element is not selected returns false', function callee$3$0() {
        var el1, el2;
        return _regeneratorRuntime.async(function callee$3$0$(context$4$0) {
          while (1) switch (context$4$0.prev = context$4$0.next) {
            case 0:
              context$4$0.prev = 0;
              context$4$0.next = 3;
              return _regeneratorRuntime.awrap(driver.execute("mobile: scroll", { direction: 'down' }));

            case 3:
              context$4$0.next = 7;
              break;

            case 5:
              context$4$0.prev = 5;
              context$4$0.t0 = context$4$0['catch'](0);

            case 7:
              context$4$0.next = 9;
              return _regeneratorRuntime.awrap(driver.findElement('xpath', "//UIAStaticText[contains(@label, 'Switches')]"));

            case 9:
              el1 = context$4$0.sent;
              context$4$0.next = 12;
              return _regeneratorRuntime.awrap(driver.click(el1));

            case 12:
              context$4$0.next = 14;
              return _regeneratorRuntime.awrap(driver.findElement('class name', 'UIASwitch'));

            case 14:
              el2 = context$4$0.sent;
              context$4$0.next = 17;
              return _regeneratorRuntime.awrap(driver.click(el2));

            case 17:
              context$4$0.next = 19;
              return _regeneratorRuntime.awrap(driver.elementSelected(el2));

            case 19:
              context$4$0.sent.should.not.be.ok;

            case 20:
            case 'end':
              return context$4$0.stop();
          }
        }, null, _this, [[0, 5]]);
      });
    });
  });

  describe('appium ios @skip-ci', function () {
    var _this2 = this;

    // TODO: check this test, it does not do what it says
    var session = (0, _setupBase2['default'])(this, _desired2['default']);
    var driver = session.driver;

    it('should go back to using app from before', function callee$2$0() {
      var els;
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            context$3$0.next = 2;
            return _regeneratorRuntime.awrap(driver.findElements('class name', 'UIATableView'));

          case 2:
            els = context$3$0.sent;

            els.should.have.length.above(0);

          case 4:
          case 'end':
            return context$3$0.stop();
        }
      }, null, _this2);
    });
  });
});

// Instruments is broken in 8.1, 8.2, 8.3
// can't scroll if already scrolled all the way down
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInRlc3QvZTJlL3VpY2F0YWxvZy9iYXNpYy1zcGVjcy5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7MEJBQWdCLGdCQUFnQjs7Ozt5QkFDZCxlQUFlOzs7O3VCQUNiLFdBQVc7Ozs7c0JBQ2pCLFFBQVE7Ozs7QUFHdEIsUUFBUSxDQUFDLG1CQUFtQixFQUFFLFlBQU07QUFDbEMsTUFBSSxPQUFPLEdBQUcsd0JBQUksSUFBSSxHQUFHLFFBQVEsR0FBRyxRQUFRLENBQUM7O0FBRTdDLFVBQVEsQ0FBQyxLQUFLLEVBQUUsWUFBWTs7O0FBQzFCLFFBQUksT0FBTyxHQUFHLDRCQUFNLElBQUksdUJBQVUsQ0FBQztBQUNuQyxRQUFJLE1BQU0sR0FBRyxPQUFPLENBQUMsTUFBTSxDQUFDOztBQUU1QixZQUFRLENBQUMsWUFBWSxFQUFFLFlBQU07QUFDM0IsUUFBRSxDQUFDLCtCQUErQixFQUFFO1lBQzlCLE9BQU87Ozs7OytDQUFTLE1BQU0sQ0FBQyxVQUFVLEVBQUU7OztBQUFuQyxxQkFBTzs7QUFDWCxrQ0FBRSxJQUFJLENBQUMsT0FBTyxDQUFDLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxFQUFFLENBQUMsS0FBSyxDQUFDLEVBQUUsQ0FBQyxDQUFDOzs7Ozs7O09BQzVDLENBQUMsQ0FBQztBQUNILFFBQUUsQ0FBQywrQkFBK0IsRUFBRTtZQUM5QixPQUFPOzs7OzsrQ0FBUyxNQUFNLENBQUMsVUFBVSxDQUFDLElBQUksQ0FBQzs7O0FBQXZDLHFCQUFPOztBQUNYLGtDQUFFLElBQUksQ0FBQyxPQUFPLENBQUMsQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFDLEVBQUUsQ0FBQyxLQUFLLENBQUMsRUFBRSxDQUFDLENBQUM7Ozs7Ozs7T0FDNUMsQ0FBQyxDQUFDO0FBQ0gsUUFBRSxDQUFDLGdEQUFnRCxFQUFFO1lBQy9DLE9BQU87Ozs7OytDQUFTLE1BQU0sQ0FBQyxVQUFVLENBQUMsSUFBSSxFQUFFLHFCQUFxQixDQUFDOzs7QUFBOUQscUJBQU87O0FB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bkMsUUFBSSxNQUFNLEdBQUcsT0FBTyxDQUFDLE1BQU0sQ0FBQzs7QUFFNUIsTUFBRSxDQUFDLHlDQUF5QyxFQUFFO1VBQ3hDLEdBQUc7Ozs7OzZDQUFTLE1BQU0sQ0FBQyxZQUFZLENBQUMsWUFBWSxFQUFFLGNBQWMsQ0FBQzs7O0FBQTdELGVBQUc7O0FBQ1AsZUFBRyxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQzs7Ozs7OztLQUNqQyxDQUFDLENBQUM7R0FDSixDQUFDLENBQUM7Q0FFSixDQUFDLENBQUMiLCJmaWxlIjoidGVzdC9lMmUvdWljYXRhbG9nL2Jhc2ljLXNwZWNzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGVudiBmcm9tICcuLi9oZWxwZXJzL2Vudic7XG5pbXBvcnQgc2V0dXAgZnJvbSBcIi4uL3NldHVwLWJhc2VcIjtcbmltcG9ydCBkZXNpcmVkIGZyb20gJy4vZGVzaXJlZCc7XG5pbXBvcnQgXyBmcm9tICdsb2Rhc2gnO1xuXG5cbmRlc2NyaWJlKCd1aWNhdGFsb2cgLSBiYXNpYycsICgpID0+IHtcbiAgbGV0IHRleHRUYWcgPSBlbnYuSU9TNyA/ICdAbGFiZWwnIDogJ0B2YWx1ZSc7XG5cbiAgZGVzY3JpYmUoJ2FwaScsIGZ1bmN0aW9uICgpIHtcbiAgICBsZXQgc2Vzc2lvbiA9IHNldHVwKHRoaXMsIGRlc2lyZWQpO1xuICAgIGxldCBkcml2ZXIgPSBzZXNzaW9uLmRyaXZlcjtcblxuICAgIGRlc2NyaWJlKCdnZXRTdHJpbmdzJywgKCkgPT4ge1xuICAgICAgaXQoJ3Nob3VsZCByZXR1cm4gZGVmYXVsdCBzdHJpbmdzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgICBsZXQgc3RyaW5ncyA9IGF3YWl0IGRyaXZlci5nZXRTdHJpbmdzKCk7XG4gICAgICAgIF8ua2V5cyhzdHJpbmdzKS5sZW5ndGguc2hvdWxkLmJlLmFib3ZlKDEwKTtcbiAgICAgIH0pO1xuICAgICAgaXQoJ3Nob3VsZCByZXR1cm4gRW5nbGlzaCBzdHJpbmdzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgICBsZXQgc3RyaW5ncyA9IGF3YWl0IGRyaXZlci5nZXRTdHJpbmdzKCdlbicpO1xuICAgICAgICBfLmtleXMoc3RyaW5ncykubGVuZ3RoLnNob3VsZC5iZS5hYm92ZSgxMCk7XG4gICAgICB9KTtcbiAgICAgIGl0KCdzaG91bGQgcmV0dXJuIEVuZ2xpc2ggc3RyaW5ncyB3aXRoIHN0cmluZyBmaWxlJywgYXN5bmMgKCkgPT4ge1xuICAgICAgICBsZXQgc3RyaW5ncyA9IGF3YWl0IGRyaXZlci5nZXRTdHJpbmdzKCdlbicsICdMb2NhbGl6YWJsZS5zdHJpbmdzJyk7XG4gICAgICAgIF8ua2V5cyhzdHJpbmdzKS5sZW5ndGguc2hvdWxkLmJlLmFib3ZlKDEwKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgZGVzY3JpYmUoJ2VsZW1lbnRzJywgKCkgPT4ge1xuICAgICAgYmVmb3JlRWFjaChhc3luYyAoKSA9PiB7XG4gICAgICAgIHRyeSB7IGF3YWl0IGRyaXZlci5iYWNrKCk7IH0gY2F0Y2ggKGlnbikge31cbiAgICAgIH0pO1xuXG4gICAgICBpdCgnc2hvdWxkIGNvbmZpcm0gZWxlbWVudCBpcyBub3QgdmlzaWJsZScsIGFzeW5jICgpID0+IHtcbiAgICAgICAgbGV0IGVsMSA9IGF3YWl0IGRyaXZlci5maW5kRWxlbWVudCgneHBhdGgnLCBgLy9VSUFTdGF0aWNUZXh0W2NvbnRhaW5zKCR7dGV4dFRhZ30sICdCdXR0b25zJyldYCk7XG4gICAgICAgIGF3YWl0IGRyaXZlci5jbGljayhlbDEpO1xuICAgICAgICBsZXQgZWwyID0gYXdhaXQgZHJpdmVyLmZpbmRFbGVtZW50KCd4cGF0aCcsIFwiLy9VSUFOYXZpZ2F0aW9uQmFyL1VJQUltYWdlXCIpO1xuICAgICAgICAoYXdhaXQgZHJpdmVyLmVsZW1lbnREaXNwbGF5ZWQoZWwyKSkuc2hvdWxkLm5vdC5iZS5vaztcbiAgICAgIH0pO1xuXG4gICAgICBpdCgnc2hvdWxkIGNvbmZpcm0gZWxlbWVudCBpcyB2aXNpYmxlJywgYXN5bmMgKCkgPT4ge1xuICAgICAgICBsZXQgZWwxID0gYXdhaXQgZHJpdmVyLmZpbmRFbGVtZW50KCd4cGF0aCcsIGAvL1VJQVN0YXRpY1RleHRbY29udGFpbnMoJHt0ZXh0VGFnfSwgJ0J1dHRvbnMnKV1gKTtcbiAgICAgICAgYXdhaXQgZHJpdmVyLmNsaWNrKGVsMSk7XG4gICAgICAgIGxldCBlbDIgPSBhd2FpdCBkcml2ZXIuZmluZEVsZW1lbnQoJ3hwYXRoJywgXCIvL1VJQVRhYmxlR3JvdXBbQG5hbWUgPSAnU1lTVEVNIChDT05UQUNUIEFERCknXVwiKTtcbiAgICAgICAgKGF3YWl0IGRyaXZlci5lbGVtZW50RGlzcGxheWVkKGVsMikpLnNob3VsZC5iZS5vaztcbiAgICAgIH0pO1xuXG4gICAgICBpdCgnc2hvdWxkIGNvbmZpcm0gZWxlbWVudCBpcyBzZWxlY3RlZCcsIGFzeW5jICgpID0+IHtcbiAgICAgICAgYXdhaXQgZHJpdmVyLmV4ZWN1dGUoXCJtb2JpbGU6IHNjcm9sbFwiLCB7ZGlyZWN0aW9uOiAnZG93bid9KTtcbiAgICAgICAgbGV0IGVsMSA9IGF3YWl0IGRyaXZlci5maW5kRWxlbWVudCgneHBhdGgnLCBcIi8vVUlBU3RhdGljVGV4dFtjb250YWlucyhAbGFiZWwsICdTd2l0Y2hlcycpXVwiKTtcbiAgICAgICAgYXdhaXQgZHJpdmVyLmNsaWNrKGVsMSk7XG4gICAgICAgIGxldCBlbDIgPSBhd2FpdCBkcml2ZXIuZmluZEVsZW1lbnQoJ2NsYXNzIG5hbWUnLCAnVUlBU3dpdGNoJyk7XG4gICAgICAgIChhd2FpdCBkcml2ZXIuZWxlbWVudFNlbGVjdGVkKGVsMikpLnNob3VsZC5iZS5vaztcbiAgICAgIH0pO1xuXG4gICAgICBpdCgnc2hvdWxkIGNvbmZpcm0gZWxlbWVudCBpcyBub3Qgc2VsZWN0ZWQgcmV0dXJucyBmYWxzZScsIGFzeW5jICgpID0+IHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBhd2FpdCBkcml2ZXIuZXhlY3V0ZShcIm1vYmlsZTogc2Nyb2xsXCIsIHtkaXJlY3Rpb246ICdkb3duJ30pO1xuICAgICAgICB9IGNhdGNoIChpZ24pICB7XG4gICAgICAgICAgLy8gSW5zdHJ1bWVudHMgaXMgYnJva2VuIGluIDguMSwgOC4yLCA4LjNcbiAgICAgICAgICAvLyBjYW4ndCBzY3JvbGwgaWYgYWxyZWFkeSBzY3JvbGxlZCBhbGwgdGhlIHdheSBkb3duXG4gICAgICAgIH1cbiAgICAgICAgbGV0IGVsMSA9IGF3YWl0IGRyaXZlci5maW5kRWxlbWVudCgneHBhdGgnLCBcIi8vVUlBU3RhdGljVGV4dFtjb250YWlucyhAbGFiZWwsICdTd2l0Y2hlcycpXVwiKTtcbiAgICAgICAgYXdhaXQgZHJpdmVyLmNsaWNrKGVsMSk7XG4gICAgICAgIGxldCBlbDIgPSBhd2FpdCBkcml2ZXIuZmluZEVsZW1lbnQoJ2NsYXNzIG5hbWUnLCAnVUlBU3dpdGNoJyk7XG4gICAgICAgIGF3YWl0IGRyaXZlci5jbGljayhlbDIpO1xuICAgICAgICAoYXdhaXQgZHJpdmVyLmVsZW1lbnRTZWxlY3RlZChlbDIpKS5zaG91bGQubm90LmJlLm9rO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdhcHBpdW0gaW9zIEBza2lwLWNpJywgZnVuY3Rpb24gKCkge1xuICAgIC8vIFRPRE86IGNoZWNrIHRoaXMgdGVzdCwgaXQgZG9lcyBub3QgZG8gd2hhdCBpdCBzYXlzXG4gICAgbGV0IHNlc3Npb24gPSBzZXR1cCh0aGlzLCBkZXNpcmVkKTtcbiAgICBsZXQgZHJpdmVyID0gc2Vzc2lvbi5kcml2ZXI7XG5cbiAgICBpdCgnc2hvdWxkIGdvIGJhY2sgdG8gdXNpbmcgYXBwIGZyb20gYmVmb3JlJywgYXN5bmMgKCkgPT4ge1xuICAgICAgbGV0IGVscyA9IGF3YWl0IGRyaXZlci5maW5kRWxlbWVudHMoJ2NsYXNzIG5hbWUnLCAnVUlBVGFibGVWaWV3Jyk7XG4gICAgICBlbHMuc2hvdWxkLmhhdmUubGVuZ3RoLmFib3ZlKDApO1xuICAgIH0pO1xuICB9KTtcblxufSk7XG4iXSwic291cmNlUm9vdCI6Ii4uLy4uLy4uLy4uIn0=
