'use strict';

var _regeneratorRuntime = require('babel-runtime/regenerator')['default'];

var _getIterator = require('babel-runtime/core-js/get-iterator')['default'];

var _interopRequireDefault = require('babel-runtime/helpers/interop-require-default')['default'];

var _setupBase = require("../../setup-base");

var _setupBase2 = _interopRequireDefault(_setupBase);

var _desired = require('../desired');

var _desired2 = _interopRequireDefault(_desired);

var _helpersRecipes = require('../../helpers/recipes');

describe('testapp - basics - calc app 1', function () {
  var _this = this;

  var session = (0, _setupBase2['default'])(this, _desired2['default']);
  var driver = session.driver;

  var values = null;
  var byUIA = '-ios uiautomation';

  var clearFields = function clearFields() {
    var els, _iteratorNormalCompletion, _didIteratorError, _iteratorError, _iterator, _step, el, button;

    return _regeneratorRuntime.async(function clearFields$(context$2$0) {
      while (1) switch (context$2$0.prev = context$2$0.next) {
        case 0:
          values = [];
          context$2$0.next = 3;
          return _regeneratorRuntime.awrap(driver.findElements('class name', 'UIATextField'));

        case 3:
          els = context$2$0.sent;
          _iteratorNormalCompletion = true;
          _didIteratorError = false;
          _iteratorError = undefined;
          context$2$0.prev = 7;
          _iterator = _getIterator(els);

        case 9:
          if (_iteratorNormalCompletion = (_step = _iterator.next()).done) {
            context$2$0.next = 16;
            break;
          }

          el = _step.value;
          context$2$0.next = 13;
          return _regeneratorRuntime.awrap(driver.clear(el));

        case 13:
          _iteratorNormalCompletion = true;
          context$2$0.next = 9;
          break;

        case 16:
          context$2$0.next = 22;
          break;

        case 18:
          context$2$0.prev = 18;
          context$2$0.t0 = context$2$0['catch'](7);
          _didIteratorError = true;
          _iteratorError = context$2$0.t0;

        case 22:
          context$2$0.prev = 22;
          context$2$0.prev = 23;

          if (!_iteratorNormalCompletion && _iterator['return']) {
            _iterator['return']();
          }

        case 25:
          context$2$0.prev = 25;

          if (!_didIteratorError) {
            context$2$0.next = 28;
            break;
          }

          throw _iteratorError;

        case 28:
          return context$2$0.finish(25);

        case 29:
          return context$2$0.finish(22);

        case 30:
          context$2$0.next = 32;
          return _regeneratorRuntime.awrap(driver.findElement('class name', 'UIAButton'));

        case 32:
          button = context$2$0.sent;
          context$2$0.next = 35;
          return _regeneratorRuntime.awrap(driver.click(button));

        case 35:
        case 'end':
          return context$2$0.stop();
      }
    }, null, this, [[7, 18, 22, 30], [23,, 25, 29]]);
  };

  var populate = function populate(type) {
    var els, _iteratorNormalCompletion2, _didIteratorError2, _iteratorError2, _iterator2, _step2, el, val;

    return _regeneratorRuntime.async(function populate$(context$2$0) {
      while (1) switch (context$2$0.prev = context$2$0.next) {
        case 0:
          values = [];
          context$2$0.next = 3;
          return _regeneratorRuntime.awrap(driver.findElements(byUIA, (0, _helpersRecipes.filterVisibleUiaSelector)('.textFields();')));

        case 3:
          els = context$2$0.sent;
          _iteratorNormalCompletion2 = true;
          _didIteratorError2 = false;
          _iteratorError2 = undefined;
          context$2$0.prev = 7;
          _iterator2 = _getIterator(els);

        case 9:
          if (_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done) {
            context$2$0.next = 31;
            break;
          }

          el = _step2.value;
          val = Math.round(Math.random() * 10);

          values.push(val);

          if (!(type === "elem")) {
            context$2$0.next = 18;
            break;
          }

          context$2$0.next = 16;
          return _regeneratorRuntime.awrap(driver.setValue(val, el));

        case 16:
          context$2$0.next = 28;
          break;

        case 18:
          if (!(type === "elem-setvalue")) {
            context$2$0.next = 23;
            break;
          }

          context$2$0.next = 21;
          return _regeneratorRuntime.awrap(driver.setValueImmediate(val, el));

        case 21:
          context$2$0.next = 28;
          break;

        case 23:
          if (!(type === "driver")) {
            context$2$0.next = 28;
            break;
          }

          context$2$0.next = 26;
          return _regeneratorRuntime.awrap(driver.click(el));

        case 26:
          context$2$0.next = 28;
          return _regeneratorRuntime.awrap(driver.keys(val));

        case 28:
          _iteratorNormalCompletion2 = true;
          context$2$0.next = 9;
          break;

        case 31:
          context$2$0.next = 37;
          break;

        case 33:
          context$2$0.prev = 33;
          context$2$0.t0 = context$2$0['catch'](7);
          _didIteratorError2 = true;
          _iteratorError2 = context$2$0.t0;

        case 37:
          context$2$0.prev = 37;
          context$2$0.prev = 38;

          if (!_iteratorNormalCompletion2 && _iterator2['return']) {
            _iterator2['return']();
          }

        case 40:
          context$2$0.prev = 40;

          if (!_didIteratorError2) {
            context$2$0.next = 43;
            break;
          }

          throw _iteratorError2;

        case 43:
          return context$2$0.finish(40);

        case 44:
          return context$2$0.finish(37);

        case 45:
        case 'end':
          return context$2$0.stop();
      }
    }, null, this, [[7, 33, 37, 45], [38,, 40, 44]]);
  };

  var computeAndCheck = function computeAndCheck() {
    var button, el, result;
    return _regeneratorRuntime.async(function computeAndCheck$(context$2$0) {
      while (1) switch (context$2$0.prev = context$2$0.next) {
        case 0:
          context$2$0.next = 2;
          return _regeneratorRuntime.awrap(driver.findElement('class name', 'UIAButton'));

        case 2:
          button = context$2$0.sent;
          context$2$0.next = 5;
          return _regeneratorRuntime.awrap(driver.click(button));

        case 5:
          context$2$0.next = 7;
          return _regeneratorRuntime.awrap(driver.findElement('class name', 'UIAStaticText'));

        case 7:
          el = context$2$0.sent;
          context$2$0.next = 10;
          return _regeneratorRuntime.awrap(driver.getText(el));

        case 10:
          context$2$0.t0 = context$2$0.sent;
          result = parseInt(context$2$0.t0, 10);

          result.should.equal(values[0] + values[1]);

        case 13:
        case 'end':
          return context$2$0.stop();
      }
    }, null, this);
  };

  beforeEach(function callee$1$0() {
    return _regeneratorRuntime.async(function callee$1$0$(context$2$0) {
      while (1) switch (context$2$0.prev = context$2$0.next) {
        case 0:
          context$2$0.next = 2;
          return _regeneratorRuntime.awrap(clearFields());

        case 2:
        case 'end':
          return context$2$0.stop();
      }
    }, null, _this);
  });

  it('should fill two fields with numbers', function callee$1$0() {
    return _regeneratorRuntime.async(function callee$1$0$(context$2$0) {
      while (1) switch (context$2$0.prev = context$2$0.next) {
        case 0:
          context$2$0.next = 2;
          return _regeneratorRuntime.awrap(populate("elem"));

        case 2:
          context$2$0.next = 4;
          return _regeneratorRuntime.awrap(computeAndCheck());

        case 4:
        case 'end':
          return context$2$0.stop();
      }
    }, null, _this);
  });

  // using sendKeysToActiveElement
  it('should fill two fields with numbers - sendKeys', function callee$1$0() {
    return _regeneratorRuntime.async(function callee$1$0$(context$2$0) {
      while (1) switch (context$2$0.prev = context$2$0.next) {
        case 0:
          context$2$0.next = 2;
          return _regeneratorRuntime.awrap(populate("driver"));

        case 2:
          context$2$0.next = 4;
          return _regeneratorRuntime.awrap(computeAndCheck());

        case 4:
        case 'end':
          return context$2$0.stop();
      }
    }, null, _this);
  });

  it('should fill two fields with numbers - setValue', function callee$1$0() {
    return _regeneratorRuntime.async(function callee$1$0$(context$2$0) {
      while (1) switch (context$2$0.prev = context$2$0.next) {
        case 0:
          context$2$0.next = 2;
          return _regeneratorRuntime.awrap(populate("elem-setvalue"));

        case 2:
          context$2$0.next = 4;
          return _regeneratorRuntime.awrap(computeAndCheck());

        case 4:
        case 'end':
          return context$2$0.stop();
      }
    }, null, _this);
  });

  it('should confirm that button is displayed', function callee$1$0() {
    var el;
    return _regeneratorRuntime.async(function callee$1$0$(context$2$0) {
      while (1) switch (context$2$0.prev = context$2$0.next) {
        case 0:
          context$2$0.next = 2;
          return _regeneratorRuntime.awrap(driver.findElement('class name', 'UIATextField'));

        case 2:
          el = context$2$0.sent;
          context$2$0.next = 5;
          return _regeneratorRuntime.awrap(driver.elementDisplayed(el));

        case 5:
          context$2$0.sent.should.be.ok;

        case 6:
        case 'end':
          return context$2$0.stop();
      }
    }, null, _this);
  });

  it('should confirm that the disabled button is disabled', function callee$1$0() {
    var el;
    return _regeneratorRuntime.async(function callee$1$0$(context$2$0) {
      while (1) switch (context$2$0.prev = context$2$0.next) {
        case 0:
          context$2$0.next = 2;
          return _regeneratorRuntime.awrap(driver.findElement('accessibility id', 'DisabledButton'));

        case 2:
          el = context$2$0.sent;
          context$2$0.next = 5;
          return _regeneratorRuntime.awrap(driver.elementEnabled(el));

        case 5:
          context$2$0.sent.should.not.be.ok;

        case 6:
        case 'end':
          return context$2$0.stop();
      }
    }, null, _this);
  });

  it('should confirm that the compute sum button is enabled', function callee$1$0() {
    var el;
    return _regeneratorRuntime.async(function callee$1$0$(context$2$0) {
      while (1) switch (context$2$0.prev = context$2$0.next) {
        case 0:
          context$2$0.next = 2;
          return _regeneratorRuntime.awrap(driver.findElement('accessibility id', 'ComputeSumButton'));

        case 2:
          el = context$2$0.sent;
          context$2$0.next = 5;
          return _regeneratorRuntime.awrap(driver.elementEnabled(el));

        case 5:
          context$2$0.sent.should.be.ok;

        case 6:
        case 'end':
          return context$2$0.stop();
      }
    }, null, _this);
  });

  it('should interact with alert', function callee$1$0() {
    var button, text;
    return _regeneratorRuntime.async(function callee$1$0$(context$2$0) {
      while (1) switch (context$2$0.prev = context$2$0.next) {
        case 0:
          context$2$0.next = 2;
          return _regeneratorRuntime.awrap(driver.findElements('class name', 'UIAButton'));

        case 2:
          button = context$2$0.sent[1];
          context$2$0.next = 5;
          return _regeneratorRuntime.awrap(driver.click(button));

        case 5:
          context$2$0.next = 7;
          return _regeneratorRuntime.awrap(driver.postAcceptAlert());

        case 7:
          context$2$0.next = 9;
          return _regeneratorRuntime.awrap(driver.click(button));

        case 9:
          context$2$0.next = 11;
          return _regeneratorRuntime.awrap(driver.getAlertText());

        case 11:
          text = context$2$0.sent;

          text.should.include("Cool title");
          text.should.include("this alert is so cool.");
          context$2$0.next = 16;
          return _regeneratorRuntime.awrap(driver.postDismissAlert());

        case 16:
        case 'end':
          return context$2$0.stop();
      }
    }, null, _this);
  });

  it('should find alert like other elements', function callee$1$0() {
    var button, _alert, els, texts, _iteratorNormalCompletion3, _didIteratorError3, _iteratorError3, _iterator3, _step3, el;

    return _regeneratorRuntime.async(function callee$1$0$(context$2$0) {
      while (1) switch (context$2$0.prev = context$2$0.next) {
        case 0:
          context$2$0.prev = 0;
          context$2$0.next = 3;
          return _regeneratorRuntime.awrap(driver.findElements('class name', 'UIAButton'));

        case 3:
          button = context$2$0.sent[1];
          context$2$0.next = 6;
          return _regeneratorRuntime.awrap(driver.click(button));

        case 6:
          context$2$0.next = 8;
          return _regeneratorRuntime.awrap(driver.findElement('class name', 'UIAAlert'));

        case 8:
          _alert = context$2$0.sent;
          context$2$0.next = 11;
          return _regeneratorRuntime.awrap(driver.findElementsFromElement('class name', 'UIAStaticText', _alert));

        case 11:
          els = context$2$0.sent;
          texts = [];
          _iteratorNormalCompletion3 = true;
          _didIteratorError3 = false;
          _iteratorError3 = undefined;
          context$2$0.prev = 16;
          _iterator3 = _getIterator(els);

        case 18:
          if (_iteratorNormalCompletion3 = (_step3 = _iterator3.next()).done) {
            context$2$0.next = 28;
            break;
          }

          el = _step3.value;
          context$2$0.t0 = texts;
          context$2$0.next = 23;
          return _regeneratorRuntime.awrap(driver.getText(el));

        case 23:
          context$2$0.t1 = context$2$0.sent;
          context$2$0.t0.push.call(context$2$0.t0, context$2$0.t1);

        case 25:
          _iteratorNormalCompletion3 = true;
          context$2$0.next = 18;
          break;

        case 28:
          context$2$0.next = 34;
          break;

        case 30:
          context$2$0.prev = 30;
          context$2$0.t2 = context$2$0['catch'](16);
          _didIteratorError3 = true;
          _iteratorError3 = context$2$0.t2;

        case 34:
          context$2$0.prev = 34;
          context$2$0.prev = 35;

          if (!_iteratorNormalCompletion3 && _iterator3['return']) {
            _iterator3['return']();
          }

        case 37:
          context$2$0.prev = 37;

          if (!_didIteratorError3) {
            context$2$0.next = 40;
            break;
          }

          throw _iteratorError3;

        case 40:
          return context$2$0.finish(37);

        case 41:
          return context$2$0.finish(34);

        case 42:
          texts.should.include('Cool title');
          texts.should.include('this alert is so cool.');

        case 44:
          context$2$0.prev = 44;
          context$2$0.next = 47;
          return _regeneratorRuntime.awrap(driver.postDismissAlert());

        case 47:
          return context$2$0.finish(44);

        case 48:
        case 'end':
          return context$2$0.stop();
      }
    }, null, _this, [[0,, 44, 48], [16, 30, 34, 42], [35,, 37, 41]]);
  });

  it('should get tag names of elements', function callee$1$0() {
    var el;
    return _regeneratorRuntime.async(function callee$1$0$(context$2$0) {
      while (1) switch (context$2$0.prev = context$2$0.next) {
        case 0:
          context$2$0.next = 2;
          return _regeneratorRuntime.awrap(driver.findElement('class name', 'UIAButton'));

        case 2:
          el = context$2$0.sent;
          context$2$0.next = 5;
          return _regeneratorRuntime.awrap(driver.getName(el));

        case 5:
          context$2$0.sent.should.equal("UIAButton");
          context$2$0.next = 8;
          return _regeneratorRuntime.awrap(driver.findElement('class name', 'UIAStaticText'));

        case 8:
          el = context$2$0.sent;
          context$2$0.next = 11;
          return _regeneratorRuntime.awrap(driver.getName(el));

        case 11:
          context$2$0.sent.should.equal('UIAStaticText');

        case 12:
        case 'end':
          return context$2$0.stop();
      }
    }, null, _this);
  });

  it('should be able to get text of a button', function callee$1$0() {
    var el;
    return _regeneratorRuntime.async(function callee$1$0$(context$2$0) {
      while (1) switch (context$2$0.prev = context$2$0.next) {
        case 0:
          context$2$0.next = 2;
          return _regeneratorRuntime.awrap(driver.findElement('class name', 'UIAButton'));

        case 2:
          el = context$2$0.sent;
          context$2$0.next = 5;
          return _regeneratorRuntime.awrap(driver.getText(el));

        case 5:
          context$2$0.sent.should.equal("Compute Sum");

        case 6:
        case 'end':
          return context$2$0.stop();
      }
    }, null, _this);
  });
});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInRlc3QvZTJlL3Rlc3RhcHAvYmFzaWNzL2NhbGMtYXBwLTEtc3BlY3MuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7eUJBQWtCLGtCQUFrQjs7Ozt1QkFDaEIsWUFBWTs7Ozs4QkFDUyx1QkFBdUI7O0FBRWhFLFFBQVEsQ0FBQywrQkFBK0IsRUFBRSxZQUFZOzs7QUFDcEQsTUFBSSxPQUFPLEdBQUcsNEJBQU0sSUFBSSx1QkFBVSxDQUFDO0FBQ25DLE1BQUksTUFBTSxHQUFHLE9BQU8sQ0FBQyxNQUFNLENBQUM7O0FBRTVCLE1BQUksTUFBTSxHQUFHLElBQUksQ0FBQztBQUNsQixNQUFJLEtBQUssR0FBRyxtQkFBbUIsQ0FBQzs7QUFFaEMsTUFBSSxXQUFXLEdBQUcsU0FBZCxXQUFXO1FBRVQsR0FBRyxrRkFDRSxFQUFFLEVBR1AsTUFBTTs7Ozs7QUFMVixnQkFBTSxHQUFHLEVBQUUsQ0FBQzs7MkNBQ0ksTUFBTSxDQUFDLFlBQVksQ0FBQyxZQUFZLEVBQUUsY0FBYyxDQUFDOzs7QUFBN0QsYUFBRzs7Ozs7bUNBQ1EsR0FBRzs7Ozs7Ozs7QUFBVCxZQUFFOzsyQ0FDSCxNQUFNLENBQUMsS0FBSyxDQUFDLEVBQUUsQ0FBQzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OzsyQ0FFTCxNQUFNLENBQUMsV0FBVyxDQUFDLFlBQVksRUFBRSxXQUFXLENBQUM7OztBQUE1RCxnQkFBTTs7MkNBQ0osTUFBTSxDQUFDLEtBQUssQ0FBQyxNQUFNLENBQUM7Ozs7Ozs7R0FDM0IsQ0FBQzs7QUFFRixNQUFJLFFBQVEsR0FBRyxTQUFYLFFBQVEsQ0FBbUIsSUFBSTtRQUU3QixHQUFHLHVGQUNFLEVBQUUsRUFDTCxHQUFHOzs7OztBQUhULGdCQUFNLEdBQUcsRUFBRSxDQUFDOzsyQ0FDSSxNQUFNLENBQUMsWUFBWSxDQUFDLEtBQUssRUFBRSw4Q0FBeUIsZ0JBQWdCLENBQUMsQ0FBQzs7O0FBQWxGLGFBQUc7Ozs7O29DQUNRLEdB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Q0FBQzs7Ozt5QkFBN0IsSUFBSTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBRVosZUFBSyxDQUFDLE1BQU0sQ0FBQyxPQUFPLENBQUMsWUFBWSxDQUFDLENBQUM7QUFDbkMsZUFBSyxDQUFDLE1BQU0sQ0FBQyxPQUFPLENBQUMsd0JBQXdCLENBQUMsQ0FBQzs7Ozs7MkNBRXpDLE1BQU0sQ0FBQyxnQkFBZ0IsRUFBRTs7Ozs7Ozs7OztHQUVsQyxDQUFDLENBQUM7O0FBRUgsSUFBRSxDQUFDLGtDQUFrQyxFQUFFO1FBQ2pDLEVBQUU7Ozs7OzJDQUFTLE1BQU0sQ0FBQyxXQUFXLENBQUMsWUFBWSxFQUFFLFdBQVcsQ0FBQzs7O0FBQXhELFlBQUU7OzJDQUNDLE1BQU0sQ0FBQyxPQUFPLENBQUMsRUFBRSxDQUFDOzs7MkJBQUUsTUFBTSxDQUFDLEtBQUssQ0FBQyxXQUFXOzsyQ0FDeEMsTUFBTSxDQUFDLFdBQVcsQ0FBQyxZQUFZLEVBQUUsZUFBZSxDQUFDOzs7QUFBNUQsWUFBRTs7MkNBQ0ssTUFBTSxDQUFDLE9BQU8sQ0FBQyxFQUFFLENBQUM7OzsyQkFBRSxNQUFNLENBQUMsS0FBSyxDQUFDLGVBQWU7Ozs7Ozs7R0FDeEQsQ0FBQyxDQUFDOztBQUVILElBQUUsQ0FBQyx3Q0FBd0MsRUFBRTtRQUN2QyxFQUFFOzs7OzsyQ0FBUyxNQUFNLENBQUMsV0FBVyxDQUFDLFlBQVksRUFBRSxXQUFXLENBQUM7OztBQUF4RCxZQUFFOzsyQ0FDQyxNQUFNLENBQUMsT0FBTyxDQUFDLEVBQUUsQ0FBQzs7OzJCQUFFLE1BQU0sQ0FBQyxLQUFLLENBQUMsYUFBYTs7Ozs7OztHQUN0RCxDQUFDLENBQUM7Q0FFSixDQUFDLENBQUMiLCJmaWxlIjoidGVzdC9lMmUvdGVzdGFwcC9iYXNpY3MvY2FsYy1hcHAtMS1zcGVjcy5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBzZXR1cCBmcm9tIFwiLi4vLi4vc2V0dXAtYmFzZVwiO1xuaW1wb3J0IGRlc2lyZWQgZnJvbSAnLi4vZGVzaXJlZCc7XG5pbXBvcnQgeyBmaWx0ZXJWaXNpYmxlVWlhU2VsZWN0b3IgfSBmcm9tICcuLi8uLi9oZWxwZXJzL3JlY2lwZXMnO1xuXG5kZXNjcmliZSgndGVzdGFwcCAtIGJhc2ljcyAtIGNhbGMgYXBwIDEnLCBmdW5jdGlvbiAoKSB7XG4gIGxldCBzZXNzaW9uID0gc2V0dXAodGhpcywgZGVzaXJlZCk7XG4gIGxldCBkcml2ZXIgPSBzZXNzaW9uLmRyaXZlcjtcblxuICBsZXQgdmFsdWVzID0gbnVsbDtcbiAgbGV0IGJ5VUlBID0gJy1pb3MgdWlhdXRvbWF0aW9uJztcblxuICBsZXQgY2xlYXJGaWVsZHMgPSBhc3luYyBmdW5jdGlvbiAoKSB7XG4gICAgdmFsdWVzID0gW107XG4gICAgbGV0IGVscyA9IGF3YWl0IGRyaXZlci5maW5kRWxlbWVudHMoJ2NsYXNzIG5hbWUnLCAnVUlBVGV4dEZpZWxkJyk7XG4gICAgZm9yIChsZXQgZWwgb2YgZWxzKSB7XG4gICAgICBhd2FpdCBkcml2ZXIuY2xlYXIoZWwpO1xuICAgIH1cbiAgICBsZXQgYnV0dG9uID0gYXdhaXQgZHJpdmVyLmZpbmRFbGVtZW50KCdjbGFzcyBuYW1lJywgJ1VJQUJ1dHRvbicpO1xuICAgIGF3YWl0IGRyaXZlci5jbGljayhidXR0b24pO1xuICB9O1xuXG4gIGxldCBwb3B1bGF0ZSA9IGFzeW5jIGZ1bmN0aW9uICh0eXBlKSB7XG4gICAgdmFsdWVzID0gW107XG4gICAgbGV0IGVscyA9IGF3YWl0IGRyaXZlci5maW5kRWxlbWVudHMoYnlVSUEsIGZpbHRlclZpc2libGVVaWFTZWxlY3RvcignLnRleHRGaWVsZHMoKTsnKSk7XG4gICAgZm9yIChsZXQgZWwgb2YgZWxzKSB7XG4gICAgICBsZXQgdmFsID0gTWF0aC5yb3VuZChNYXRoLnJhbmRvbSgpICogMTApO1xuICAgICAgdmFsdWVzLnB1c2godmFsKTtcbiAgICAgIGlmICh0eXBlID09PSBcImVsZW1cIikge1xuICAgICAgICBhd2FpdCBkcml2ZXIuc2V0VmFsdWUodmFsLCBlbCk7XG4gICAgICB9IGVsc2UgaWYgKHR5cGUgPT09IFwiZWxlbS1zZXR2YWx1ZVwiKSB7XG4gICAgICAgIGF3YWl0IGRyaXZlci5zZXRWYWx1ZUltbWVkaWF0ZSh2YWwsIGVsKTtcbiAgICAgIH0gZWxzZSBpZiAodHlwZSA9PT0gXCJkcml2ZXJcIikge1xuICAgICAgICBhd2FpdCBkcml2ZXIuY2xpY2soZWwpO1xuICAgICAgICBhd2FpdCBkcml2ZXIua2V5cyh2YWwpO1xuICAgICAgfVxuICAgIH1cbiAgfTtcblxuICBsZXQgY29tcHV0ZUFuZENoZWNrID0gYXN5bmMgZnVuY3Rpb24gKCkge1xuICAgIGxldCBidXR0b24gPSBhd2FpdCBkcml2ZXIuZmluZEVsZW1lbnQoJ2NsYXNzIG5hbWUnLCAnVUlBQnV0dG9uJyk7XG4gICAgYXdhaXQgZHJpdmVyLmNsaWNrKGJ1dHRvbik7XG4gICAgbGV0IGVsID0gYXdhaXQgZHJpdmVyLmZpbmRFbGVtZW50KCdjbGFzcyBuYW1lJywgJ1VJQVN0YXRpY1RleHQnKTtcbiAgICBsZXQgcmVzdWx0ID0gcGFyc2VJbnQoYXdhaXQgZHJpdmVyLmdldFRleHQoZWwpLCAxMCk7XG4gICAgcmVzdWx0LnNob3VsZC5lcXVhbCh2YWx1ZXNbMF0gKyB2YWx1ZXNbMV0pO1xuICB9O1xuXG4gIGJlZm9yZUVhY2goYXN5bmMgKCkgPT4ge1xuICAgIGF3YWl0IGNsZWFyRmllbGRzKCk7XG4gIH0pO1xuXG4gIGl0KCdzaG91bGQgZmlsbCB0d28gZmllbGRzIHdpdGggbnVtYmVycycsIGFzeW5jICgpID0+IHtcbiAgICBhd2FpdCBwb3B1bGF0ZShcImVsZW1cIik7XG4gICAgYXdhaXQgY29tcHV0ZUFuZENoZWNrKCk7XG4gIH0pO1xuXG4gIC8vIHVzaW5nIHNlbmRLZXlzVG9BY3RpdmVFbGVtZW50XG4gIGl0KCdzaG91bGQgZmlsbCB0d28gZmllbGRzIHdpdGggbnVtYmVycyAtIHNlbmRLZXlzJywgYXN5bmMgKCkgPT4ge1xuICAgIGF3YWl0IHBvcHVsYXRlKFwiZHJpdmVyXCIpO1xuICAgIGF3YWl0IGNvbXB1dGVBbmRDaGVjaygpO1xuICB9KTtcblxuICBpdCgnc2hvdWxkIGZpbGwgdHdvIGZpZWxkcyB3aXRoIG51bWJlcnMgLSBzZXRWYWx1ZScsIGFzeW5jICgpID0+IHtcbiAgICBhd2FpdCBwb3B1bGF0ZShcImVsZW0tc2V0dmFsdWVcIik7XG4gICAgYXdhaXQgY29tcHV0ZUFuZENoZWNrKCk7XG4gIH0pO1xuXG4gIGl0KCdzaG91bGQgY29uZmlybSB0aGF0IGJ1dHRvbiBpcyBkaXNwbGF5ZWQnLCBhc3luYyAoKSA9PiB7XG4gICAgbGV0IGVsID0gYXdhaXQgZHJpdmVyLmZpbmRFbGVtZW50KCdjbGFzcyBuYW1lJywgJ1VJQVRleHRGaWVsZCcpO1xuICAgIChhd2FpdCBkcml2ZXIuZWxlbWVudERpc3BsYXllZChlbCkpLnNob3VsZC5iZS5vaztcbiAgfSk7XG5cbiAgaXQoJ3Nob3VsZCBjb25maXJtIHRoYXQgdGhlIGRpc2FibGVkIGJ1dHRvbiBpcyBkaXNhYmxlZCcsIGFzeW5jICgpID0+IHtcbiAgICBsZXQgZWwgPSBhd2FpdCBkcml2ZXIuZmluZEVsZW1lbnQoJ2FjY2Vzc2liaWxpdHkgaWQnLCAnRGlzYWJsZWRCdXR0b24nKTtcbiAgICAoYXdhaXQgZHJpdmVyLmVsZW1lbnRFbmFibGVkKGVsKSkuc2hvdWxkLm5vdC5iZS5vaztcbiAgfSk7XG5cbiAgaXQoJ3Nob3VsZCBjb25maXJtIHRoYXQgdGhlIGNvbXB1dGUgc3VtIGJ1dHRvbiBpcyBlbmFibGVkJywgYXN5bmMgKCkgPT4ge1xuICAgIGxldCBlbCA9IGF3YWl0IGRyaXZlci5maW5kRWxlbWVudCgnYWNjZXNzaWJpbGl0eSBpZCcsICdDb21wdXRlU3VtQnV0dG9uJyk7XG4gICAgKGF3YWl0IGRyaXZlci5lbGVtZW50RW5hYmxlZChlbCkpLnNob3VsZC5iZS5vaztcbiAgfSk7XG5cbiAgaXQoJ3Nob3VsZCBpbnRlcmFjdCB3aXRoIGFsZXJ0JywgYXN5bmMgKCkgPT4ge1xuICAgIGxldCBidXR0b24gPSAoYXdhaXQgZHJpdmVyLmZpbmRFbGVtZW50cygnY2xhc3MgbmFtZScsICdVSUFCdXR0b24nKSlbMV07XG4gICAgYXdhaXQgZHJpdmVyLmNsaWNrKGJ1dHRvbik7XG4gICAgYXdhaXQgZHJpdmVyLnBvc3RBY2NlcHRBbGVydCgpO1xuICAgIGF3YWl0IGRyaXZlci5jbGljayhidXR0b24pO1xuICAgIGxldCB0ZXh0ID0gYXdhaXQgZHJpdmVyLmdldEFsZXJ0VGV4dCgpO1xuICAgIHRleHQuc2hvdWxkLmluY2x1ZGUoXCJDb29sIHRpdGxlXCIpO1xuICAgIHRleHQuc2hvdWxkLmluY2x1ZGUoXCJ0aGlzIGFsZXJ0IGlzIHNvIGNvb2wuXCIpO1xuICAgIGF3YWl0IGRyaXZlci5wb3N0RGlzbWlzc0FsZXJ0KCk7XG4gIH0pO1xuXG4gIGl0KCdzaG91bGQgZmluZCBhbGVydCBsaWtlIG90aGVyIGVsZW1lbnRzJywgYXN5bmMgKCkgPT4ge1xuICAgIHRyeSB7XG4gICAgICBsZXQgYnV0dG9uID0gKGF3YWl0IGRyaXZlci5maW5kRWxlbWVudHMoJ2NsYXNzIG5hbWUnLCAnVUlBQnV0dG9uJykpWzFdO1xuICAgICAgYXdhaXQgZHJpdmVyLmNsaWNrKGJ1dHRvbik7XG4gICAgICBsZXQgYWxlcnQgPSBhd2FpdCBkcml2ZXIuZmluZEVsZW1lbnQoJ2NsYXNzIG5hbWUnLCAnVUlBQWxlcnQnKTtcbiAgICAgIGxldCBlbHMgPSBhd2FpdCBkcml2ZXIuZmluZEVsZW1lbnRzRnJvbUVsZW1lbnQoJ2NsYXNzIG5hbWUnLCAnVUlBU3RhdGljVGV4dCcsIGFsZXJ0KTtcbiAgICAgIGxldCB0ZXh0cyA9IFtdO1xuICAgICAgZm9yIChsZXQgZWwgb2YgZWxzKSB7XG4gICAgICAgIHRleHRzLnB1c2goYXdhaXQgZHJpdmVyLmdldFRleHQoZWwpKTtcbiAgICAgIH1cbiAgICAgIHRleHRzLnNob3VsZC5pbmNsdWRlKCdDb29sIHRpdGxlJyk7XG4gICAgICB0ZXh0cy5zaG91bGQuaW5jbHVkZSgndGhpcyBhbGVydCBpcyBzbyBjb29sLicpO1xuICAgIH0gZmluYWxseSB7XG4gICAgICBhd2FpdCBkcml2ZXIucG9zdERpc21pc3NBbGVydCgpO1xuICAgIH1cbiAgfSk7XG5cbiAgaXQoJ3Nob3VsZCBnZXQgdGFnIG5hbWVzIG9mIGVsZW1lbnRzJywgYXN5bmMgKCkgPT4ge1xuICAgIGxldCBlbCA9IGF3YWl0IGRyaXZlci5maW5kRWxlbWVudCgnY2xhc3MgbmFtZScsICdVSUFCdXR0b24nKTtcbiAgICAoYXdhaXQgZHJpdmVyLmdldE5hbWUoZWwpKS5zaG91bGQuZXF1YWwoXCJVSUFCdXR0b25cIik7XG4gICAgZWwgPSBhd2FpdCBkcml2ZXIuZmluZEVsZW1lbnQoJ2NsYXNzIG5hbWUnLCAnVUlBU3RhdGljVGV4dCcpO1xuICAgIChhd2FpdCBkcml2ZXIuZ2V0TmFtZShlbCkpLnNob3VsZC5lcXVhbCgnVUlBU3RhdGljVGV4dCcpO1xuICB9KTtcblxuICBpdCgnc2hvdWxkIGJlIGFibGUgdG8gZ2V0IHRleHQgb2YgYSBidXR0b24nLCBhc3luYyAoKSA9PiB7XG4gICAgbGV0IGVsID0gYXdhaXQgZHJpdmVyLmZpbmRFbGVtZW50KCdjbGFzcyBuYW1lJywgJ1VJQUJ1dHRvbicpO1xuICAgIChhd2FpdCBkcml2ZXIuZ2V0VGV4dChlbCkpLnNob3VsZC5lcXVhbChcIkNvbXB1dGUgU3VtXCIpO1xuICB9KTtcblxufSk7XG4iXSwic291cmNlUm9vdCI6Ii4uLy4uLy4uLy4uLy4uIn0=
