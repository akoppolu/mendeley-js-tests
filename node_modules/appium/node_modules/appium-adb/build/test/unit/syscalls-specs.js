'use strict';

var _regeneratorRuntime = require('babel-runtime/regenerator')['default'];

var _interopRequireDefault = require('babel-runtime/helpers/interop-require-default')['default'];

var _interopRequireWildcard = require('babel-runtime/helpers/interop-require-wildcard')['default'];

var _this = this;

var _chai = require('chai');

var _chai2 = _interopRequireDefault(_chai);

var _chaiAsPromised = require('chai-as-promised');

var _chaiAsPromised2 = _interopRequireDefault(_chaiAsPromised);

var _2 = require('../..');

var _3 = _interopRequireDefault(_2);

var _teen_process = require('teen_process');

var teen_process = _interopRequireWildcard(_teen_process);

var _appiumTestSupport = require('appium-test-support');

var _bluebird = require('bluebird');

var _bluebird2 = _interopRequireDefault(_bluebird);

var _lodash = require('lodash');

var _lodash2 = _interopRequireDefault(_lodash);

_chai2['default'].use(_chaiAsPromised2['default']);
var adb = new _3['default']();
adb.executable.path = 'adb_path';
var avdName = 'AVD_NAME';

describe('System calls', (0, _appiumTestSupport.withMocks)({ teen_process: teen_process }, function (mocks) {
  it('getConnectedDevices should get all connected devices', function callee$1$0() {
    var devices;
    return _regeneratorRuntime.async(function callee$1$0$(context$2$0) {
      while (1) switch (context$2$0.prev = context$2$0.next) {
        case 0:
          mocks.teen_process.expects("exec").once().withExactArgs(adb.executable.path, ['devices']).returns({ stdout: "List of devices attached \n emulator-5554	device" });
          context$2$0.next = 3;
          return _regeneratorRuntime.awrap(adb.getConnectedDevices());

        case 3:
          devices = context$2$0.sent;

          devices.should.have.length.above(0);
          mocks.teen_process.verify();

        case 6:
        case 'end':
          return context$2$0.stop();
      }
    }, null, _this);
  });
  it('getConnectedDevices should get all connected devices which have valid udid', function callee$1$0() {
    var stdoutValue, devices;
    return _regeneratorRuntime.async(function callee$1$0$(context$2$0) {
      while (1) switch (context$2$0.prev = context$2$0.next) {
        case 0:
          stdoutValue = "List of devices attached \n" + "adb server version (32) doesn't match this client (36); killing...\n" + "* daemon started successfully *\n" + "emulator-5554	device";

          mocks.teen_process.expects("exec").once().withExactArgs(adb.executable.path, ['devices']).returns({ stdout: stdoutValue });

          context$2$0.next = 4;
          return _regeneratorRuntime.awrap(adb.getConnectedDevices());

        case 4:
          devices = context$2$0.sent;

          devices.should.have.length.above(0);
          mocks.teen_process.verify();

        case 7:
        case 'end':
          return context$2$0.stop();
      }
    }, null, _this);
  });
  it('getConnectedDevices should fail when adb devices returns unexpected output', function callee$1$0() {
    return _regeneratorRuntime.async(function callee$1$0$(context$2$0) {
      while (1) switch (context$2$0.prev = context$2$0.next) {
        case 0:
          mocks.teen_process.expects("exec").once().withExactArgs(adb.executable.path, ['devices']).returns({ stdout: "foobar" });
          context$2$0.next = 3;
          return _regeneratorRuntime.awrap(adb.getConnectedDevices().should.eventually.be.rejectedWith("Unexpected output while trying to get devices"));

        case 3:
          mocks.teen_process.verify();

        case 4:
        case 'end':
          return context$2$0.stop();
      }
    }, null, _this);
  });
  it('getDevicesWithRetry should fail when there are no connected devices', function callee$1$0() {
    return _regeneratorRuntime.async(function callee$1$0$(context$2$0) {
      while (1) switch (context$2$0.prev = context$2$0.next) {
        case 0:
          mocks.teen_process.expects("exec").atLeast(2).withExactArgs(adb.executable.path, ['devices']).returns({ stdout: "List of devices attached" });
          context$2$0.next = 3;
          return _regeneratorRuntime.awrap(adb.getDevicesWithRetry(1000).should.eventually.be.rejectedWith("Could not find a connected Android device."));

        case 3:
          mocks.teen_process.verify();

        case 4:
        case 'end':
          return context$2$0.stop();
      }
    }, null, _this);
  });
  it('getDevicesWithRetry should fail when adb devices returns unexpected output', function callee$1$0() {
    return _regeneratorRuntime.async(function callee$1$0$(context$2$0) {
      while (1) switch (context$2$0.prev = context$2$0.next) {
        case 0:
          mocks.teen_process.expects("exec").atLeast(2).withExactArgs(adb.executable.path, ['devices']).returns({ stdout: "foobar" });
          context$2$0.next = 3;
          return _regeneratorRuntime.awrap(adb.getDevicesWithRetry(1000).should.eventually.be.rejectedWith("Could not find a connected Android device."));

        case 3:
          mocks.teen_process.verify();

        case 4:
        case 'end':
          return context$2$0.stop();
      }
    }, null, _this);
  });
  it('getDevicesWithRetry should get all connected devices', function callee$1$0() {
    var devices;
    return _regeneratorRuntime.async(function callee$1$0$(context$2$0) {
      while (1) switch (context$2$0.prev = context$2$0.next) {
        case 0:
          mocks.teen_process.expects("exec").once().withExactArgs(adb.executable.path, ['devices']).returns({ stdout: "List of devices attached \n emulator-5554	device" });
          context$2$0.next = 3;
          return _regeneratorRuntime.awrap(adb.getDevicesWithRetry(1000));

        case 3:
          devices = context$2$0.sent;

          devices.should.have.length.above(0);
          mocks.teen_process.verify();

        case 6:
        case 'end':
          return context$2$0.stop();
      }
    }, null, _this);
  });
  it('getDevicesWithRetry should get all connected devices second time', function callee$1$0() {
    var devices;
    return _regeneratorRuntime.async(function callee$1$0$(context$2$0) {
      while (1) switch (context$2$0.prev = context$2$0.next) {
        case 0:
          mocks.teen_process.expects("exec").onCall(0).returns({ stdout: "Foobar" });
          mocks.teen_process.expects("exec").withExactArgs(adb.executable.path, ['devices']).returns({ stdout: "List of devices attached \n emulator-5554	device" });
          context$2$0.next = 4;
          return _regeneratorRuntime.awrap(adb.getDevicesWithRetry(2000));

        case 4:
          devices = context$2$0.sent;

          devices.should.have.length.above(0);
          mocks.teen_process.verify();

        case 7:
        case 'end':
          return context$2$0.stop();
      }
    }, null, _this);
  });
  it('getDevicesWithRetry should fail when exec throws an error', function callee$1$0() {
    return _regeneratorRuntime.async(function callee$1$0$(context$2$0) {
      while (1) switch (context$2$0.prev = context$2$0.next) {
        case 0:
          mocks.teen_process.expects("exec").atLeast(2).throws("Error foobar");
          context$2$0.next = 3;
          return _regeneratorRuntime.awrap(adb.getDevicesWithRetry(1000).should.eventually.be.rejectedWith("Could not find a connected Android device."));

        case 3:
          mocks.teen_process.verify();

        case 4:
        case 'end':
          return context$2$0.stop();
      }
    }, null, _this);
  });
  it('setDeviceId should set the device id', function () {
    adb.setDeviceId('foobar');
    adb.curDeviceId.should.equal('foobar');
    adb.executable.defaultArgs.should.include('foobar');
  });
  it('setDevice should set the device id and emu port from obj', function () {
    adb.setDevice({ udid: 'emulator-1234' });
    adb.curDeviceId.should.equal('emulator-1234');
    adb.executable.defaultArgs.should.include('emulator-1234');
    adb.emulatorPort.should.equal(1234);
  });
  it('setEmulatorPort should change emulator port', function () {
    adb.setEmulatorPort(5554);
    adb.emulatorPort.should.equal(5554);
  });
  describe('createSubProcess', function () {
    it('should return an instance of SubProcess', function () {
      adb.createSubProcess([]).should.be.an['instanceof'](teen_process.SubProcess);
    });
  });
}));

describe('System calls', (0, _appiumTestSupport.withMocks)({ adb: adb, B: _bluebird2['default'], teen_process: teen_process }, function (mocks) {
  it('should return adb version', function callee$1$0() {
    var adbVersion;
    return _regeneratorRuntime.async(function callee$1$0$(context$2$0) {
      while (1) switch (context$2$0.prev = context$2$0.next) {
        case 0:
          mocks.adb.expects("adbExec").once().withExactArgs('version').returns("Android Debug Bridge version 1.0.39\nRevision 5943271ace17-android");
          context$2$0.next = 3;
          return _regeneratorRuntime.awrap(adb.getAdbVersion());

        case 3:
          adbVersion = context$2$0.sent;

          adbVersion.versionString.should.equal("1.0.39");
          adbVersion.versionFloat.should.be.within(1.0, 1.0);
          adbVersion.major.should.equal(1);
          adbVersion.minor.should.equal(0);
          adbVersion.patch.should.equal(39);
          mocks.adb.verify();

        case 10:
        case 'end':
          return context$2$0.stop();
      }
    }, null, _this);
  });
  it('should cache adb results', function callee$1$0() {
    return _regeneratorRuntime.async(function callee$1$0$(context$2$0) {
      while (1) switch (context$2$0.prev = context$2$0.next) {
        case 0:
          adb.getAdbVersion.cache = new _lodash2['default'].memoize.Cache();
          mocks.adb.expects("adbExec").once().withExactArgs('version').returns("Android Debug Bridge version 1.0.39\nRevision 5943271ace17-android");
          context$2$0.next = 4;
          return _regeneratorRuntime.awrap(adb.getAdbVersion());

        case 4:
          context$2$0.next = 6;
          return _regeneratorRuntime.awrap(adb.getAdbVersion());

        case 6:
          mocks.adb.verify();

        case 7:
        case 'end':
          return context$2$0.stop();
      }
    }, null, _this);
  });
  it('fileExists should return true for if ls returns', function callee$1$0() {
    return _regeneratorRuntime.async(function callee$1$0$(context$2$0) {
      while (1) switch (context$2$0.prev = context$2$0.next) {
        case 0:
          mocks.adb.expects("ls").once().withExactArgs('foo').returns(['bar']);
          context$2$0.next = 3;
          return _regeneratorRuntime.awrap(adb.fileExists("foo").should.eventually.equal(true));

        case 3:
          mocks.adb.verify();

        case 4:
        case 'end':
          return context$2$0.stop();
      }
    }, null, _this);
  });
  it('ls should return list', function callee$1$0() {
    var list;
    return _regeneratorRuntime.async(function callee$1$0$(context$2$0) {
      while (1) switch (context$2$0.prev = context$2$0.next) {
        case 0:
          mocks.adb.expects("shell").once().withExactArgs(['ls', 'foo']).returns('bar');
          context$2$0.next = 3;
          return _regeneratorRuntime.awrap(adb.ls("foo"));

        case 3:
          list = context$2$0.sent;

          list.should.deep.equal(['bar']);
          mocks.adb.verify();

        case 6:
        case 'end':
          return context$2$0.stop();
      }
    }, null, _this);
  });
  it('reboot should call stop and start using shell', function callee$1$0() {
    return _regeneratorRuntime.async(function callee$1$0$(context$2$0) {
      while (1) switch (context$2$0.prev = context$2$0.next) {
        case 0:
          mocks.adb.expects("shell").once().withExactArgs(['stop']);
          mocks.adb.expects("setDeviceProperty").once().withExactArgs('sys.boot_completed', 0);
          mocks.adb.expects("shell").once().withExactArgs(['start']);
          mocks.adb.expects("getDeviceProperty").once().withExactArgs('sys.boot_completed').returns('1');
          mocks.B.expects("delay").once().withExactArgs(2000);
          context$2$0.next = 7;
          return _regeneratorRuntime.awrap(adb.reboot().should.eventually.not.be.rejected);

        case 7:
          mocks.adb.verify();
          mocks.B.verify();

        case 9:
        case 'end':
          return context$2$0.stop();
      }
    }, null, _this);
  });
  it('reboot should restart adbd as root if necessary', function callee$1$0() {
    return _regeneratorRuntime.async(function callee$1$0$(context$2$0) {
      while (1) switch (context$2$0.prev = context$2$0.next) {
        case 0:
          mocks.teen_process.expects("exec").once().withExactArgs(adb.executable.path, ['root']).returns(false);
          mocks.adb.expects("shell").twice().withExactArgs(['stop']).onFirstCall().throws(new Error('Error executing adbExec. Original error: \'Command \'adb shell stop\' exited with code 1\'; Stderr: \'stop: must be root\'; Code: \'1\'')).onSecondCall().returns();
          mocks.adb.expects("setDeviceProperty").once().withExactArgs('sys.boot_completed', 0);
          mocks.adb.expects("shell").once().withExactArgs(['start']);
          mocks.adb.expects("getDeviceProperty").once().withExactArgs('sys.boot_completed').returns('1');
          mocks.B.expects("delay").once().withExactArgs(2000);
          context$2$0.next = 8;
          return _regeneratorRuntime.awrap(adb.reboot().should.eventually.not.be.rejected);

        case 8:
          mocks.adb.verify();
          mocks.B.verify();

        case 10:
        case 'end':
          return context$2$0.stop();
      }
    }, null, _this);
  });
  it('getRunningAVD should get connected avd', function callee$1$0() {
    var udid, port, emulator;
    return _regeneratorRuntime.async(function callee$1$0$(context$2$0) {
      while (1) switch (context$2$0.prev = context$2$0.next) {
        case 0:
          udid = 'emulator-5554';
          port = 5554;
          emulator = { udid: udid, port: port };

          mocks.adb.expects("getConnectedEmulators").once().withExactArgs().returns([emulator]);
          mocks.adb.expects("setEmulatorPort").once().withExactArgs(port);
          mocks.adb.expects("sendTelnetCommand").once().withExactArgs("avd name").returns(avdName);
          mocks.adb.expects("setDeviceId").once().withExactArgs(udid);
          context$2$0.next = 9;
          return _regeneratorRuntime.awrap(adb.getRunningAVD(avdName));

        case 9:
          context$2$0.t0 = emulator;
          context$2$0.sent.should.equal(context$2$0.t0);

          mocks.adb.verify();

        case 12:
        case 'end':
          return context$2$0.stop();
      }
    }, null, _this);
  });
  it('getRunningAVD should return null when expected avd is not connected', function callee$1$0() {
    var udid, port, emulator;
    return _regeneratorRuntime.async(function callee$1$0$(context$2$0) {
      while (1) switch (context$2$0.prev = context$2$0.next) {
        case 0:
          udid = 'emulator-5554';
          port = 5554;
          emulator = { udid: udid, port: port };

          mocks.adb.expects("getConnectedEmulators").once().withExactArgs().returns([emulator]);
          mocks.adb.expects("setEmulatorPort").once().withExactArgs(port);
          mocks.adb.expects("sendTelnetCommand").once().withExactArgs("avd name").returns('OTHER_AVD');
          context$2$0.t0 = _chai2['default'];
          context$2$0.next = 9;
          return _regeneratorRuntime.awrap(adb.getRunningAVD(avdName));

        case 9:
          context$2$0.t1 = context$2$0.sent;
          context$2$0.t0.expect.call(context$2$0.t0, context$2$0.t1).to.be['null'];

          mocks.adb.verify();

        case 12:
        case 'end':
          return context$2$0.stop();
      }
    }, null, _this);
  });
  it('getRunningAVD should return null when no avd is connected', function callee$1$0() {
    return _regeneratorRuntime.async(function callee$1$0$(context$2$0) {
      while (1) switch (context$2$0.prev = context$2$0.next) {
        case 0:
          mocks.adb.expects("getConnectedEmulators").once().withExactArgs().returns([]);
          context$2$0.t0 = _chai2['default'];
          context$2$0.next = 4;
          return _regeneratorRuntime.awrap(adb.getRunningAVD(avdName));

        case 4:
          context$2$0.t1 = context$2$0.sent;
          context$2$0.t0.expect.call(context$2$0.t0, context$2$0.t1).to.be['null'];

          mocks.adb.verify();

        case 7:
        case 'end':
          return context$2$0.stop();
      }
    }, null, _this);
  });
}));
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInRlc3QvdW5pdC9zeXNjYWxscy1zcGVjcy5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7O29CQUFpQixNQUFNOzs7OzhCQUNJLGtCQUFrQjs7OztpQkFDN0IsT0FBTzs7Ozs0QkFDTyxjQUFjOztJQUFoQyxZQUFZOztpQ0FDRSxxQkFBcUI7O3dCQUNqQyxVQUFVOzs7O3NCQUNWLFFBQVE7Ozs7QUFHdEIsa0JBQUssR0FBRyw2QkFBZ0IsQ0FBQztBQUN6QixJQUFNLEdBQUcsR0FBRyxtQkFBUyxDQUFDO0FBQ3RCLEdBQUcsQ0FBQyxVQUFVLENBQUMsSUFBSSxHQUFHLFVBQVUsQ0FBQztBQUNqQyxJQUFNLE9BQU8sR0FBRyxVQUFVLENBQUM7O0FBRTNCLFFBQVEsQ0FBQyxjQUFjLEVBQUUsa0NBQVUsRUFBQyxZQUFZLEVBQVosWUFBWSxFQUFDLEVBQUUsVUFBQyxLQUFLLEVBQUs7QUFDNUQsSUFBRSxDQUFDLHNEQUFzRCxFQUFFO1FBSXJELE9BQU87Ozs7QUFIWCxlQUFLLENBQUMsWUFBWSxDQUFDLE9BQU8sQ0FBQyxNQUFNLENBQUMsQ0FDL0IsSUFBSSxFQUFFLENBQUMsYUFBYSxDQUFDLEdBQUcsQ0FBQyxVQUFVLENBQUMsSUFBSSxFQUFFLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FDdEQsT0FBTyxDQUFDLEVBQUMsTUFBTSxFQUFDLGtEQUFrRCxFQUFDLENBQUMsQ0FBQzs7MkNBQ3BELEdBQUcsQ0FBQyxtQkFBbUIsRUFBRTs7O0FBQXpDLGlCQUFPOztBQUNYLGlCQUFPLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDO0FBQ3BDLGVBQUssQ0FBQyxZQUFZLENBQUMsTUFBTSxFQUFFLENBQUM7Ozs7Ozs7R0FDN0IsQ0FBQyxDQUFDO0FBQ0gsSUFBRSxDQUFDLDRFQUE0RSxFQUFFO1FBQzNFLFdBQVcsRUFRWCxPQUFPOzs7O0FBUlAscUJBQVcsR0FBRyw2QkFBNkIsR0FDN0Isc0VBQXNFLEdBQ3RFLG1DQUFtQyxHQUNuQyxzQkFBc0I7O0FBQ3hDLGVBQUssQ0FBQyxZQUFZLENBQUMsT0FBTyxDQUFDLE1BQU0sQ0FBQyxDQUMvQixJQUFJLEVBQUUsQ0FBQyxhQUFhLENBQUMsR0FBRyxDQUFDLFVBQVUsQ0FBQyxJQUFJLEVBQUUsQ0FBQyxTQUFTLENBQUMsQ0FBQyxDQUN0RCxPQUFPLENBQUMsRUFBQyxNQUFNLEVBQUMsV0FBVyxFQUFDLENBQUMsQ0FBQzs7OzJDQUViLEdBQUcsQ0FBQyxtQkFBbUIsRUFBRTs7O0FBQXpDLGlCQUFPOztBQUNYLGlCQUFPLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDO0FBQ3BDLGVBQUssQ0FBQyxZQUFZLENBQUMsTUFBTSxFQUFFLENBQUM7Ozs7Ozs7R0FDN0IsQ0FBQyxDQUFDO0FBQ0gsSUFBRSxDQUFDLDRFQUE0RSxFQUFFOzs7O0FBQy9FLGVBQUssQ0FBQyxZQUFZLENBQUMsT0FBTyxDQUFDLE1BQU0sQ0FBQyxDQUMvQixJQUFJLEVBQUUsQ0FBQyxhQUFhLENBQUMsR0FBRyxDQUFDLFVBQVUsQ0FBQyxJQUFJLEVBQUUsQ0FBQyxTQUFTLENBQUMsQ0FBQyxDQUN0RCxPQUFPLENBQUMsRUFBQyxNQUFNLEVBQUMsUUFBUSxFQUFDLENBQUMsQ0FBQzs7MkNBQ3hCLEdBQUcsQ0FBQyxtQkFBbUIsRUFBRSxDQUFDLE1BQU0sQ0FBQyxVQUFVLENBQUMsRUFBRSxDQUNwQixZQUFZLENBQUMsK0NBQStDLENBQUM7OztBQUM3RixlQUFLLENBQUMsWUFBWSxDQUFDLE1BQU0sRUFBRSxDQUFDOzs7Ozs7O0dBQzdCLENBQUMsQ0FBQztBQUNILElBQUUsQ0FBQyxxRUFBcUUsRUFBRTs7OztBQUN4RSxlQUFLLENBQUMsWUFBWSxDQUFDLE9BQU8sQ0FBQyxNQUFNLENBQUMsQ0FDL0IsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDLGFBQWEsQ0FBQyxHQUFHLENBQUMsVUFBVSxDQUFDLElBQUksRUFBRSxDQUFDLFNBQVMsQ0FBQyxDQUFDLENBQzFELE9BQU8sQ0FBQyxFQUFDLE1BQU0sRUFBQywwQkFBMEIsRUFBQyxDQUFDLENBQUM7OzJDQUMxQyxHQUFHLENBQUMsbUJBQW1CLENBQUMsSUFBSSxDQUFDLENBQUMsTUFBTSxDQUFDLFVBQVUsQ0FBQyxFQUFFLENBQ3BCLFlBQVksQ0FBQyw0Q0FBNEMsQ0FBQzs7O0FBQzlGLGVBQUssQ0FBQyxZQUFZLENBQUMsTUFBTSxFQUFFLENBQUM7Ozs7Ozs7R0FDN0IsQ0FBQyxDQUFDO0FBQ0gsSUFBRSxDQUFDLDRFQUE0RSxFQUFFOzs7O0FBQy9FLGVBQUssQ0FBQyxZQUFZLENBQUMsT0FBTyxDQUFDLE1BQU0sQ0FBQyxDQUMvQixPQUFPLENBQUMsQ0FBQyxDQUFDLENBQUMsYUFBYSxDQUFDLEdBQUcsQ0FBQyxVQUFVLENBQUMsSUFBSSxFQUFFLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FDMUQsT0FBTyxDQUFDLEVBQUMsTUFBTSxFQUFDLFFBQVEsRUFBQyxDQUFDLENBQUM7OzJDQUN4QixHQUFHLENBQUMsbUJBQW1CLENBQUMsSUFBSSxDQUFDLENBQUMsTUFBTSxDQUFDLFVBQVUsQ0FBQyxFQUFFLENBQ3BCLFlBQVksQ0FBQyw0Q0FBNEMsQ0FBQzs7O0FBQzlGLGVBQUssQ0FBQyxZQUFZLENBQUMsTUFBTSxFQUFFLENBQUM7Ozs7Ozs7R0FDN0IsQ0FBQyxDQUFDO0FBQ0gsSUFBRSxDQUFDLHNEQUFzRCxFQUFFO1FBSXJELE9BQU87Ozs7QUFIWCxlQUFLLENBQUMsWUFBWSxDQUFDLE9BQU8sQ0FBQyxNQUFNLENBQUMsQ0FDL0IsSUFBSSxFQUFFLENBQUMsYUFBYSxDQUFDLEdBQUcsQ0FBQyxVQUFVLENBQUMsSUFBSSxFQUFFLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FDdEQsT0FBTyxDQUFDLEVBQUMsTUFBTSxFQUFDLGtEQUFrRCxFQUFDLENBQUMsQ0FBQzs7MkNBQ3BELEdBQUcsQ0FBQyxtQkFBbUIsQ0FBQyxJQUFJLENBQUM7OztBQUE3QyxpQkFBTzs7QUFDWCxpQkFBTyxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQztBQUNwQyxlQUFLLENBQUMsWUFBWSxDQUFDLE1BQU0sRUFBRSxDQUFDOzs7Ozs7O0dBQzdCLENBQUMsQ0FBQztBQUNILElBQUUsQ0FBQyxrRUFBa0UsRUFBRTtRQU9qRSxPQUFPOzs7O0FBTlgsZUFBSyxDQUFDLFlBQVksQ0FBQyxPQUFPLENBQUMsTUFBTSxDQUFDLENBQy9CLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FDVCxPQUFPLENBQUMsRUFBQyxNQUFNLEVBQUMsUUFBUSxFQUFDLENBQUMsQ0FBQztBQUM5QixlQUFLLENBQUMsWUFBWSxDQUFDLE9BQU8sQ0FBQyxNQUFNLENBQUMsQ0FDL0IsYUFBYSxDQUFDLEdBQUcsQ0FBQyxVQUFVLENBQUMsSUFBSSxFQUFFLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FDL0MsT0FBTyxDQUFDLEVBQUMsTUFBTSxFQUFDLGtEQUFrRCxFQUFDLENBQUMsQ0FBQzs7MkNBQ3BELEdBQUcsQ0FBQyxtQkFBbUIsQ0FBQyxJQUFJLENBQUM7OztBQUE3QyxpQkFBTzs7QUFDWCxpQkFBTyxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQztBQUNwQyxlQUFLLENBQUMsWUFBWSxDQUFDLE1BQU0sRUFBRSxDQUFDOzs7Ozs7O0dBQzdCLENBQUMsQ0FBQztBQUNILElBQUUsQ0FBQywyREFBMkQsRUFBRTs7OztBQUM5RCxlQUFLLENBQUMsWUFBWSxDQUFDLE9BQU8sQ0FBQyxNQUFNLENBQUMsQ0FDL0IsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUNWLE1BQU0sQ0FBQyxjQUFjLENBQUMsQ0FBQzs7MkNBQ3BCLEdBQUcsQ0FBQyxtQkFBbUIsQ0FBQyxJQUFJLENBQUMsQ0FBQyxNQUFNLENBQUMsVUFBVSxDQUFDLEVBQUUsQ0FDcEIsWUFBWSxDQUFDLDRDQUE0QyxDQUFDOzs7QUFDOUYsZUFBSyxDQUFDLFlBQVksQ0FBQyxNQUFNLEVBQUUsQ0FBQzs7Ozs7OztHQUM3QixDQUFDLENBQUM7QUFDSCxJQUFFLENBQUMsc0NBQXNDLEVBQUUsWUFBTTtBQUMvQyxPQUFHLENBQUMsV0FBVyxDQUFDLFFBQVEsQ0FBQyxDQUFDO0FBQzFCLE9BQUcsQ0FBQyxXQUFXLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxRQUFRLENBQUMsQ0FBQztBQUN2QyxPQUFHLENBQUMsVUFBVSxDQUFDLFdBQVcsQ0FBQyxNQUFNLENBQUMsT0FBTyxDQUFDLFFBQVEsQ0FBQyxDQUFDO0dBQ3JELENBQUMsQ0FBQztBQUNILElBQUUsQ0FBQywwREFBMEQsRUFBRSxZQUFNO0FBQ25FLE9BQUcsQ0FBQyxTQUFTLENBQUMsRUFBQyxJQUFJLEVBQUUsZUFBZSxFQUFDLENBQUMsQ0FBQztBQUN2QyxPQUFHLENBQUMsV0FBVyxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsZUFBZSxDQUFDLENBQUM7QUFDOUMsT0FBRyxDQUFDLFVBQVUsQ0FBQyxXQUFXLENBQUMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxlQUFlLENBQUMsQ0FBQztBQUMzRCxPQUFHLENBQUMsWUFBWSxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLENBQUM7R0FDckMsQ0FBQyxDQUFDO0FBQ0gsSUFBRSxDQUFDLDZDQUE2QyxFQUFFLFlBQU07QUFDdEQsT0FBRyxDQUFDLGVBQWUsQ0FBQyxJQUFJLENBQUMsQ0FBQztBQUMxQixPQUFHLENBQUMsWUFBWSxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLENBQUM7R0FDckMsQ0FBQyxDQUFDO0FBQ0gsVUFBUSxDQUFDLGtCQUFrQixFQUFFLFlBQU07QUFDakMsTUFBRSxDQUFDLHlDQUF5QyxFQUFFLFlBQU07QUFDbEQsU0FBRyxDQUFDLGdCQUFnQixDQUFDLEVBQUUsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxFQUFFLENBQUMsRUFBRSxjQUFXLENBQUMsWUFBWSxDQUFDLFVBQVUsQ0FBQyxDQUFDO0tBQzNFLENBQUMsQ0FBQztHQUNKLENBQUMsQ0FBQztDQUNKLENBQUMsQ0FBQyxDQUFDOztBQUVKLFFBQVEsQ0FBQyxjQUFjLEVBQUcsa0NBQVUsRUFBQyxHQUFHLEVBQUgsR0FBRyxFQUFFLENBQUMsdUJBQUEsRUFBRSxZQUFZLEVBQVosWUFBWSxFQUFDLEVBQUUsVUFBQyxLQUFLLEVBQUs7QUFDckUsSUFBRSxDQUFDLDJCQUEyQixFQUFFO1FBSzFCLFVBQVU7Ozs7QUFKZCxlQUFLLENBQUMsR0FBRyxDQUFDLE9BQU8sQ0FBQyxTQUFTLENBQUMsQ0FDekIsSUFBSSxFQUFFLENBQ04sYUFBYSxDQUFDLFNBQVMsQ0FBQyxDQUN4QixPQUFPLENBQUMsb0VBQW9FLENBQUMsQ0FBQzs7MkNBQzFELEdBQUcsQ0FBQyxhQUFhLEVBQUU7OztBQUF0QyxvQkFBVTs7QUFDZCxvQkFBVSxDQUFDLGFBQWEsQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLFFBQVEsQ0FBQyxDQUFDO0FBQ2hELG9CQUFVLENBQUMsWUFBWSxDQUFDLE1BQU0sQ0FBQyxFQUFFLENBQUMsTUFBTSxDQUFDLEdBQUcsRUFBRSxHQUFHLENBQUMsQ0FBQztBQUNuRCxvQkFBVSxDQUFDLEtBQUssQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDO0FBQ2pDLG9CQUFVLENBQUMsS0FBSyxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUM7QUFDakMsb0JBQVUsQ0FBQyxLQUFLLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxFQUFFLENBQUMsQ0FBQztBQUNsQyxlQUFLLENBQUMsR0FBRyxDQUFDLE1BQU0sRUFBRSxDQUFDOzs7Ozs7O0dBQ3BCLENBQUMsQ0FBQztBQUNILElBQUUsQ0FBQywwQkFBMEIsRUFBRTs7OztBQUM3QixhQUFHLENBQUMsYUFBYSxDQUFDLEtBQUssR0FBRyxJQUFJLG9CQUFFLE9BQU8sQ0FBQyxLQUFLLEVBQUUsQ0FBQztBQUNoRCxlQUFLLENBQUMsR0FBRyxDQUFDLE9BQU8sQ0FBQyxTQUFTLENBQUMsQ0FDekIsSUFBSSxFQUFFLENBQ04sYUFBYSxDQUFDLFNBQVMsQ0FBQyxDQUN4QixPQUFPLENBQUMsb0VBQW9FLENBQUMsQ0FBQzs7MkNBQzNFLEdBQUcsQ0FBQyxhQUFhLEVBQUU7Ozs7MkNBQ25CLEdBQUcsQ0FBQyxhQUFhLEVBQUU7OztBQUN6QixlQUFLLENBQUMsR0FBRyxDQUFDLE1BQU0sRUFBRSxDQUFDOzs7Ozs7O0dBQ3BCLENBQUMsQ0FBQztBQUNILElBQUUsQ0FBQyxpREFBaUQsRUFBRTs7OztBQUNwRCxlQUFLLENBQUMsR0FBRyxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FDcEIsSUFBSSxFQUFFLENBQUMsYUFBYSxDQUFDLEtBQUssQ0FBQyxDQUMzQixPQUFPLENBQUMsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDOzsyQ0FDZCxHQUFHLENBQUMsVUFBVSxDQUFDLEtBQUssQ0FBQyxDQUFDLE1BQU0sQ0FBQyxVQUFVLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQzs7O0FBQ3pELGVBQUssQ0FBQyxHQUFHLENBQUMsTUFBTSxFQUFFLENBQUM7Ozs7Ozs7R0FDcEIsQ0FBQyxDQUFDO0FBQ0gsSUFBRSxDQUFDLHVCQUF1QixFQUFFO1FBSXRCLElBQUk7Ozs7QUFIUixlQUFLLENBQUMsR0FBRyxDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUMsQ0FDdkIsSUFBSSxFQUFFLENBQUMsYUFBYSxDQUFDLENBQUMsSUFBSSxFQUFFLEtBQUssQ0FBQyxDQUFDLENBQ25DLE9BQU8sQ0FBQyxLQUFLLENBQUMsQ0FBQzs7MkNBQ0QsR0FBRyxDQUFDLEVBQUUsQ0FBQyxLQUFLLENBQUM7OztBQUExQixjQUFJOztBQUNSLGNBQUksQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUM7QUFDaEMsZUFBSyxDQUFDLEdBQUcsQ0FBQyxNQUFNLEVBQUUsQ0FBQzs7Ozs7OztHQUNwQixDQUFDLENBQUM7QUFDSCxJQUFFLENBQUMsK0NBQStDLEVBQUU7Ozs7QUFDbEQsZUFBSyxDQUFDLEdBQUcsQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDLENBQ3ZCLElBQUksRUFBRSxDQUFDLGFBQWEsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUM7QUFDbEMsZUFBSyxDQUFDLEdBQUcsQ0FBQyxPQUFPLENBQUMsbUJBQW1CLENBQUMsQ0FDbkMsSUFBSSxFQUFFLENBQUMsYUFBYSxDQUFDLG9CQUFvQixFQUFFLENBQUMsQ0FBQyxDQUFDO0FBQ2pELGVBQUssQ0FBQyxHQUFHLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQyxDQUN2QixJQUFJLEVBQUUsQ0FBQyxhQUFhLENBQUMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDO0FBQ25DLGVBQUssQ0FBQyxHQUFHLENBQUMsT0FBTyxDQUFDLG1CQUFtQixDQUFDLENBQ25DLElBQUksRUFBRSxDQUFDLGFBQWEsQ0FBQyxvQkFBb0IsQ0FBQyxDQUMxQyxPQUFPLENBQUMsR0FBRyxDQUFDLENBQUM7QUFDaEIsZUFBSyxDQUFDLENBQUMsQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDLENBQ3JCLElBQUksRUFBRSxDQUFDLGFBQWEsQ0FBQyxJQUFJLENBQUMsQ0FBQzs7MkNBQ3hCLEdBQUcsQ0FBQyxNQUFNLEVBQUUsQ0FBQyxNQUFNLENBQUMsVUFBVSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsUUFBUTs7O0FBQ3BELGVBQUssQ0FBQyxHQUFHLENBQUMsTUFBTSxFQUFFLENBQUM7QUFDbkIsZUFBSyxDQUFDLENBQUMsQ0FBQyxNQUFNLEVBQUUsQ0FBQzs7Ozs7OztHQUNsQixDQUFDLENBQUM7QUFDSCxJQUFFLENBQUMsaURBQWlELEVBQUU7Ozs7QUFDcEQsZUFBSyxDQUFDLFlBQVksQ0FBQyxPQUFPLENBQUMsTUFBTSxDQUFDLENBQy9CLElBQUksRUFBRSxDQUFDLGFBQWEsQ0FBQyxHQUFHLENBQUMsVUFBVSxDQUFDLElBQUksRUFBRSxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQ25ELE9BQU8sQ0FBQyxLQUFLLENBQUMsQ0FBQztBQUNsQixlQUFLLENBQUMsR0FBRyxDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUMsQ0FDdkIsS0FBSyxFQUFFLENBQUMsYUFBYSxDQUFDLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FDL0IsV0FBVyxFQUFFLENBQ1gsTUFBTSxDQUFDLElBQUksS0FBSywySUFBbUksQ0FBQyxDQUN0SixZQUFZLEVBQUUsQ0FBQyxPQUFPLEVBQUUsQ0FBQztBQUM1QixlQUFLLENBQUMsR0FBRyxDQUFDLE9BQU8sQ0FBQyxtQkFBbUIsQ0FBQyxDQUNuQyxJQUFJLEVBQUUsQ0FBQyxhQUFhLENBQUMsb0JBQW9CLEVBQUUsQ0FBQyxDQUFDLENBQUM7QUFDakQsZUFBSyxDQUFDLEdBQUcsQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDLENBQ3ZCLElBQUksRUFBRSxDQUFDLGFBQWEsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUM7QUFDbkMsZUFBSyxDQUFDLEdBQUcsQ0FBQyxPQUFPLENBQUMsbUJBQW1CLENBQUMsQ0FDbkMsSUFBSSxFQUFFLENBQUMsYUFBYSxDQUFDLG9CQUFvQixDQUFDLENBQzFDLE9BQU8sQ0FBQyxHQUFHLENBQUMsQ0FBQztBQUNoQixlQUFLLENBQUMsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUMsQ0FDckIsSUFBSSxFQUFFLENBQUMsYUFBYSxDQUFDLElBQUksQ0FBQyxDQUFDOzsyQ0FDeEIsR0FBRyxDQUFDLE1BQU0sRUFBRSxDQUFDLE1BQU0sQ0FBQyxVQUFVLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxRQUFROzs7QUFDcEQsZUFBSyxDQUFDLEdBQUcsQ0FBQyxNQUFNLEVBQUUsQ0FBQztBQUNuQixlQUFLLENBQUMsQ0FBQyxDQUFDLE1BQU0sRUFBRSxDQUFDOzs7Ozs7O0dBQ2xCLENBQUMsQ0FBQztBQUNILElBQUUsQ0FBQyx3Q0FBd0MsRUFBRTtRQUN2QyxJQUFJLEVBQ0osSUFBSSxFQUNKLFFBQVE7Ozs7QUFGUixjQUFJLEdBQUcsZUFBZTtBQUN0QixjQUFJLEdBQUcsSUFBSTtBQUNYLGtCQUFRLEdBQUcsRUFBQyxJQUFJLEVBQUosSUFBSSxFQUFFLElBQUksRUFBSixJQUFJLEVBQUM7O0FBQzNCLGVBQUssQ0FBQyxHQUFHLENBQUMsT0FBTyxDQUFDLHVCQUF1QixDQUFDLENBQ3ZDLElBQUksRUFBRSxDQUFDLGFBQWEsRUFBRSxDQUN0QixPQUFPLENBQUMsQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDO0FBQ3ZCLGVBQUssQ0FBQyxHQUFHLENBQUMsT0FBTyxDQUFDLGlCQUFpQixDQUFDLENBQ2pDLElBQUksRUFBRSxDQUFDLGFBQWEsQ0FBQyxJQUFJLENBQUMsQ0FBQztBQUM5QixlQUFLLENBQUMsR0FBRyxDQUFDLE9BQU8sQ0FBQyxtQkFBbUIsQ0FBQyxDQUNuQyxJQUFJLEVBQUUsQ0FBQyxhQUFhLENBQUMsVUFBVSxDQUFDLENBQ2hDLE9BQU8sQ0FBQyxPQUFPLENBQUMsQ0FBQztBQUNwQixlQUFLLENBQUMsR0FBRyxDQUFDLE9BQU8sQ0FBQyxhQUFhLENBQUMsQ0FDN0IsSUFBSSxFQUFFLENBQUMsYUFBYSxDQUFDLElBQUksQ0FBQyxDQUFDOzsyQ0FDdkIsR0FBRyxDQUFDLGFBQWEsQ0FBQyxPQUFPLENBQUM7OzsyQkFBZSxRQUFROzJCQUFyQixNQUFNLENBQUMsS0FBSzs7QUFDL0MsZUFBSyxDQUFDLEdBQUcsQ0FBQyxNQUFNLEVBQUUsQ0FBQzs7Ozs7OztHQUNwQixDQUFDLENBQUM7QUFDSCxJQUFFLENBQUMscUVBQXFFLEVBQUU7UUFDcEUsSUFBSSxFQUNKLElBQUksRUFDSixRQUFROzs7O0FBRlIsY0FBSSxHQUFHLGVBQWU7QUFDdEIsY0FBSSxHQUFHLElBQUk7QUFDWCxrQkFBUSxHQUFHLEVBQUMsSUFBSSxFQUFKLElBQUksRUFBRSxJQUFJLEVBQUosSUFBSSxFQUFDOztBQUMzQixlQUFLLENBQUMsR0FBRyxDQUFDLE9BQU8sQ0FBQyx1QkFBdUIsQ0FBQyxDQUN2QyxJQUFJLEVBQUUsQ0FBQyxhQUFhLEVBQUUsQ0FDdEIsT0FBTyxDQUFDLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQztBQUN2QixlQUFLLENBQUMsR0FBRyxDQUFDLE9BQU8sQ0FBQyxpQkFBaUIsQ0FBQyxDQUNqQyxJQUFJLEVBQUUsQ0FBQyxhQUFhLENBQUMsSUFBSSxDQUFDLENBQUM7QUFDOUIsZUFBSyxDQUFDLEdBQUcsQ0FBQyxPQUFPLENBQUMsbUJBQW1CLENBQUMsQ0FDbkMsSUFBSSxFQUFFLENBQUMsYUFBYSxDQUFDLFVBQVUsQ0FBQyxDQUNoQyxPQUFPLENBQUMsV0FBVyxDQUFDLENBQUM7OzsyQ0FDTixHQUFHLENBQUMsYUFBYSxDQUFDLE9BQU8sQ0FBQzs7Ozt5QkFBdkMsTUFBTSxzQ0FBbUMsRUFBRSxDQUFDLEVBQUU7O0FBQ25ELGVBQUssQ0FBQyxHQUFHLENBQUMsTUFBTSxFQUFFLENBQUM7Ozs7Ozs7R0FDcEIsQ0FBQyxDQUFDO0FBQ0gsSUFBRSxDQUFDLDJEQUEyRCxFQUFFOzs7O0FBQzlELGVBQUssQ0FBQyxHQUFHLENBQUMsT0FBTyxDQUFDLHVCQUF1QixDQUFDLENBQ3ZDLElBQUksRUFBRSxDQUFDLGFBQWEsRUFBRSxDQUN0QixPQUFPLENBQUMsRUFBRSxDQUFDLENBQUM7OzsyQ0FDRyxHQUFHLENBQUMsYUFBYSxDQUFDLE9BQU8sQ0FBQzs7Ozt5QkFBdkMsTUFBTSxzQ0FBbUMsRUFBRSxDQUFDLEVBQUU7O0FBQ25ELGVBQUssQ0FBQyxHQUFHLENBQUMsTUFBTSxFQUFFLENBQUM7Ozs7Ozs7R0FDcEIsQ0FBQyxDQUFDO0NBQ0osQ0FBQyxDQUFDLENBQUMiLCJmaWxlIjoidGVzdC91bml0L3N5c2NhbGxzLXNwZWNzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGNoYWkgZnJvbSAnY2hhaSc7XG5pbXBvcnQgY2hhaUFzUHJvbWlzZWQgZnJvbSAnY2hhaS1hcy1wcm9taXNlZCc7XG5pbXBvcnQgQURCIGZyb20gJy4uLy4uJztcbmltcG9ydCAqIGFzIHRlZW5fcHJvY2VzcyBmcm9tICd0ZWVuX3Byb2Nlc3MnO1xuaW1wb3J0IHsgd2l0aE1vY2tzIH0gZnJvbSAnYXBwaXVtLXRlc3Qtc3VwcG9ydCc7XG5pbXBvcnQgQiBmcm9tICdibHVlYmlyZCc7XG5pbXBvcnQgXyBmcm9tICdsb2Rhc2gnO1xuXG5cbmNoYWkudXNlKGNoYWlBc1Byb21pc2VkKTtcbmNvbnN0IGFkYiA9IG5ldyBBREIoKTtcbmFkYi5leGVjdXRhYmxlLnBhdGggPSAnYWRiX3BhdGgnO1xuY29uc3QgYXZkTmFtZSA9ICdBVkRfTkFNRSc7XG5cbmRlc2NyaWJlKCdTeXN0ZW0gY2FsbHMnLCB3aXRoTW9ja3Moe3RlZW5fcHJvY2Vzc30sIChtb2NrcykgPT4ge1xuICBpdCgnZ2V0Q29ubmVjdGVkRGV2aWNlcyBzaG91bGQgZ2V0IGFsbCBjb25uZWN0ZWQgZGV2aWNlcycsIGFzeW5jICgpID0+IHtcbiAgICBtb2Nrcy50ZWVuX3Byb2Nlc3MuZXhwZWN0cyhcImV4ZWNcIilcbiAgICAgIC5vbmNlKCkud2l0aEV4YWN0QXJncyhhZGIuZXhlY3V0YWJsZS5wYXRoLCBbJ2RldmljZXMnXSlcbiAgICAgIC5yZXR1cm5zKHtzdGRvdXQ6XCJMaXN0IG9mIGRldmljZXMgYXR0YWNoZWQgXFxuIGVtdWxhdG9yLTU1NTRcdGRldmljZVwifSk7XG4gICAgbGV0IGRldmljZXMgPSBhd2FpdCBhZGIuZ2V0Q29ubmVjdGVkRGV2aWNlcygpO1xuICAgIGRldmljZXMuc2hvdWxkLmhhdmUubGVuZ3RoLmFib3ZlKDApO1xuICAgIG1vY2tzLnRlZW5fcHJvY2Vzcy52ZXJpZnkoKTtcbiAgfSk7XG4gIGl0KCdnZXRDb25uZWN0ZWREZXZpY2VzIHNob3VsZCBnZXQgYWxsIGNvbm5lY3RlZCBkZXZpY2VzIHdoaWNoIGhhdmUgdmFsaWQgdWRpZCcsIGFzeW5jICgpID0+IHtcbiAgICBsZXQgc3Rkb3V0VmFsdWUgPSBcIkxpc3Qgb2YgZGV2aWNlcyBhdHRhY2hlZCBcXG5cIiArXG4gICAgICAgICAgICAgICAgICAgICAgXCJhZGIgc2VydmVyIHZlcnNpb24gKDMyKSBkb2Vzbid0IG1hdGNoIHRoaXMgY2xpZW50ICgzNik7IGtpbGxpbmcuLi5cXG5cIiArXG4gICAgICAgICAgICAgICAgICAgICAgXCIqIGRhZW1vbiBzdGFydGVkIHN1Y2Nlc3NmdWxseSAqXFxuXCIgK1xuICAgICAgICAgICAgICAgICAgICAgIFwiZW11bGF0b3ItNTU1NFx0ZGV2aWNlXCI7XG4gICAgbW9ja3MudGVlbl9wcm9jZXNzLmV4cGVjdHMoXCJleGVjXCIpXG4gICAgICAub25jZSgpLndpdGhFeGFjdEFyZ3MoYWRiLmV4ZWN1dGFibGUucGF0aCwgWydkZXZpY2VzJ10pXG4gICAgICAucmV0dXJucyh7c3Rkb3V0OnN0ZG91dFZhbHVlfSk7XG5cbiAgICBsZXQgZGV2aWNlcyA9IGF3YWl0IGFkYi5nZXRDb25uZWN0ZWREZXZpY2VzKCk7XG4gICAgZGV2aWNlcy5zaG91bGQuaGF2ZS5sZW5ndGguYWJvdmUoMCk7XG4gICAgbW9ja3MudGVlbl9wcm9jZXNzLnZlcmlmeSgpO1xuICB9KTtcbiAgaXQoJ2dldENvbm5lY3RlZERldmljZXMgc2hvdWxkIGZhaWwgd2hlbiBhZGIgZGV2aWNlcyByZXR1cm5zIHVuZXhwZWN0ZWQgb3V0cHV0JywgYXN5bmMgKCkgPT4ge1xuICAgIG1vY2tzLnRlZW5fcHJvY2Vzcy5leHBlY3RzKFwiZXhlY1wiKVxuICAgICAgLm9uY2UoKS53aXRoRXhhY3RBcmdzKGFkYi5leGVjdXRhYmxlLnBhdGgsIFsnZGV2aWNlcyddKVxuICAgICAgLnJldHVybnMoe3N0ZG91dDpcImZvb2JhclwifSk7XG4gICAgYXdhaXQgYWRiLmdldENvbm5lY3RlZERldmljZXMoKS5zaG91bGQuZXZlbnR1YWxseS5iZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAucmVqZWN0ZWRXaXRoKFwiVW5leHBlY3RlZCBvdXRwdXQgd2hpbGUgdHJ5aW5nIHRvIGdldCBkZXZpY2VzXCIpO1xuICAgIG1vY2tzLnRlZW5fcHJvY2Vzcy52ZXJpZnkoKTtcbiAgfSk7XG4gIGl0KCdnZXREZXZpY2VzV2l0aFJldHJ5IHNob3VsZCBmYWlsIHdoZW4gdGhlcmUgYXJlIG5vIGNvbm5lY3RlZCBkZXZpY2VzJywgYXN5bmMgKCkgPT4ge1xuICAgIG1vY2tzLnRlZW5fcHJvY2Vzcy5leHBlY3RzKFwiZXhlY1wiKVxuICAgICAgLmF0TGVhc3QoMikud2l0aEV4YWN0QXJncyhhZGIuZXhlY3V0YWJsZS5wYXRoLCBbJ2RldmljZXMnXSlcbiAgICAgIC5yZXR1cm5zKHtzdGRvdXQ6XCJMaXN0IG9mIGRldmljZXMgYXR0YWNoZWRcIn0pO1xuICAgIGF3YWl0IGFkYi5nZXREZXZpY2VzV2l0aFJldHJ5KDEwMDApLnNob3VsZC5ldmVudHVhbGx5LmJlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAucmVqZWN0ZWRXaXRoKFwiQ291bGQgbm90IGZpbmQgYSBjb25uZWN0ZWQgQW5kcm9pZCBkZXZpY2UuXCIpO1xuICAgIG1vY2tzLnRlZW5fcHJvY2Vzcy52ZXJpZnkoKTtcbiAgfSk7XG4gIGl0KCdnZXREZXZpY2VzV2l0aFJldHJ5IHNob3VsZCBmYWlsIHdoZW4gYWRiIGRldmljZXMgcmV0dXJucyB1bmV4cGVjdGVkIG91dHB1dCcsIGFzeW5jICgpID0+IHtcbiAgICBtb2Nrcy50ZWVuX3Byb2Nlc3MuZXhwZWN0cyhcImV4ZWNcIilcbiAgICAgIC5hdExlYXN0KDIpLndpdGhFeGFjdEFyZ3MoYWRiLmV4ZWN1dGFibGUucGF0aCwgWydkZXZpY2VzJ10pXG4gICAgICAucmV0dXJucyh7c3Rkb3V0OlwiZm9vYmFyXCJ9KTtcbiAgICBhd2FpdCBhZGIuZ2V0RGV2aWNlc1dpdGhSZXRyeSgxMDAwKS5zaG91bGQuZXZlbnR1YWxseS5iZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLnJlamVjdGVkV2l0aChcIkNvdWxkIG5vdCBmaW5kIGEgY29ubmVjdGVkIEFuZHJvaWQgZGV2aWNlLlwiKTtcbiAgICBtb2Nrcy50ZWVuX3Byb2Nlc3MudmVyaWZ5KCk7XG4gIH0pO1xuICBpdCgnZ2V0RGV2aWNlc1dpdGhSZXRyeSBzaG91bGQgZ2V0IGFsbCBjb25uZWN0ZWQgZGV2aWNlcycsIGFzeW5jICgpID0+IHtcbiAgICBtb2Nrcy50ZWVuX3Byb2Nlc3MuZXhwZWN0cyhcImV4ZWNcIilcbiAgICAgIC5vbmNlKCkud2l0aEV4YWN0QXJncyhhZGIuZXhlY3V0YWJsZS5wYXRoLCBbJ2RldmljZXMnXSlcbiAgICAgIC5yZXR1cm5zKHtzdGRvdXQ6XCJMaXN0IG9mIGRldmljZXMgYXR0YWNoZWQgXFxuIGVtdWxhdG9yLTU1NTRcdGRldmljZVwifSk7XG4gICAgbGV0IGRldmljZXMgPSBhd2FpdCBhZGIuZ2V0RGV2aWNlc1dpdGhSZXRyeSgxMDAwKTtcbiAgICBkZXZpY2VzLnNob3VsZC5oYXZlLmxlbmd0aC5hYm92ZSgwKTtcbiAgICBtb2Nrcy50ZWVuX3Byb2Nlc3MudmVyaWZ5KCk7XG4gIH0pO1xuICBpdCgnZ2V0RGV2aWNlc1dpdGhSZXRyeSBzaG91bGQgZ2V0IGFsbCBjb25uZWN0ZWQgZGV2aWNlcyBzZWNvbmQgdGltZScsIGFzeW5jICgpID0+IHtcbiAgICBtb2Nrcy50ZWVuX3Byb2Nlc3MuZXhwZWN0cyhcImV4ZWNcIilcbiAgICAgIC5vbkNhbGwoMClcbiAgICAgIC5yZXR1cm5zKHtzdGRvdXQ6XCJGb29iYXJcIn0pO1xuICAgIG1vY2tzLnRlZW5fcHJvY2Vzcy5leHBlY3RzKFwiZXhlY1wiKVxuICAgICAgLndpdGhFeGFjdEFyZ3MoYWRiLmV4ZWN1dGFibGUucGF0aCwgWydkZXZpY2VzJ10pXG4gICAgICAucmV0dXJucyh7c3Rkb3V0OlwiTGlzdCBvZiBkZXZpY2VzIGF0dGFjaGVkIFxcbiBlbXVsYXRvci01NTU0XHRkZXZpY2VcIn0pO1xuICAgIGxldCBkZXZpY2VzID0gYXdhaXQgYWRiLmdldERldmljZXNXaXRoUmV0cnkoMjAwMCk7XG4gICAgZGV2aWNlcy5zaG91bGQuaGF2ZS5sZW5ndGguYWJvdmUoMCk7XG4gICAgbW9ja3MudGVlbl9wcm9jZXNzLnZlcmlmeSgpO1xuICB9KTtcbiAgaXQoJ2dldERldmljZXNXaXRoUmV0cnkgc2hvdWxkIGZhaWwgd2hlbiBleGVjIHRocm93cyBhbiBlcnJvcicsIGFzeW5jICgpID0+IHtcbiAgICBtb2Nrcy50ZWVuX3Byb2Nlc3MuZXhwZWN0cyhcImV4ZWNcIilcbiAgICAgIC5hdExlYXN0KDIpXG4gICAgICAudGhyb3dzKFwiRXJyb3IgZm9vYmFyXCIpO1xuICAgIGF3YWl0IGFkYi5nZXREZXZpY2VzV2l0aFJldHJ5KDEwMDApLnNob3VsZC5ldmVudHVhbGx5LmJlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAucmVqZWN0ZWRXaXRoKFwiQ291bGQgbm90IGZpbmQgYSBjb25uZWN0ZWQgQW5kcm9pZCBkZXZpY2UuXCIpO1xuICAgIG1vY2tzLnRlZW5fcHJvY2Vzcy52ZXJpZnkoKTtcbiAgfSk7XG4gIGl0KCdzZXREZXZpY2VJZCBzaG91bGQgc2V0IHRoZSBkZXZpY2UgaWQnLCAoKSA9PiB7XG4gICAgYWRiLnNldERldmljZUlkKCdmb29iYXInKTtcbiAgICBhZGIuY3VyRGV2aWNlSWQuc2hvdWxkLmVxdWFsKCdmb29iYXInKTtcbiAgICBhZGIuZXhlY3V0YWJsZS5kZWZhdWx0QXJncy5zaG91bGQuaW5jbHVkZSgnZm9vYmFyJyk7XG4gIH0pO1xuICBpdCgnc2V0RGV2aWNlIHNob3VsZCBzZXQgdGhlIGRldmljZSBpZCBhbmQgZW11IHBvcnQgZnJvbSBvYmonLCAoKSA9PiB7XG4gICAgYWRiLnNldERldmljZSh7dWRpZDogJ2VtdWxhdG9yLTEyMzQnfSk7XG4gICAgYWRiLmN1ckRldmljZUlkLnNob3VsZC5lcXVhbCgnZW11bGF0b3ItMTIzNCcpO1xuICAgIGFkYi5leGVjdXRhYmxlLmRlZmF1bHRBcmdzLnNob3VsZC5pbmNsdWRlKCdlbXVsYXRvci0xMjM0Jyk7XG4gICAgYWRiLmVtdWxhdG9yUG9ydC5zaG91bGQuZXF1YWwoMTIzNCk7XG4gIH0pO1xuICBpdCgnc2V0RW11bGF0b3JQb3J0IHNob3VsZCBjaGFuZ2UgZW11bGF0b3IgcG9ydCcsICgpID0+IHtcbiAgICBhZGIuc2V0RW11bGF0b3JQb3J0KDU1NTQpO1xuICAgIGFkYi5lbXVsYXRvclBvcnQuc2hvdWxkLmVxdWFsKDU1NTQpO1xuICB9KTtcbiAgZGVzY3JpYmUoJ2NyZWF0ZVN1YlByb2Nlc3MnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gYW4gaW5zdGFuY2Ugb2YgU3ViUHJvY2VzcycsICgpID0+IHtcbiAgICAgIGFkYi5jcmVhdGVTdWJQcm9jZXNzKFtdKS5zaG91bGQuYmUuYW4uaW5zdGFuY2VvZih0ZWVuX3Byb2Nlc3MuU3ViUHJvY2Vzcyk7XG4gICAgfSk7XG4gIH0pO1xufSkpO1xuXG5kZXNjcmliZSgnU3lzdGVtIGNhbGxzJywgIHdpdGhNb2Nrcyh7YWRiLCBCLCB0ZWVuX3Byb2Nlc3N9LCAobW9ja3MpID0+IHtcbiAgaXQoJ3Nob3VsZCByZXR1cm4gYWRiIHZlcnNpb24nLCBhc3luYyAoKSA9PiB7XG4gICAgbW9ja3MuYWRiLmV4cGVjdHMoXCJhZGJFeGVjXCIpXG4gICAgICAub25jZSgpXG4gICAgICAud2l0aEV4YWN0QXJncygndmVyc2lvbicpXG4gICAgICAucmV0dXJucyhcIkFuZHJvaWQgRGVidWcgQnJpZGdlIHZlcnNpb24gMS4wLjM5XFxuUmV2aXNpb24gNTk0MzI3MWFjZTE3LWFuZHJvaWRcIik7XG4gICAgbGV0IGFkYlZlcnNpb24gPSBhd2FpdCBhZGIuZ2V0QWRiVmVyc2lvbigpO1xuICAgIGFkYlZlcnNpb24udmVyc2lvblN0cmluZy5zaG91bGQuZXF1YWwoXCIxLjAuMzlcIik7XG4gICAgYWRiVmVyc2lvbi52ZXJzaW9uRmxvYXQuc2hvdWxkLmJlLndpdGhpbigxLjAsIDEuMCk7XG4gICAgYWRiVmVyc2lvbi5tYWpvci5zaG91bGQuZXF1YWwoMSk7XG4gICAgYWRiVmVyc2lvbi5taW5vci5zaG91bGQuZXF1YWwoMCk7XG4gICAgYWRiVmVyc2lvbi5wYXRjaC5zaG91bGQuZXF1YWwoMzkpO1xuICAgIG1vY2tzLmFkYi52ZXJpZnkoKTtcbiAgfSk7XG4gIGl0KCdzaG91bGQgY2FjaGUgYWRiIHJlc3VsdHMnLCBhc3luYyAoKSA9PiB7XG4gICAgYWRiLmdldEFkYlZlcnNpb24uY2FjaGUgPSBuZXcgXy5tZW1vaXplLkNhY2hlKCk7XG4gICAgbW9ja3MuYWRiLmV4cGVjdHMoXCJhZGJFeGVjXCIpXG4gICAgICAub25jZSgpXG4gICAgICAud2l0aEV4YWN0QXJncygndmVyc2lvbicpXG4gICAgICAucmV0dXJucyhcIkFuZHJvaWQgRGVidWcgQnJpZGdlIHZlcnNpb24gMS4wLjM5XFxuUmV2aXNpb24gNTk0MzI3MWFjZTE3LWFuZHJvaWRcIik7XG4gICAgYXdhaXQgYWRiLmdldEFkYlZlcnNpb24oKTtcbiAgICBhd2FpdCBhZGIuZ2V0QWRiVmVyc2lvbigpO1xuICAgIG1vY2tzLmFkYi52ZXJpZnkoKTtcbiAgfSk7XG4gIGl0KCdmaWxlRXhpc3RzIHNob3VsZCByZXR1cm4gdHJ1ZSBmb3IgaWYgbHMgcmV0dXJucycsIGFzeW5jICgpID0+IHtcbiAgICBtb2Nrcy5hZGIuZXhwZWN0cyhcImxzXCIpXG4gICAgICAub25jZSgpLndpdGhFeGFjdEFyZ3MoJ2ZvbycpXG4gICAgICAucmV0dXJucyhbJ2JhciddKTtcbiAgICBhd2FpdCBhZGIuZmlsZUV4aXN0cyhcImZvb1wiKS5zaG91bGQuZXZlbnR1YWxseS5lcXVhbCh0cnVlKTtcbiAgICBtb2Nrcy5hZGIudmVyaWZ5KCk7XG4gIH0pO1xuICBpdCgnbHMgc2hvdWxkIHJldHVybiBsaXN0JywgYXN5bmMgKCkgPT4ge1xuICAgIG1vY2tzLmFkYi5leHBlY3RzKFwic2hlbGxcIilcbiAgICAgIC5vbmNlKCkud2l0aEV4YWN0QXJncyhbJ2xzJywgJ2ZvbyddKVxuICAgICAgLnJldHVybnMoJ2JhcicpO1xuICAgIGxldCBsaXN0ID0gYXdhaXQgYWRiLmxzKFwiZm9vXCIpO1xuICAgIGxpc3Quc2hvdWxkLmRlZXAuZXF1YWwoWydiYXInXSk7XG4gICAgbW9ja3MuYWRiLnZlcmlmeSgpO1xuICB9KTtcbiAgaXQoJ3JlYm9vdCBzaG91bGQgY2FsbCBzdG9wIGFuZCBzdGFydCB1c2luZyBzaGVsbCcsIGFzeW5jICgpID0+IHtcbiAgICBtb2Nrcy5hZGIuZXhwZWN0cyhcInNoZWxsXCIpXG4gICAgICAub25jZSgpLndpdGhFeGFjdEFyZ3MoWydzdG9wJ10pO1xuICAgIG1vY2tzLmFkYi5leHBlY3RzKFwic2V0RGV2aWNlUHJvcGVydHlcIilcbiAgICAgIC5vbmNlKCkud2l0aEV4YWN0QXJncygnc3lzLmJvb3RfY29tcGxldGVkJywgMCk7XG4gICAgbW9ja3MuYWRiLmV4cGVjdHMoXCJzaGVsbFwiKVxuICAgICAgLm9uY2UoKS53aXRoRXhhY3RBcmdzKFsnc3RhcnQnXSk7XG4gICAgbW9ja3MuYWRiLmV4cGVjdHMoXCJnZXREZXZpY2VQcm9wZXJ0eVwiKVxuICAgICAgLm9uY2UoKS53aXRoRXhhY3RBcmdzKCdzeXMuYm9vdF9jb21wbGV0ZWQnKVxuICAgICAgLnJldHVybnMoJzEnKTtcbiAgICBtb2Nrcy5CLmV4cGVjdHMoXCJkZWxheVwiKVxuICAgICAgLm9uY2UoKS53aXRoRXhhY3RBcmdzKDIwMDApO1xuICAgIGF3YWl0IGFkYi5yZWJvb3QoKS5zaG91bGQuZXZlbnR1YWxseS5ub3QuYmUucmVqZWN0ZWQ7XG4gICAgbW9ja3MuYWRiLnZlcmlmeSgpO1xuICAgIG1vY2tzLkIudmVyaWZ5KCk7XG4gIH0pO1xuICBpdCgncmVib290IHNob3VsZCByZXN0YXJ0IGFkYmQgYXMgcm9vdCBpZiBuZWNlc3NhcnknLCBhc3luYyAoKSA9PiB7XG4gICAgbW9ja3MudGVlbl9wcm9jZXNzLmV4cGVjdHMoXCJleGVjXCIpXG4gICAgICAub25jZSgpLndpdGhFeGFjdEFyZ3MoYWRiLmV4ZWN1dGFibGUucGF0aCwgWydyb290J10pXG4gICAgICAucmV0dXJucyhmYWxzZSk7XG4gICAgbW9ja3MuYWRiLmV4cGVjdHMoXCJzaGVsbFwiKVxuICAgICAgLnR3aWNlKCkud2l0aEV4YWN0QXJncyhbJ3N0b3AnXSlcbiAgICAgIC5vbkZpcnN0Q2FsbCgpXG4gICAgICAgIC50aHJvd3MobmV3IEVycm9yKGBFcnJvciBleGVjdXRpbmcgYWRiRXhlYy4gT3JpZ2luYWwgZXJyb3I6ICdDb21tYW5kICdhZGIgc2hlbGwgc3RvcCcgZXhpdGVkIHdpdGggY29kZSAxJzsgU3RkZXJyOiAnc3RvcDogbXVzdCBiZSByb290JzsgQ29kZTogJzEnYCkpXG4gICAgICAub25TZWNvbmRDYWxsKCkucmV0dXJucygpO1xuICAgIG1vY2tzLmFkYi5leHBlY3RzKFwic2V0RGV2aWNlUHJvcGVydHlcIilcbiAgICAgIC5vbmNlKCkud2l0aEV4YWN0QXJncygnc3lzLmJvb3RfY29tcGxldGVkJywgMCk7XG4gICAgbW9ja3MuYWRiLmV4cGVjdHMoXCJzaGVsbFwiKVxuICAgICAgLm9uY2UoKS53aXRoRXhhY3RBcmdzKFsnc3RhcnQnXSk7XG4gICAgbW9ja3MuYWRiLmV4cGVjdHMoXCJnZXREZXZpY2VQcm9wZXJ0eVwiKVxuICAgICAgLm9uY2UoKS53aXRoRXhhY3RBcmdzKCdzeXMuYm9vdF9jb21wbGV0ZWQnKVxuICAgICAgLnJldHVybnMoJzEnKTtcbiAgICBtb2Nrcy5CLmV4cGVjdHMoXCJkZWxheVwiKVxuICAgICAgLm9uY2UoKS53aXRoRXhhY3RBcmdzKDIwMDApO1xuICAgIGF3YWl0IGFkYi5yZWJvb3QoKS5zaG91bGQuZXZlbnR1YWxseS5ub3QuYmUucmVqZWN0ZWQ7XG4gICAgbW9ja3MuYWRiLnZlcmlmeSgpO1xuICAgIG1vY2tzLkIudmVyaWZ5KCk7XG4gIH0pO1xuICBpdCgnZ2V0UnVubmluZ0FWRCBzaG91bGQgZ2V0IGNvbm5lY3RlZCBhdmQnLCBhc3luYyAoKSA9PiB7XG4gICAgbGV0IHVkaWQgPSAnZW11bGF0b3ItNTU1NCc7XG4gICAgbGV0IHBvcnQgPSA1NTU0O1xuICAgIGxldCBlbXVsYXRvciA9IHt1ZGlkLCBwb3J0fTtcbiAgICBtb2Nrcy5hZGIuZXhwZWN0cyhcImdldENvbm5lY3RlZEVtdWxhdG9yc1wiKVxuICAgICAgLm9uY2UoKS53aXRoRXhhY3RBcmdzKClcbiAgICAgIC5yZXR1cm5zKFtlbXVsYXRvcl0pO1xuICAgIG1vY2tzLmFkYi5leHBlY3RzKFwic2V0RW11bGF0b3JQb3J0XCIpXG4gICAgICAub25jZSgpLndpdGhFeGFjdEFyZ3MocG9ydCk7XG4gICAgbW9ja3MuYWRiLmV4cGVjdHMoXCJzZW5kVGVsbmV0Q29tbWFuZFwiKVxuICAgICAgLm9uY2UoKS53aXRoRXhhY3RBcmdzKFwiYXZkIG5hbWVcIilcbiAgICAgIC5yZXR1cm5zKGF2ZE5hbWUpO1xuICAgIG1vY2tzLmFkYi5leHBlY3RzKFwic2V0RGV2aWNlSWRcIilcbiAgICAgIC5vbmNlKCkud2l0aEV4YWN0QXJncyh1ZGlkKTtcbiAgICAoYXdhaXQgYWRiLmdldFJ1bm5pbmdBVkQoYXZkTmFtZSkpLnNob3VsZC5lcXVhbChlbXVsYXRvcik7XG4gICAgbW9ja3MuYWRiLnZlcmlmeSgpO1xuICB9KTtcbiAgaXQoJ2dldFJ1bm5pbmdBVkQgc2hvdWxkIHJldHVybiBudWxsIHdoZW4gZXhwZWN0ZWQgYXZkIGlzIG5vdCBjb25uZWN0ZWQnLCBhc3luYyAoKSA9PiB7XG4gICAgbGV0IHVkaWQgPSAnZW11bGF0b3ItNTU1NCc7XG4gICAgbGV0IHBvcnQgPSA1NTU0O1xuICAgIGxldCBlbXVsYXRvciA9IHt1ZGlkLCBwb3J0fTtcbiAgICBtb2Nrcy5hZGIuZXhwZWN0cyhcImdldENvbm5lY3RlZEVtdWxhdG9yc1wiKVxuICAgICAgLm9uY2UoKS53aXRoRXhhY3RBcmdzKClcbiAgICAgIC5yZXR1cm5zKFtlbXVsYXRvcl0pO1xuICAgIG1vY2tzLmFkYi5leHBlY3RzKFwic2V0RW11bGF0b3JQb3J0XCIpXG4gICAgICAub25jZSgpLndpdGhFeGFjdEFyZ3MocG9ydCk7XG4gICAgbW9ja3MuYWRiLmV4cGVjdHMoXCJzZW5kVGVsbmV0Q29tbWFuZFwiKVxuICAgICAgLm9uY2UoKS53aXRoRXhhY3RBcmdzKFwiYXZkIG5hbWVcIilcbiAgICAgIC5yZXR1cm5zKCdPVEhFUl9BVkQnKTtcbiAgICBjaGFpLmV4cGVjdChhd2FpdCBhZGIuZ2V0UnVubmluZ0FWRChhdmROYW1lKSkudG8uYmUubnVsbDtcbiAgICBtb2Nrcy5hZGIudmVyaWZ5KCk7XG4gIH0pO1xuICBpdCgnZ2V0UnVubmluZ0FWRCBzaG91bGQgcmV0dXJuIG51bGwgd2hlbiBubyBhdmQgaXMgY29ubmVjdGVkJywgYXN5bmMgKCkgPT4ge1xuICAgIG1vY2tzLmFkYi5leHBlY3RzKFwiZ2V0Q29ubmVjdGVkRW11bGF0b3JzXCIpXG4gICAgICAub25jZSgpLndpdGhFeGFjdEFyZ3MoKVxuICAgICAgLnJldHVybnMoW10pO1xuICAgIGNoYWkuZXhwZWN0KGF3YWl0IGFkYi5nZXRSdW5uaW5nQVZEKGF2ZE5hbWUpKS50by5iZS5udWxsO1xuICAgIG1vY2tzLmFkYi52ZXJpZnkoKTtcbiAgfSk7XG59KSk7XG4iXSwic291cmNlUm9vdCI6Ii4uLy4uLy4uIn0=
