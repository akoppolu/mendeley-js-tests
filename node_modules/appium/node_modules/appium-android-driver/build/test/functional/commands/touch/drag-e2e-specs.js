'use strict';

var _regeneratorRuntime = require('babel-runtime/regenerator')['default'];

var _interopRequireDefault = require('babel-runtime/helpers/interop-require-default')['default'];

var _chai = require('chai');

var _chai2 = _interopRequireDefault(_chai);

var _chaiAsPromised = require('chai-as-promised');

var _chaiAsPromised2 = _interopRequireDefault(_chaiAsPromised);

var _lodash = require('lodash');

var _lodash2 = _interopRequireDefault(_lodash);

var _2 = require('../../../..');

var _3 = _interopRequireDefault(_2);

var _desired = require('../../desired');

var _desired2 = _interopRequireDefault(_desired);

_chai2['default'].should();
_chai2['default'].use(_chaiAsPromised2['default']);

var caps = _lodash2['default'].defaults({
  appPackage: 'io.appium.android.apis',
  appActivity: '.view.DragAndDropDemo'
}, _desired2['default']);

describe('apidemo - touch', function () {
  var _this = this;

  var driver = undefined;
  before(function callee$1$0() {
    return _regeneratorRuntime.async(function callee$1$0$(context$2$0) {
      while (1) switch (context$2$0.prev = context$2$0.next) {
        case 0:
          driver = new _3['default']();
          context$2$0.next = 3;
          return _regeneratorRuntime.awrap(driver.createSession(caps));

        case 3:
        case 'end':
          return context$2$0.stop();
      }
    }, null, _this);
  });
  after(function callee$1$0() {
    return _regeneratorRuntime.async(function callee$1$0$(context$2$0) {
      while (1) switch (context$2$0.prev = context$2$0.next) {
        case 0:
          context$2$0.next = 2;
          return _regeneratorRuntime.awrap(driver.deleteSession());

        case 2:
        case 'end':
          return context$2$0.stop();
      }
    }, null, _this);
  });
  afterEach(function callee$1$0() {
    return _regeneratorRuntime.async(function callee$1$0$(context$2$0) {
      while (1) switch (context$2$0.prev = context$2$0.next) {
        case 0:
          context$2$0.next = 2;
          return _regeneratorRuntime.awrap(driver.startActivity(caps.appPackage, caps.appActivity));

        case 2:
        case 'end':
          return context$2$0.stop();
      }
    }, null, _this);
  });
  describe('drag', function () {
    var _this2 = this;

    it('should drag by element', function callee$2$0() {
      var dot3, dot2, gestures, results;
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            context$3$0.next = 2;
            return _regeneratorRuntime.awrap(driver.findElOrEls('id', 'io.appium.android.apis:id/drag_dot_3', false));

          case 2:
            dot3 = context$3$0.sent;
            context$3$0.next = 5;
            return _regeneratorRuntime.awrap(driver.findElOrEls('id', 'io.appium.android.apis:id/drag_dot_2', false));

          case 5:
            dot2 = context$3$0.sent;
            gestures = [{ options: { element: dot3.ELEMENT } }, { options: { element: dot2.ELEMENT } }];
            context$3$0.next = 9;
            return _regeneratorRuntime.awrap(driver.doTouchDrag(gestures));

          case 9:
            context$3$0.next = 11;
            return _regeneratorRuntime.awrap(driver.findElOrEls('id', 'io.appium.android.apis:id/drag_result_text', false));

          case 11:
            results = context$3$0.sent;
            context$3$0.next = 14;
            return _regeneratorRuntime.awrap(driver.getText(results.ELEMENT).should.eventually.include('Dropped'));

          case 14:
          case 'end':
            return context$3$0.stop();
        }
      }, null, _this2);
    });
    it('should drag by element with an offset', function callee$2$0() {
      var dot3, dot2, gestures, results;
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            context$3$0.next = 2;
            return _regeneratorRuntime.awrap(driver.findElOrEls('id', 'io.appium.android.apis:id/drag_dot_3', false));

          case 2:
            dot3 = context$3$0.sent;
            context$3$0.next = 5;
            return _regeneratorRuntime.awrap(driver.findElOrEls('id', 'io.appium.android.apis:id/drag_dot_2', false));

          case 5:
            dot2 = context$3$0.sent;
            gestures = [{ options: { element: dot3.ELEMENT, x: 5, y: 5 } }, { options: { element: dot2.ELEMENT, x: 5, y: 5 } }];
            context$3$0.next = 9;
            return _regeneratorRuntime.awrap(driver.doTouchDrag(gestures));

          case 9:
            context$3$0.next = 11;
            return _regeneratorRuntime.awrap(driver.findElOrEls('id', 'io.appium.android.apis:id/drag_result_text', false));

          case 11:
            results = context$3$0.sent;
            context$3$0.next = 14;
            return _regeneratorRuntime.awrap(driver.getText(results.ELEMENT).should.eventually.include('Dropped'));

          case 14:
          case 'end':
            return context$3$0.stop();
        }
      }, null, _this2);
    });
  });
  describe('performTouch', function () {
    var _this3 = this;

    it('should drag by element', function callee$2$0() {
      var startEle, endEle, gestures, resultEle;
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            context$3$0.next = 2;
            return _regeneratorRuntime.awrap(driver.findElement("id", "io.appium.android.apis:id/drag_dot_3"));

          case 2:
            startEle = context$3$0.sent;
            context$3$0.next = 5;
            return _regeneratorRuntime.awrap(driver.findElement("id", "io.appium.android.apis:id/drag_dot_2"));

          case 5:
            endEle = context$3$0.sent;
            gestures = [{ "action": "longPress", "options": { "element": startEle.ELEMENT } }, { "action": "moveTo", "options": { "element": endEle.ELEMENT } }, { "action": "release", "options": {} }];
            context$3$0.next = 9;
            return _regeneratorRuntime.awrap(driver.performTouch(gestures));

          case 9:
            context$3$0.next = 11;
            return _regeneratorRuntime.awrap(driver.findElement("id", "io.appium.android.apis:id/drag_result_text"));

          case 11:
            resultEle = context$3$0.sent;
            context$3$0.next = 14;
            return _regeneratorRuntime.awrap(driver.getText(resultEle.ELEMENT).should.eventually.equal("Dropped!"));

          case 14:
          case 'end':
            return context$3$0.stop();
        }
      }, null, _this3);
    });
    it('should drag by element by offset', function callee$2$0() {
      var startEle, endEle, gestures, element3;
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            context$3$0.next = 2;
            return _regeneratorRuntime.awrap(driver.findElement("id", "io.appium.android.apis:id/drag_dot_3"));

          case 2:
            startEle = context$3$0.sent;
            context$3$0.next = 5;
            return _regeneratorRuntime.awrap(driver.findElement("id", "io.appium.android.apis:id/drag_dot_2"));

          case 5:
            endEle = context$3$0.sent;
            gestures = [{ "action": "longPress",
              "options": { "element": startEle.ELEMENT, "x": 5, "y": 5 } }, { "action": "moveTo", "options": { "element": endEle.ELEMENT, "x": 5, "y": 5 } }, { "action": "release", "options": {} }];
            context$3$0.next = 9;
            return _regeneratorRuntime.awrap(driver.performTouch(gestures));

          case 9:
            context$3$0.next = 11;
            return _regeneratorRuntime.awrap(driver.findElement("id", "io.appium.android.apis:id/drag_result_text"));

          case 11:
            element3 = context$3$0.sent;
            context$3$0.next = 14;
            return _regeneratorRuntime.awrap(driver.getText(element3.ELEMENT).should.eventually.equal("Dropped!"));

          case 14:
          case 'end':
            return context$3$0.stop();
        }
      }, null, _this3);
    });
    it('should drag by absolute position', function callee$2$0() {
      var startEle, startLoc, startSize, endEle, endLoc, endSize, gestures, resultEle;
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            context$3$0.next = 2;
            return _regeneratorRuntime.awrap(driver.findElement("id", "io.appium.android.apis:id/drag_dot_3"));

          case 2:
            startEle = context$3$0.sent;
            context$3$0.next = 5;
            return _regeneratorRuntime.awrap(driver.getLocationInView(startEle.ELEMENT));

          case 5:
            startLoc = context$3$0.sent;
            context$3$0.next = 8;
            return _regeneratorRuntime.awrap(driver.getSize(startEle.ELEMENT));

          case 8:
            startSize = context$3$0.sent;
            context$3$0.next = 11;
            return _regeneratorRuntime.awrap(driver.findElement("id", "io.appium.android.apis:id/drag_dot_2"));

          case 11:
            endEle = context$3$0.sent;
            context$3$0.next = 14;
            return _regeneratorRuntime.awrap(driver.getLocationInView(endEle.ELEMENT));

          case 14:
            endLoc = context$3$0.sent;
            context$3$0.next = 17;
            return _regeneratorRuntime.awrap(driver.getSize(endEle.ELEMENT));

          case 17:
            endSize = context$3$0.sent;
            gestures = [{ "action": "longPress",
              "options": { "x": startLoc.x + startSize.width / 2,
                "y": startLoc.y + startSize.height / 2 } }, { "action": "moveTo",
              "options": { "x": endLoc.x + endSize.width / 2,
                "y": endLoc.y + endSize.height / 2 } }, { "action": "release", "options": {} }];
            context$3$0.next = 21;
            return _regeneratorRuntime.awrap(driver.performTouch(gestures));

          case 21:
            context$3$0.next = 23;
            return _regeneratorRuntime.awrap(driver.findElement("id", "io.appium.android.apis:id/drag_result_text"));

          case 23:
            resultEle = context$3$0.sent;
            context$3$0.next = 26;
            return _regeneratorRuntime.awrap(driver.getText(resultEle.ELEMENT).should.eventually.equal("Dropped!"));

          case 26:
          case 'end':
            return context$3$0.stop();
        }
      }, null, _this3);
    });
  });
});

// reset the view by restarting the activity
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInRlc3QvZnVuY3Rpb25hbC9jb21tYW5kcy90b3VjaC9kcmFnLWUyZS1zcGVjcy5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7b0JBQWlCLE1BQU07Ozs7OEJBQ0ksa0JBQWtCOzs7O3NCQUMvQixRQUFROzs7O2lCQUNJLGFBQWE7Ozs7dUJBQ2QsZUFBZTs7OztBQUd4QyxrQkFBSyxNQUFNLEVBQUUsQ0FBQztBQUNkLGtCQUFLLEdBQUcsNkJBQWdCLENBQUM7O0FBRXpCLElBQUksSUFBSSxHQUFHLG9CQUFFLFFBQVEsQ0FBQztBQUNwQixZQUFVLEVBQUUsd0JBQXdCO0FBQ3BDLGFBQVcsRUFBRSx1QkFBdUI7Q0FDckMsdUJBQWUsQ0FBQzs7QUFFakIsUUFBUSxDQUFDLGlCQUFpQixFQUFFLFlBQVk7OztBQUN0QyxNQUFJLE1BQU0sWUFBQSxDQUFDO0FBQ1gsUUFBTSxDQUFDOzs7O0FBQ0wsZ0JBQU0sR0FBRyxtQkFBbUIsQ0FBQzs7MkNBQ3ZCLE1BQU0sQ0FBQyxhQUFhLENBQUMsSUFBSSxDQUFDOzs7Ozs7O0dBQ2pDLENBQUMsQ0FBQztBQUNILE9BQUssQ0FBQzs7Ozs7MkNBQ0UsTUFBTSxDQUFDLGFBQWEsRUFBRTs7Ozs7OztHQUM3QixDQUFDLENBQUM7QUFDSCxXQUFTLENBQUM7Ozs7OzJDQUVGLE1BQU0sQ0FBQyxhQUFhLENBQUMsSUFBSSxDQUFDLFVBQVUsRUFBRSxJQUFJLENBQUMsV0FBVyxDQUFDOzs7Ozs7O0dBQzlELENBQUMsQ0FBQztBQUNILFVBQVEsQ0FBQyxNQUFNLEVBQUUsWUFBWTs7O0FBQzNCLE1BQUUsQ0FBQyx3QkFBd0IsRUFBRTtVQUN2QixJQUFJLEVBQ0osSUFBSSxFQUNKLFFBQVEsRUFNUixPQUFPOzs7Ozs2Q0FSTSxNQUFNLENBQUMsV0FBVyxDQUFDLElBQUksRUFBRSxzQ0FBc0MsRUFBRSxLQUFLLENBQUM7OztBQUFwRixnQkFBSTs7NkNBQ1MsTUFBTSxDQUFDLFdBQVcsQ0FBQyxJQUFJLEVBQUUsc0NBQXNDLEVB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QVUsQ0FBQzs7Ozs7OztLQUM1RSxDQUFDLENBQUM7R0FDSixDQUFDLENBQUM7Q0FDSixDQUFDLENBQUMiLCJmaWxlIjoidGVzdC9mdW5jdGlvbmFsL2NvbW1hbmRzL3RvdWNoL2RyYWctZTJlLXNwZWNzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGNoYWkgZnJvbSAnY2hhaSc7XG5pbXBvcnQgY2hhaUFzUHJvbWlzZWQgZnJvbSAnY2hhaS1hcy1wcm9taXNlZCc7XG5pbXBvcnQgXyBmcm9tICdsb2Rhc2gnO1xuaW1wb3J0IEFuZHJvaWREcml2ZXIgZnJvbSAnLi4vLi4vLi4vLi4nO1xuaW1wb3J0IERFRkFVTFRfQ0FQUyBmcm9tICcuLi8uLi9kZXNpcmVkJztcblxuXG5jaGFpLnNob3VsZCgpO1xuY2hhaS51c2UoY2hhaUFzUHJvbWlzZWQpO1xuXG5sZXQgY2FwcyA9IF8uZGVmYXVsdHMoe1xuICBhcHBQYWNrYWdlOiAnaW8uYXBwaXVtLmFuZHJvaWQuYXBpcycsXG4gIGFwcEFjdGl2aXR5OiAnLnZpZXcuRHJhZ0FuZERyb3BEZW1vJ1xufSwgREVGQVVMVF9DQVBTKTtcblxuZGVzY3JpYmUoJ2FwaWRlbW8gLSB0b3VjaCcsIGZ1bmN0aW9uICgpIHtcbiAgbGV0IGRyaXZlcjtcbiAgYmVmb3JlKGFzeW5jICgpID0+IHtcbiAgICBkcml2ZXIgPSBuZXcgQW5kcm9pZERyaXZlcigpO1xuICAgIGF3YWl0IGRyaXZlci5jcmVhdGVTZXNzaW9uKGNhcHMpO1xuICB9KTtcbiAgYWZ0ZXIoYXN5bmMgKCkgPT4ge1xuICAgIGF3YWl0IGRyaXZlci5kZWxldGVTZXNzaW9uKCk7XG4gIH0pO1xuICBhZnRlckVhY2goYXN5bmMgKCkgPT4ge1xuICAgIC8vIHJlc2V0IHRoZSB2aWV3IGJ5IHJlc3RhcnRpbmcgdGhlIGFjdGl2aXR5XG4gICAgYXdhaXQgZHJpdmVyLnN0YXJ0QWN0aXZpdHkoY2Fwcy5hcHBQYWNrYWdlLCBjYXBzLmFwcEFjdGl2aXR5KTtcbiAgfSk7XG4gIGRlc2NyaWJlKCdkcmFnJywgZnVuY3Rpb24gKCkge1xuICAgIGl0KCdzaG91bGQgZHJhZyBieSBlbGVtZW50JywgYXN5bmMgKCkgPT4ge1xuICAgICAgbGV0IGRvdDMgPSBhd2FpdCBkcml2ZXIuZmluZEVsT3JFbHMoJ2lkJywgJ2lvLmFwcGl1bS5hbmRyb2lkLmFwaXM6aWQvZHJhZ19kb3RfMycsIGZhbHNlKTtcbiAgICAgIGxldCBkb3QyID0gYXdhaXQgZHJpdmVyLmZpbmRFbE9yRWxzKCdpZCcsICdpby5hcHBpdW0uYW5kcm9pZC5hcGlzOmlkL2RyYWdfZG90XzInLCBmYWxzZSk7XG4gICAgICBsZXQgZ2VzdHVyZXMgPSBbXG4gICAgICAgIHtvcHRpb25zOiB7ZWxlbWVudDogZG90My5FTEVNRU5UfX0sXG4gICAgICAgIHtvcHRpb25zOiB7ZWxlbWVudDogZG90Mi5FTEVNRU5UfX1cbiAgICAgIF07XG4gICAgICBhd2FpdCBkcml2ZXIuZG9Ub3VjaERyYWcoZ2VzdHVyZXMpO1xuXG4gICAgICBsZXQgcmVzdWx0cyA9IGF3YWl0IGRyaXZlci5maW5kRWxPckVscygnaWQnLCAnaW8uYXBwaXVtLmFuZHJvaWQuYXBpczppZC9kcmFnX3Jlc3VsdF90ZXh0JywgZmFsc2UpO1xuICAgICAgYXdhaXQgZHJpdmVyLmdldFRleHQocmVzdWx0cy5FTEVNRU5UKS5zaG91bGQuZXZlbnR1YWxseS5pbmNsdWRlKCdEcm9wcGVkJyk7XG4gICAgfSk7XG4gICAgaXQoJ3Nob3VsZCBkcmFnIGJ5IGVsZW1lbnQgd2l0aCBhbiBvZmZzZXQnLCBhc3luYyAoKSA9PiB7XG4gICAgICBsZXQgZG90MyA9IGF3YWl0IGRyaXZlci5maW5kRWxPckVscygnaWQnLCAnaW8uYXBwaXVtLmFuZHJvaWQuYXBpczppZC9kcmFnX2RvdF8zJywgZmFsc2UpO1xuICAgICAgbGV0IGRvdDIgPSBhd2FpdCBkcml2ZXIuZmluZEVsT3JFbHMoJ2lkJywgJ2lvLmFwcGl1bS5hbmRyb2lkLmFwaXM6aWQvZHJhZ19kb3RfMicsIGZhbHNlKTtcbiAgICAgIGxldCBnZXN0dXJlcyA9IFtcbiAgICAgICAge29wdGlvbnM6IHtlbGVtZW50OiBkb3QzLkVMRU1FTlQsIHg6IDUsIHk6IDV9fSxcbiAgICAgICAge29wdGlvbnM6IHtlbGVtZW50OiBkb3QyLkVMRU1FTlQsIHg6IDUsIHk6IDV9fVxuICAgICAgXTtcbiAgICAgIGF3YWl0IGRyaXZlci5kb1RvdWNoRHJhZyhnZXN0dXJlcyk7XG4gICAgICBsZXQgcmVzdWx0cyA9IGF3YWl0IGRyaXZlci5maW5kRWxPckVscygnaWQnLCAnaW8uYXBwaXVtLmFuZHJvaWQuYXBpczppZC9kcmFnX3Jlc3VsdF90ZXh0JywgZmFsc2UpO1xuICAgICAgYXdhaXQgZHJpdmVyLmdldFRleHQocmVzdWx0cy5FTEVNRU5UKS5zaG91bGQuZXZlbnR1YWxseS5pbmNsdWRlKCdEcm9wcGVkJyk7XG4gICAgfSk7XG4gIH0pO1xuICBkZXNjcmliZSgncGVyZm9ybVRvdWNoJywgZnVuY3Rpb24gKCkge1xuICAgIGl0KCdzaG91bGQgZHJhZyBieSBlbGVtZW50JywgYXN5bmMgKCkgPT4ge1xuICAgICAgbGV0IHN0YXJ0RWxlID0gYXdhaXQgZHJpdmVyLmZpbmRFbGVtZW50KFwiaWRcIiwgXCJpby5hcHBpdW0uYW5kcm9pZC5hcGlzOmlkL2RyYWdfZG90XzNcIik7XG4gICAgICBsZXQgZW5kRWxlID0gYXdhaXQgZHJpdmVyLmZpbmRFbGVtZW50KFwiaWRcIiwgXCJpby5hcHBpdW0uYW5kcm9pZC5hcGlzOmlkL2RyYWdfZG90XzJcIik7XG4gICAgICBsZXQgZ2VzdHVyZXMgPSBbe1wiYWN0aW9uXCI6IFwibG9uZ1ByZXNzXCIsIFwib3B0aW9uc1wiOiB7XCJlbGVtZW50XCI6IHN0YXJ0RWxlLkVMRU1FTlR9fSxcbiAgICAgICAgICAgICAgICAgICAgICB7XCJhY3Rpb25cIjogXCJtb3ZlVG9cIiwgXCJvcHRpb25zXCI6IHtcImVsZW1lbnRcIjogZW5kRWxlLkVMRU1FTlR9fSxcbiAgICAgICAgICAgICAgICAgICAgICB7XCJhY3Rpb25cIjogXCJyZWxlYXNlXCIsIFwib3B0aW9uc1wiOiB7fX1dO1xuICAgICAgYXdhaXQgZHJpdmVyLnBlcmZvcm1Ub3VjaChnZXN0dXJlcyk7XG4gICAgICBsZXQgcmVzdWx0RWxlID0gYXdhaXQgZHJpdmVyLmZpbmRFbGVtZW50KFwiaWRcIiwgXCJpby5hcHBpdW0uYW5kcm9pZC5hcGlzOmlkL2RyYWdfcmVzdWx0X3RleHRcIik7XG4gICAgICBhd2FpdCBkcml2ZXIuZ2V0VGV4dChyZXN1bHRFbGUuRUxFTUVOVCkuc2hvdWxkLmV2ZW50dWFsbHkuZXF1YWwoXCJEcm9wcGVkIVwiKTtcbiAgICB9KTtcbiAgICBpdCgnc2hvdWxkIGRyYWcgYnkgZWxlbWVudCBieSBvZmZzZXQnLCBhc3luYyAoKSA9PiB7XG4gICAgICBsZXQgc3RhcnRFbGUgPSBhd2FpdCBkcml2ZXIuZmluZEVsZW1lbnQoXCJpZFwiLCBcImlvLmFwcGl1bS5hbmRyb2lkLmFwaXM6aWQvZHJhZ19kb3RfM1wiKTtcbiAgICAgIGxldCBlbmRFbGUgPSBhd2FpdCBkcml2ZXIuZmluZEVsZW1lbnQoXCJpZFwiLCBcImlvLmFwcGl1bS5hbmRyb2lkLmFwaXM6aWQvZHJhZ19kb3RfMlwiKTtcbiAgICAgIGxldCBnZXN0dXJlcyA9IFt7XCJhY3Rpb25cIjogXCJsb25nUHJlc3NcIixcbiAgICAgICAgICAgICAgICAgICAgICAgXCJvcHRpb25zXCI6IHtcImVsZW1lbnRcIjogc3RhcnRFbGUuRUxFTUVOVCwgXCJ4XCI6IDUsIFwieVwiOiA1fX0sXG4gICAgICAgICAgICAgICAgICAgICAge1wiYWN0aW9uXCI6IFwibW92ZVRvXCIsIFwib3B0aW9uc1wiOlxuICAgICAgICAgICAgICAgICAgICAgIHtcImVsZW1lbnRcIjogZW5kRWxlLkVMRU1FTlQsIFwieFwiOiA1LCBcInlcIjogNX19LFxuICAgICAgICAgICAgICAgICAgICAgIHtcImFjdGlvblwiOiBcInJlbGVhc2VcIiwgXCJvcHRpb25zXCI6e319XTtcbiAgICAgIGF3YWl0IGRyaXZlci5wZXJmb3JtVG91Y2goZ2VzdHVyZXMpO1xuICAgICAgbGV0IGVsZW1lbnQzID0gYXdhaXQgZHJpdmVyLmZpbmRFbGVtZW50KFwiaWRcIiwgXCJpby5hcHBpdW0uYW5kcm9pZC5hcGlzOmlkL2RyYWdfcmVzdWx0X3RleHRcIik7XG4gICAgICBhd2FpdCBkcml2ZXIuZ2V0VGV4dChlbGVtZW50My5FTEVNRU5UKS5zaG91bGQuZXZlbnR1YWxseS5lcXVhbChcIkRyb3BwZWQhXCIpO1xuICAgIH0pO1xuICAgIGl0KCdzaG91bGQgZHJhZyBieSBhYnNvbHV0ZSBwb3NpdGlvbicsIGFzeW5jICgpID0+IHtcbiAgICAgIGxldCBzdGFydEVsZSA9IGF3YWl0IGRyaXZlci5maW5kRWxlbWVudChcImlkXCIsIFwiaW8uYXBwaXVtLmFuZHJvaWQuYXBpczppZC9kcmFnX2RvdF8zXCIpO1xuICAgICAgbGV0IHN0YXJ0TG9jID0gYXdhaXQgZHJpdmVyLmdldExvY2F0aW9uSW5WaWV3KHN0YXJ0RWxlLkVMRU1FTlQpO1xuICAgICAgbGV0IHN0YXJ0U2l6ZSA9IGF3YWl0IGRyaXZlci5nZXRTaXplKHN0YXJ0RWxlLkVMRU1FTlQpO1xuICAgICAgbGV0IGVuZEVsZSA9IGF3YWl0IGRyaXZlci5maW5kRWxlbWVudChcImlkXCIsIFwiaW8uYXBwaXVtLmFuZHJvaWQuYXBpczppZC9kcmFnX2RvdF8yXCIpO1xuICAgICAgbGV0IGVuZExvYyA9IGF3YWl0IGRyaXZlci5nZXRMb2NhdGlvbkluVmlldyhlbmRFbGUuRUxFTUVOVCk7XG4gICAgICBsZXQgZW5kU2l6ZSA9IGF3YWl0IGRyaXZlci5nZXRTaXplKGVuZEVsZS5FTEVNRU5UKTtcbiAgICAgIGxldCBnZXN0dXJlcyA9IFt7XCJhY3Rpb25cIjogXCJsb25nUHJlc3NcIixcbiAgICAgICAgICAgICAgICAgICAgICAgXCJvcHRpb25zXCI6IHtcInhcIjogc3RhcnRMb2MueCArIChzdGFydFNpemUud2lkdGggLyAyKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ5XCI6IHN0YXJ0TG9jLnkgKyAoc3RhcnRTaXplLmhlaWdodCAvIDIpfX0sXG4gICAgICAgICAgICAgICAgICAgICAge1wiYWN0aW9uXCI6IFwibW92ZVRvXCIsXG4gICAgICAgICAgICAgICAgICAgICAgIFwib3B0aW9uc1wiOiB7XCJ4XCI6IGVuZExvYy54ICsgKGVuZFNpemUud2lkdGggLyAyKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ5XCI6IGVuZExvYy55ICsgKGVuZFNpemUuaGVpZ2h0IC8gMil9fSxcbiAgICAgICAgICAgICAgICAgICAgICB7XCJhY3Rpb25cIjogXCJyZWxlYXNlXCIsIFwib3B0aW9uc1wiOnt9fV07XG4gICAgICBhd2FpdCBkcml2ZXIucGVyZm9ybVRvdWNoKGdlc3R1cmVzKTtcbiAgICAgIGxldCByZXN1bHRFbGUgPSBhd2FpdCBkcml2ZXIuZmluZEVsZW1lbnQoXCJpZFwiLCBcImlvLmFwcGl1bS5hbmRyb2lkLmFwaXM6aWQvZHJhZ19yZXN1bHRfdGV4dFwiKTtcbiAgICAgIGF3YWl0IGRyaXZlci5nZXRUZXh0KHJlc3VsdEVsZS5FTEVNRU5UKS5zaG91bGQuZXZlbnR1YWxseS5lcXVhbChcIkRyb3BwZWQhXCIpO1xuICAgIH0pO1xuICB9KTtcbn0pO1xuIl0sInNvdXJjZVJvb3QiOiIuLi8uLi8uLi8uLi8uLiJ9
