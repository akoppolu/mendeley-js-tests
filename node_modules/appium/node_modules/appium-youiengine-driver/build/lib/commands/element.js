'use strict';

var _regeneratorRuntime = require('babel-runtime/regenerator')['default'];

Object.defineProperty(exports, '__esModule', {
  value: true
});

var _appiumBaseDriver = require('appium-base-driver');

var _utils = require('../utils');

var _appiumSupport = require('appium-support');

var commands = {};

commands.getAttribute = function callee$0$0(attribute, el) {
  var commandObject, commandJSON, data, result;
  return _regeneratorRuntime.async(function callee$0$0$(context$1$0) {
    while (1) switch (context$1$0.prev = context$1$0.next) {
      case 0:
        el = (0, _utils.unwrapEl)(el);

        commandObject = {
          name: 'getAttribute',
          args: ['' + el, '' + attribute]
        };
        commandJSON = JSON.stringify(commandObject);
        context$1$0.next = 5;
        return _regeneratorRuntime.awrap(this.executeSocketCommand(commandJSON));

      case 5:
        data = context$1$0.sent;
        result = undefined;
        context$1$0.prev = 7;

        result = JSON.parse(data);
        context$1$0.next = 14;
        break;

      case 11:
        context$1$0.prev = 11;
        context$1$0.t0 = context$1$0['catch'](7);
        throw new Error("Bad response from getAttribute");

      case 14:
        if (!(result.status === _utils.youiEngineDriverReturnValues.WEBDRIVER_STALE_ELEMENT)) {
          context$1$0.next = 16;
          break;
        }

        throw new _appiumBaseDriver.errors.StaleElementReferenceError();

      case 16:
        return context$1$0.abrupt('return', result.value);

      case 17:
      case 'end':
        return context$1$0.stop();
    }
  }, null, this, [[7, 11]]);
};

commands.setValue = function callee$0$0(value, el) {
  var commandObject, commandJSON, data, result;
  return _regeneratorRuntime.async(function callee$0$0$(context$1$0) {
    while (1) switch (context$1$0.prev = context$1$0.next) {
      case 0:
        el = (0, _utils.unwrapEl)(el);
        //First, click to put the element in context
        context$1$0.next = 3;
        return _regeneratorRuntime.awrap(this.click(el));

      case 3:

        if (value instanceof Array) {
          value = value.join("");
        }
        if (typeof value !== 'string') {
          value = '' + value;
        }
        value = _appiumSupport.util.escapeSpecialChars(value, "'");
        // de-escape \n so it can be used specially
        value = value.replace(/\\\\n/g, "\\n");

        commandObject = {
          name: 'sendkeys',
          args: ['' + el, '' + value]
        };
        commandJSON = JSON.stringify(commandObject);
        context$1$0.next = 11;
        return _regeneratorRuntime.awrap(this.executeSocketCommand(commandJSON));

      case 11:
        data = context$1$0.sent;
        result = undefined;
        context$1$0.prev = 13;

        result = JSON.parse(data);
        context$1$0.next = 20;
        break;

      case 17:
        context$1$0.prev = 17;
        context$1$0.t0 = context$1$0['catch'](13);
        throw new Error("Bad response from setValue");

      case 20:
        if (!(result.status === _utils.youiEngineDriverReturnValues.WEBDRIVER_STALE_ELEMENT)) {
          context$1$0.next = 22;
          break;
        }

        throw new _appiumBaseDriver.errors.StaleElementReferenceError();

      case 22:
        return context$1$0.abrupt('return', result.value);

      case 23:
      case 'end':
        return context$1$0.stop();
    }
  }, null, this, [[13, 17]]);
};

commands.getText = function callee$0$0(el) {
  var commandObject, commandJSON, data, result;
  return _regeneratorRuntime.async(function callee$0$0$(context$1$0) {
    while (1) switch (context$1$0.prev = context$1$0.next) {
      case 0:
        el = (0, _utils.unwrapEl)(el);

        commandObject = {
          name: 'getText',
          args: ['' + el]
        };
        commandJSON = JSON.stringify(commandObject);
        context$1$0.next = 5;
        return _regeneratorRuntime.awrap(this.executeSocketCommand(commandJSON));

      case 5:
        data = context$1$0.sent;
        result = undefined;
        context$1$0.prev = 7;

        result = JSON.parse(data);
        context$1$0.next = 14;
        break;

      case 11:
        context$1$0.prev = 11;
        context$1$0.t0 = context$1$0['catch'](7);
        throw new Error("Bad response from getText");

      case 14:
        if (!(result.status === _utils.youiEngineDriverReturnValues.WEBDRIVER_STALE_ELEMENT)) {
          context$1$0.next = 16;
          break;
        }

        throw new _appiumBaseDriver.errors.StaleElementReferenceError();

      case 16:
        return context$1$0.abrupt('return', result.value);

      case 17:
      case 'end':
        return context$1$0.stop();
    }
  }, null, this, [[7, 11]]);
};

commands.elementEnabled = function callee$0$0(el) {
  var commandObject, commandJSON, data, result;
  return _regeneratorRuntime.async(function callee$0$0$(context$1$0) {
    while (1) switch (context$1$0.prev = context$1$0.next) {
      case 0:

        el = (0, _utils.unwrapEl)(el);

        commandObject = {
          name: 'elementEnabled',
          args: ['' + el]
        };
        commandJSON = JSON.stringify(commandObject);
        context$1$0.next = 5;
        return _regeneratorRuntime.awrap(this.executeSocketCommand(commandJSON));

      case 5:
        data = context$1$0.sent;
        result = undefined;
        context$1$0.prev = 7;

        result = JSON.parse(data);
        context$1$0.next = 14;
        break;

      case 11:
        context$1$0.prev = 11;
        context$1$0.t0 = context$1$0['catch'](7);
        throw new Error("Bad response from elementEnabled");

      case 14:
        if (!(result.status === _utils.youiEngineDriverReturnValues.WEBDRIVER_UNKNOWN_COMMAND)) {
          context$1$0.next = 18;
          break;
        }

        throw new _appiumBaseDriver.errors.UnknownCommandError();

      case 18:
        if (!(result.status === _utils.youiEngineDriverReturnValues.WEBDRIVER_NO_SUCH_ELEMENT)) {
          context$1$0.next = 20;
          break;
        }

        throw new _appiumBaseDriver.errors.NoSuchElementError();

      case 20:
        return context$1$0.abrupt('return', result.value);

      case 21:
      case 'end':
        return context$1$0.stop();
    }
  }, null, this, [[7, 11]]);
};

commands.elementSelected = function callee$0$0(el) {
  var commandObject, commandJSON, data, result;
  return _regeneratorRuntime.async(function callee$0$0$(context$1$0) {
    while (1) switch (context$1$0.prev = context$1$0.next) {
      case 0:

        el = (0, _utils.unwrapEl)(el);

        commandObject = {
          name: 'elementSelected',
          args: ['' + el]
        };
        commandJSON = JSON.stringify(commandObject);
        context$1$0.next = 5;
        return _regeneratorRuntime.awrap(this.executeSocketCommand(commandJSON));

      case 5:
        data = context$1$0.sent;
        result = undefined;
        context$1$0.prev = 7;

        result = JSON.parse(data);
        context$1$0.next = 14;
        break;

      case 11:
        context$1$0.prev = 11;
        context$1$0.t0 = context$1$0['catch'](7);
        throw new Error("Bad response from elementSelected");

      case 14:
        if (!(result.status === _utils.youiEngineDriverReturnValues.WEBDRIVER_ELEMENT_IS_NOT_SELECTABLE)) {
          context$1$0.next = 18;
          break;
        }

        throw new _appiumBaseDriver.errors.ElementIsNotSelectableError();

      case 18:
        if (!(result.status === _utils.youiEngineDriverReturnValues.WEBDRIVER_NO_SUCH_ELEMENT)) {
          context$1$0.next = 20;
          break;
        }

        throw new _appiumBaseDriver.errors.NoSuchElementError();

      case 20:
        return context$1$0.abrupt('return', result.value);

      case 21:
      case 'end':
        return context$1$0.stop();
    }
  }, null, this, [[7, 11]]);
};

commands.elementDisplayed = function callee$0$0(el) {
  var commandObject, commandJSON, data, result;
  return _regeneratorRuntime.async(function callee$0$0$(context$1$0) {
    while (1) switch (context$1$0.prev = context$1$0.next) {
      case 0:

        el = (0, _utils.unwrapEl)(el);

        commandObject = {
          name: 'elementDisplayed',
          args: ['' + el]
        };
        commandJSON = JSON.stringify(commandObject);
        context$1$0.next = 5;
        return _regeneratorRuntime.awrap(this.executeSocketCommand(commandJSON));

      case 5:
        data = context$1$0.sent;
        result = undefined;
        context$1$0.prev = 7;

        result = JSON.parse(data);
        context$1$0.next = 14;
        break;

      case 11:
        context$1$0.prev = 11;
        context$1$0.t0 = context$1$0['catch'](7);
        throw new Error("Bad response from elementDisplayed");

      case 14:
        if (!(result.status === _utils.youiEngineDriverReturnValues.WEBDRIVER_UNKNOWN_COMMAND)) {
          context$1$0.next = 18;
          break;
        }

        throw new _appiumBaseDriver.errors.UnknownCommandError();

      case 18:
        if (!(result.status === _utils.youiEngineDriverReturnValues.WEBDRIVER_NO_SUCH_ELEMENT)) {
          context$1$0.next = 20;
          break;
        }

        throw new _appiumBaseDriver.errors.NoSuchElementError();

      case 20:
        return context$1$0.abrupt('return', result.value);

      case 21:
      case 'end':
        return context$1$0.stop();
    }
  }, null, this, [[7, 11]]);
};

commands.clear = function callee$0$0(el) {
  var commandObject, commandJSON, data, result;
  return _regeneratorRuntime.async(function callee$0$0$(context$1$0) {
    while (1) switch (context$1$0.prev = context$1$0.next) {
      case 0:
        el = (0, _utils.unwrapEl)(el);

        commandObject = {
          name: 'clear',
          args: ['' + el]
        };
        commandJSON = JSON.stringify(commandObject);
        context$1$0.next = 5;
        return _regeneratorRuntime.awrap(this.executeSocketCommand(commandJSON));

      case 5:
        data = context$1$0.sent;
        result = undefined;
        context$1$0.prev = 7;

        result = JSON.parse(data);
        context$1$0.next = 14;
        break;

      case 11:
        context$1$0.prev = 11;
        context$1$0.t0 = context$1$0['catch'](7);
        throw new Error("Bad response from clear");

      case 14:
        if (!(result.status === _utils.youiEngineDriverReturnValues.WEBDRIVER_NO_SUCH_ELEMENT)) {
          context$1$0.next = 18;
          break;
        }

        throw new _appiumBaseDriver.errors.NoSuchElementError();

      case 18:
        if (!(result.status === _utils.youiEngineDriverReturnValues.WEBDRIVER_UNKNOWN_COMMAND)) {
          context$1$0.next = 20;
          break;
        }

        throw new _appiumBaseDriver.errors.UnknownCommandError();

      case 20:
        return context$1$0.abrupt('return', result.value);

      case 21:
      case 'end':
        return context$1$0.stop();
    }
  }, null, this, [[7, 11]]);
};

commands.getLocation = function callee$0$0(el) {
  var commandObject, commandJSON, data, result;
  return _regeneratorRuntime.async(function callee$0$0$(context$1$0) {
    while (1) switch (context$1$0.prev = context$1$0.next) {
      case 0:

        el = (0, _utils.unwrapEl)(el);

        commandObject = {
          name: 'elementLocation',
          args: ['' + el]
        };
        commandJSON = JSON.stringify(commandObject);
        context$1$0.next = 5;
        return _regeneratorRuntime.awrap(this.executeSocketCommand(commandJSON));

      case 5:
        data = context$1$0.sent;
        result = undefined;
        context$1$0.prev = 7;

        result = JSON.parse(data);
        context$1$0.next = 14;
        break;

      case 11:
        context$1$0.prev = 11;
        context$1$0.t0 = context$1$0['catch'](7);
        throw new Error("Bad response from elementLocation");

      case 14:
        if (!(result.status === _utils.youiEngineDriverReturnValues.WEBDRIVER_UNKNOWN_COMMAND)) {
          context$1$0.next = 18;
          break;
        }

        throw new _appiumBaseDriver.errors.UnknownCommandError();

      case 18:
        if (!(result.status === _utils.youiEngineDriverReturnValues.WEBDRIVER_NO_SUCH_ELEMENT)) {
          context$1$0.next = 20;
          break;
        }

        throw new _appiumBaseDriver.errors.NoSuchElementError();

      case 20:
        return context$1$0.abrupt('return', result.value);

      case 21:
      case 'end':
        return context$1$0.stop();
    }
  }, null, this, [[7, 11]]);
};

commands.getLocationInView = function callee$0$0(elementId) {
  return _regeneratorRuntime.async(function callee$0$0$(context$1$0) {
    while (1) switch (context$1$0.prev = context$1$0.next) {
      case 0:
        context$1$0.next = 2;
        return _regeneratorRuntime.awrap(this.getLocation(elementId));

      case 2:
        return context$1$0.abrupt('return', context$1$0.sent);

      case 3:
      case 'end':
        return context$1$0.stop();
    }
  }, null, this);
};

commands.getSize = function callee$0$0(el) {
  var commandObject, commandJSON, data, result;
  return _regeneratorRuntime.async(function callee$0$0$(context$1$0) {
    while (1) switch (context$1$0.prev = context$1$0.next) {
      case 0:

        el = (0, _utils.unwrapEl)(el);

        commandObject = {
          name: 'elementSize',
          args: ['' + el]
        };
        commandJSON = JSON.stringify(commandObject);
        context$1$0.next = 5;
        return _regeneratorRuntime.awrap(this.executeSocketCommand(commandJSON));

      case 5:
        data = context$1$0.sent;
        result = undefined;
        context$1$0.prev = 7;

        result = JSON.parse(data);
        context$1$0.next = 14;
        break;

      case 11:
        context$1$0.prev = 11;
        context$1$0.t0 = context$1$0['catch'](7);
        throw new Error("Bad response from getSize");

      case 14:
        if (!(result.status === _utils.youiEngineDriverReturnValues.WEBDRIVER_UNKNOWN_COMMAND)) {
          context$1$0.next = 18;
          break;
        }

        throw new _appiumBaseDriver.errors.UnknownCommandError();

      case 18:
        if (!(result.status === _utils.youiEngineDriverReturnValues.WEBDRIVER_NO_SUCH_ELEMENT)) {
          context$1$0.next = 20;
          break;
        }

        throw new _appiumBaseDriver.errors.NoSuchElementError();

      case 20:
        return context$1$0.abrupt('return', result.value);

      case 21:
      case 'end':
        return context$1$0.stop();
    }
  }, null, this, [[7, 11]]);
};

exports['default'] = commands;
module.exports = exports['default'];

// get status returned

// get status returned

// get status returned

// get status returned and handle errors returned from server

// get status returned and handle errors returned from server

// get status returned and handle errors returned from server

// get status returned and handle errors returned from server

// get status returned and handle errors returned from server
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImxpYi9jb21tYW5kcy9lbGVtZW50LmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7O2dDQUF1QixvQkFBb0I7O3FCQUNZLFVBQVU7OzZCQUM1QyxnQkFBZ0I7O0FBRXJDLElBQUksUUFBUSxHQUFHLEVBQUUsQ0FBQzs7QUFFbEIsUUFBUSxDQUFDLFlBQVksR0FBRyxvQkFBZ0IsU0FBUyxFQUFFLEVBQUU7TUFHL0MsYUFBYSxFQUliLFdBQVcsRUFFWCxJQUFJLEVBRUosTUFBTTs7OztBQVZWLFVBQUUsR0FBRyxxQkFBUyxFQUFFLENBQUMsQ0FBQzs7QUFFZCxxQkFBYSxHQUFHO0FBQ2xCLGNBQUksRUFBRSxjQUFjO0FBQ3BCLGNBQUksRUFBRSxNQUFJLEVBQUUsT0FBTyxTQUFTLENBQUc7U0FDaEM7QUFDRyxtQkFBVyxHQUFHLElBQUksQ0FBQyxTQUFTLENBQUMsYUFBYSxDQUFDOzt5Q0FFOUIsSUFBSSxDQUFDLG9CQUFvQixDQUFDLFdBQVcsQ0FBQzs7O0FBQW5ELFlBQUk7QUFFSixjQUFNOzs7QUFFUixjQUFNLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsQ0FBQzs7Ozs7OztjQUVwQixJQUFJLEtBQUssQ0FBQyxnQ0FBZ0MsQ0FBQzs7O2NBSS9DLE1BQU0sQ0FBQyxNQUFNLEtBQUssb0NBQTZCLHVCQUF1QixDQUFBOzs7OztjQUNsRSxJQUFJLHlCQUFPLDBCQUEwQixFQUFFOzs7NENBRXhDLE1BQU0sQ0FBQyxLQUFLOzs7Ozs7O0NBQ3BCLENBQUM7O0FBRUYsUUFBUSxDQUFDLFFBQVEsR0FBRyxvQkFBZ0IsS0FBSyxFQUFFLEVBQUU7TUFldkMsYUFBYSxFQUliLFdBQVcsRUFFWCxJQUFJLEVBRUosTUFBTTs7OztBQXRCVixVQUFFLEdBQUcscUJBQVMsRUFBRSxDQUFDLENBQUM7Ozt5Q0FFWixJQUFJLENBQUMsS0FBSyxDQUFDLEVBQUUsQ0FBQzs7OztBQUVwQixZQUFJLEtBQUssWUFBWSxLQUFLLEVBQUU7QUFDMUIsZUFB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QyxvQkFBb0IsQ0FBQyxXQUFXLENBQUM7OztBQUFuRCxZQUFJO0FBRUosY0FBTTs7O0FBRVIsY0FBTSxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLENBQUM7Ozs7Ozs7Y0FFcEIsSUFBSSxLQUFLLENBQUMsMkJBQTJCLENBQUM7OztjQUkxQyxNQUFNLENBQUMsTUFBTSxLQUFLLG9DQUE2Qix5QkFBeUIsQ0FBQTs7Ozs7Y0FDcEUsSUFBSSx5QkFBTyxtQkFBbUIsRUFBRTs7O2NBQzdCLE1BQU0sQ0FBQyxNQUFNLEtBQUssb0NBQTZCLHlCQUF5QixDQUFBOzs7OztjQUMzRSxJQUFJLHlCQUFPLGtCQUFrQixFQUFFOzs7NENBR2hDLE1BQU0sQ0FBQyxLQUFLOzs7Ozs7O0NBQ3BCLENBQUM7O3FCQUVhLFFBQVEiLCJmaWxlIjoibGliL2NvbW1hbmRzL2VsZW1lbnQuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBlcnJvcnMgfSBmcm9tICdhcHBpdW0tYmFzZS1kcml2ZXInO1xuaW1wb3J0IHsgdW53cmFwRWwsIHlvdWlFbmdpbmVEcml2ZXJSZXR1cm5WYWx1ZXMgfSBmcm9tICcuLi91dGlscyc7XG5pbXBvcnQgeyB1dGlsIH0gZnJvbSAnYXBwaXVtLXN1cHBvcnQnO1xuXG5sZXQgY29tbWFuZHMgPSB7fTtcblxuY29tbWFuZHMuZ2V0QXR0cmlidXRlID0gYXN5bmMgZnVuY3Rpb24gKGF0dHJpYnV0ZSwgZWwpIHtcbiAgZWwgPSB1bndyYXBFbChlbCk7XG5cbiAgdmFyIGNvbW1hbmRPYmplY3QgPSB7XG4gICAgbmFtZTogJ2dldEF0dHJpYnV0ZScsXG4gICAgYXJnczogW2Ake2VsfWAsIGAke2F0dHJpYnV0ZX1gXVxuICB9O1xuICB2YXIgY29tbWFuZEpTT04gPSBKU09OLnN0cmluZ2lmeShjb21tYW5kT2JqZWN0KTtcblxuICBsZXQgZGF0YSA9IGF3YWl0IHRoaXMuZXhlY3V0ZVNvY2tldENvbW1hbmQoY29tbWFuZEpTT04pO1xuXG4gIGxldCByZXN1bHQ7XG4gIHRyeSB7XG4gICAgcmVzdWx0ID0gSlNPTi5wYXJzZShkYXRhKTtcbiAgfSBjYXRjaCAoZSkge1xuICAgIHRocm93IG5ldyBFcnJvcihcIkJhZCByZXNwb25zZSBmcm9tIGdldEF0dHJpYnV0ZVwiKTtcbiAgfVxuXG4gIC8vIGdldCBzdGF0dXMgcmV0dXJuZWRcbiAgaWYgKHJlc3VsdC5zdGF0dXMgPT09IHlvdWlFbmdpbmVEcml2ZXJSZXR1cm5WYWx1ZXMuV0VCRFJJVkVSX1NUQUxFX0VMRU1FTlQpXG4gICAgdGhyb3cgbmV3IGVycm9ycy5TdGFsZUVsZW1lbnRSZWZlcmVuY2VFcnJvcigpO1xuXG4gIHJldHVybiByZXN1bHQudmFsdWU7XG59O1xuXG5jb21tYW5kcy5zZXRWYWx1ZSA9IGFzeW5jIGZ1bmN0aW9uICh2YWx1ZSwgZWwpIHtcbiAgZWwgPSB1bndyYXBFbChlbCk7XG4gIC8vRmlyc3QsIGNsaWNrIHRvIHB1dCB0aGUgZWxlbWVudCBpbiBjb250ZXh0XG4gIGF3YWl0IHRoaXMuY2xpY2soZWwpO1xuXG4gIGlmICh2YWx1ZSBpbnN0YW5jZW9mIEFycmF5KSB7XG4gICAgdmFsdWUgPSB2YWx1ZS5qb2luKFwiXCIpO1xuICB9XG4gIGlmICh0eXBlb2YgdmFsdWUgIT09ICdzdHJpbmcnKSB7XG4gICAgdmFsdWUgPSBgJHt2YWx1ZX1gO1xuICB9XG4gIHZhbHVlID0gdXRpbC5lc2NhcGVTcGVjaWFsQ2hhcnModmFsdWUsIFwiJ1wiKTtcbiAgLy8gZGUtZXNjYXBlIFxcbiBzbyBpdCBjYW4gYmUgdXNlZCBzcGVjaWFsbHlcbiAgdmFsdWUgPSB2YWx1ZS5yZXBsYWNlKC9cXFxcXFxcXG4vZywgXCJcXFxcblwiKTtcblxuICB2YXIgY29tbWFuZE9iamVjdCA9IHtcbiAgICBuYW1lOiAnc2VuZGtleXMnLFxuICAgIGFyZ3M6IFtgJHtlbH1gLCBgJHt2YWx1ZX1gXVxuICB9O1xuICB2YXIgY29tbWFuZEpTT04gPSBKU09OLnN0cmluZ2lmeShjb21tYW5kT2JqZWN0KTtcblxuICBsZXQgZGF0YSA9IGF3YWl0IHRoaXMuZXhlY3V0ZVNvY2tldENvbW1hbmQoY29tbWFuZEpTT04pO1xuXG4gIGxldCByZXN1bHQ7XG4gIHRyeSB7XG4gICAgcmVzdWx0ID0gSlNPTi5wYXJzZShkYXRhKTtcbiAgfSBjYXRjaCAoZSkge1xuICAgIHRocm93IG5ldyBFcnJvcihcIkJhZCByZXNwb25zZSBmcm9tIHNldFZhbHVlXCIpO1xuICB9XG5cbiAgLy8gZ2V0IHN0YXR1cyByZXR1cm5lZFxuICBpZiAocmVzdWx0LnN0YXR1cyA9PT0geW91aUVuZ2luZURyaXZlclJldHVyblZhbHVlcy5XRUJEUklWRVJfU1RBTEVfRUxFTUVOVClcbiAgICB0aHJvdyBuZXcgZXJyb3JzLlN0YWxlRWxlbWVudFJlZmVyZW5jZUVycm9yKCk7XG5cbiAgcmV0dXJuIHJlc3VsdC52YWx1ZTtcblxufTtcblxuY29tbWFuZHMuZ2V0VGV4dCA9IGFzeW5jIGZ1bmN0aW9uIChlbCkge1xuICBlbCA9IHVud3JhcEVsKGVsKTtcblxuICB2YXIgY29tbWFuZE9iamVjdCA9IHtcbiAgICBuYW1lOiAnZ2V0VGV4dCcsXG4gICAgYXJnczogW2Ake2VsfWBdXG4gIH07XG4gIHZhciBjb21tYW5kSlNPTiA9IEpTT04uc3RyaW5naWZ5KGNvbW1hbmRPYmplY3QpO1xuXG4gIGxldCBkYXRhID0gYXdhaXQgdGhpcy5leGVjdXRlU29ja2V0Q29tbWFuZChjb21tYW5kSlNPTik7XG5cbiAgbGV0IHJlc3VsdDtcbiAgdHJ5IHtcbiAgICByZXN1bHQgPSBKU09OLnBhcnNlKGRhdGEpO1xuICB9IGNhdGNoIChlKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKFwiQmFkIHJlc3BvbnNlIGZyb20gZ2V0VGV4dFwiKTtcbiAgfVxuXG4gIC8vIGdldCBzdGF0dXMgcmV0dXJuZWRcbiAgaWYgKHJlc3VsdC5zdGF0dXMgPT09IHlvdWlFbmdpbmVEcml2ZXJSZXR1cm5WYWx1ZXMuV0VCRFJJVkVSX1NUQUxFX0VMRU1FTlQpXG4gICAgdGhyb3cgbmV3IGVycm9ycy5TdGFsZUVsZW1lbnRSZWZlcmVuY2VFcnJvcigpO1xuXG4gIHJldHVybiByZXN1bHQudmFsdWU7XG5cbn07XG5cbmNvbW1hbmRzLmVsZW1lbnRFbmFibGVkID0gYXN5bmMgZnVuY3Rpb24gKGVsKSB7XG5cbiAgZWwgPSB1bndyYXBFbChlbCk7XG5cbiAgdmFyIGNvbW1hbmRPYmplY3QgPSB7XG4gICAgbmFtZTogJ2VsZW1lbnRFbmFibGVkJyxcbiAgICBhcmdzOiBbYCR7ZWx9YF1cbiAgfTtcbiAgdmFyIGNvbW1hbmRKU09OID0gSlNPTi5zdHJpbmdpZnkoY29tbWFuZE9iamVjdCk7XG5cbiAgbGV0IGRhdGEgPSBhd2FpdCB0aGlzLmV4ZWN1dGVTb2NrZXRDb21tYW5kKGNvbW1hbmRKU09OKTtcblxuICBsZXQgcmVzdWx0O1xuICB0cnkge1xuICAgIHJlc3VsdCA9IEpTT04ucGFyc2UoZGF0YSk7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoXCJCYWQgcmVzcG9uc2UgZnJvbSBlbGVtZW50RW5hYmxlZFwiKTtcbiAgfVxuXG4gIC8vIGdldCBzdGF0dXMgcmV0dXJuZWQgYW5kIGhhbmRsZSBlcnJvcnMgcmV0dXJuZWQgZnJvbSBzZXJ2ZXJcbiAgaWYgKHJlc3VsdC5zdGF0dXMgPT09IHlvdWlFbmdpbmVEcml2ZXJSZXR1cm5WYWx1ZXMuV0VCRFJJVkVSX1VOS05PV05fQ09NTUFORCkge1xuICAgIHRocm93IG5ldyBlcnJvcnMuVW5rbm93bkNvbW1hbmRFcnJvcigpO1xuICB9IGVsc2UgaWYgKHJlc3VsdC5zdGF0dXMgPT09IHlvdWlFbmdpbmVEcml2ZXJSZXR1cm5WYWx1ZXMuV0VCRFJJVkVSX05PX1NVQ0hfRUxFTUVOVCkge1xuICAgIHRocm93IG5ldyBlcnJvcnMuTm9TdWNoRWxlbWVudEVycm9yKCk7XG4gIH1cblxuICByZXR1cm4gcmVzdWx0LnZhbHVlO1xufTtcblxuY29tbWFuZHMuZWxlbWVudFNlbGVjdGVkID0gYXN5bmMgZnVuY3Rpb24gKGVsKSB7XG5cbiAgZWwgPSB1bndyYXBFbChlbCk7XG5cbiAgdmFyIGNvbW1hbmRPYmplY3QgPSB7XG4gICAgbmFtZTogJ2VsZW1lbnRTZWxlY3RlZCcsXG4gICAgYXJnczogW2Ake2VsfWBdXG4gIH07XG4gIHZhciBjb21tYW5kSlNPTiA9IEpTT04uc3RyaW5naWZ5KGNvbW1hbmRPYmplY3QpO1xuXG4gIGxldCBkYXRhID0gYXdhaXQgdGhpcy5leGVjdXRlU29ja2V0Q29tbWFuZChjb21tYW5kSlNPTik7XG5cbiAgbGV0IHJlc3VsdDtcbiAgdHJ5IHtcbiAgICByZXN1bHQgPSBKU09OLnBhcnNlKGRhdGEpO1xuICB9IGNhdGNoIChlKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKFwiQmFkIHJlc3BvbnNlIGZyb20gZWxlbWVudFNlbGVjdGVkXCIpO1xuICB9XG5cbiAgLy8gZ2V0IHN0YXR1cyByZXR1cm5lZCBhbmQgaGFuZGxlIGVycm9ycyByZXR1cm5lZCBmcm9tIHNlcnZlclxuICBpZiAocmVzdWx0LnN0YXR1cyA9PT0geW91aUVuZ2luZURyaXZlclJldHVyblZhbHVlcy5XRUJEUklWRVJfRUxFTUVOVF9JU19OT1RfU0VMRUNUQUJMRSkge1xuICAgIHRocm93IG5ldyBlcnJvcnMuRWxlbWVudElzTm90U2VsZWN0YWJsZUVycm9yKCk7XG4gIH0gZWxzZSBpZiAocmVzdWx0LnN0YXR1cyA9PT0geW91aUVuZ2luZURyaXZlclJldHVyblZhbHVlcy5XRUJEUklWRVJfTk9fU1VDSF9FTEVNRU5UKSB7XG4gICAgdGhyb3cgbmV3IGVycm9ycy5Ob1N1Y2hFbGVtZW50RXJyb3IoKTtcbiAgfVxuXG4gIHJldHVybiByZXN1bHQudmFsdWU7XG59O1xuXG5jb21tYW5kcy5lbGVtZW50RGlzcGxheWVkID0gYXN5bmMgZnVuY3Rpb24gKGVsKSB7XG5cbiAgZWwgPSB1bndyYXBFbChlbCk7XG5cbiAgdmFyIGNvbW1hbmRPYmplY3QgPSB7XG4gICAgbmFtZTogJ2VsZW1lbnREaXNwbGF5ZWQnLFxuICAgIGFyZ3M6IFtgJHtlbH1gXVxuICB9O1xuICB2YXIgY29tbWFuZEpTT04gPSBKU09OLnN0cmluZ2lmeShjb21tYW5kT2JqZWN0KTtcblxuICBsZXQgZGF0YSA9IGF3YWl0IHRoaXMuZXhlY3V0ZVNvY2tldENvbW1hbmQoY29tbWFuZEpTT04pO1xuXG4gIGxldCByZXN1bHQ7XG4gIHRyeSB7XG4gICAgcmVzdWx0ID0gSlNPTi5wYXJzZShkYXRhKTtcbiAgfSBjYXRjaCAoZSkge1xuICAgIHRocm93IG5ldyBFcnJvcihcIkJhZCByZXNwb25zZSBmcm9tIGVsZW1lbnREaXNwbGF5ZWRcIik7XG4gIH1cblxuICAvLyBnZXQgc3RhdHVzIHJldHVybmVkIGFuZCBoYW5kbGUgZXJyb3JzIHJldHVybmVkIGZyb20gc2VydmVyXG4gIGlmIChyZXN1bHQuc3RhdHVzID09PSB5b3VpRW5naW5lRHJpdmVyUmV0dXJuVmFsdWVzLldFQkRSSVZFUl9VTktOT1dOX0NPTU1BTkQpIHtcbiAgICB0aHJvdyBuZXcgZXJyb3JzLlVua25vd25Db21tYW5kRXJyb3IoKTtcbiAgfSBlbHNlIGlmIChyZXN1bHQuc3RhdHVzID09PSB5b3VpRW5naW5lRHJpdmVyUmV0dXJuVmFsdWVzLldFQkRSSVZFUl9OT19TVUNIX0VMRU1FTlQpIHtcbiAgICB0aHJvdyBuZXcgZXJyb3JzLk5vU3VjaEVsZW1lbnRFcnJvcigpO1xuICB9XG5cbiAgcmV0dXJuIHJlc3VsdC52YWx1ZTtcbn07XG5cbmNvbW1hbmRzLmNsZWFyID0gYXN5bmMgZnVuY3Rpb24gKGVsKSB7XG4gIGVsID0gdW53cmFwRWwoZWwpO1xuXG4gIHZhciBjb21tYW5kT2JqZWN0ID0ge1xuICAgIG5hbWU6ICdjbGVhcicsXG4gICAgYXJnczogW2Ake2VsfWBdXG4gIH07XG5cbiAgdmFyIGNvbW1hbmRKU09OID0gSlNPTi5zdHJpbmdpZnkoY29tbWFuZE9iamVjdCk7XG5cbiAgbGV0IGRhdGEgPSBhd2FpdCB0aGlzLmV4ZWN1dGVTb2NrZXRDb21tYW5kKGNvbW1hbmRKU09OKTtcblxuICBsZXQgcmVzdWx0O1xuICB0cnkge1xuICAgIHJlc3VsdCA9IEpTT04ucGFyc2UoZGF0YSk7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoXCJCYWQgcmVzcG9uc2UgZnJvbSBjbGVhclwiKTtcbiAgfVxuXG4gIGlmIChyZXN1bHQuc3RhdHVzID09PSB5b3VpRW5naW5lRHJpdmVyUmV0dXJuVmFsdWVzLldFQkRSSVZFUl9OT19TVUNIX0VMRU1FTlQpIHtcbiAgICB0aHJvdyBuZXcgZXJyb3JzLk5vU3VjaEVsZW1lbnRFcnJvcigpO1xuICB9IGVsc2UgaWYgKHJlc3VsdC5zdGF0dXMgPT09IHlvdWlFbmdpbmVEcml2ZXJSZXR1cm5WYWx1ZXMuV0VCRFJJVkVSX1VOS05PV05fQ09NTUFORCkge1xuICAgIHRocm93IG5ldyBlcnJvcnMuVW5rbm93bkNvbW1hbmRFcnJvcigpO1xuICB9XG5cbiAgcmV0dXJuIHJlc3VsdC52YWx1ZTtcbn07XG5cbmNvbW1hbmRzLmdldExvY2F0aW9uID0gYXN5bmMgZnVuY3Rpb24gKGVsKSB7XG5cbiAgZWwgPSB1bndyYXBFbChlbCk7XG5cbiAgdmFyIGNvbW1hbmRPYmplY3QgPSB7XG4gICAgbmFtZTogJ2VsZW1lbnRMb2NhdGlvbicsXG4gICAgYXJnczogW2Ake2VsfWBdXG4gIH07XG4gIHZhciBjb21tYW5kSlNPTiA9IEpTT04uc3RyaW5naWZ5KGNvbW1hbmRPYmplY3QpO1xuXG4gIGxldCBkYXRhID0gYXdhaXQgdGhpcy5leGVjdXRlU29ja2V0Q29tbWFuZChjb21tYW5kSlNPTik7XG5cbiAgbGV0IHJlc3VsdDtcbiAgdHJ5IHtcbiAgICByZXN1bHQgPSBKU09OLnBhcnNlKGRhdGEpO1xuICB9IGNhdGNoIChlKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKFwiQmFkIHJlc3BvbnNlIGZyb20gZWxlbWVudExvY2F0aW9uXCIpO1xuICB9XG5cbiAgLy8gZ2V0IHN0YXR1cyByZXR1cm5lZCBhbmQgaGFuZGxlIGVycm9ycyByZXR1cm5lZCBmcm9tIHNlcnZlclxuICBpZiAocmVzdWx0LnN0YXR1cyA9PT0geW91aUVuZ2luZURyaXZlclJldHVyblZhbHVlcy5XRUJEUklWRVJfVU5LTk9XTl9DT01NQU5EKSB7XG4gICAgdGhyb3cgbmV3IGVycm9ycy5Vbmtub3duQ29tbWFuZEVycm9yKCk7XG4gIH0gZWxzZSBpZiAocmVzdWx0LnN0YXR1cyA9PT0geW91aUVuZ2luZURyaXZlclJldHVyblZhbHVlcy5XRUJEUklWRVJfTk9fU1VDSF9FTEVNRU5UKSB7XG4gICAgdGhyb3cgbmV3IGVycm9ycy5Ob1N1Y2hFbGVtZW50RXJyb3IoKTtcbiAgfVxuXG4gIHJldHVybiByZXN1bHQudmFsdWU7XG59O1xuXG5jb21tYW5kcy5nZXRMb2NhdGlvbkluVmlldyA9IGFzeW5jIGZ1bmN0aW9uIChlbGVtZW50SWQpIHtcbiAgcmV0dXJuIGF3YWl0IHRoaXMuZ2V0TG9jYXRpb24oZWxlbWVudElkKTtcbn07XG5cbmNvbW1hbmRzLmdldFNpemUgPSBhc3luYyBmdW5jdGlvbiAoZWwpIHtcblxuICBlbCA9IHVud3JhcEVsKGVsKTtcblxuICB2YXIgY29tbWFuZE9iamVjdCA9IHtcbiAgICBuYW1lOiAnZWxlbWVudFNpemUnLFxuICAgIGFyZ3M6IFtgJHtlbH1gXVxuICB9O1xuICB2YXIgY29tbWFuZEpTT04gPSBKU09OLnN0cmluZ2lmeShjb21tYW5kT2JqZWN0KTtcblxuICBsZXQgZGF0YSA9IGF3YWl0IHRoaXMuZXhlY3V0ZVNvY2tldENvbW1hbmQoY29tbWFuZEpTT04pO1xuXG4gIGxldCByZXN1bHQ7XG4gIHRyeSB7XG4gICAgcmVzdWx0ID0gSlNPTi5wYXJzZShkYXRhKTtcbiAgfSBjYXRjaCAoZSkge1xuICAgIHRocm93IG5ldyBFcnJvcihcIkJhZCByZXNwb25zZSBmcm9tIGdldFNpemVcIik7XG4gIH1cblxuICAvLyBnZXQgc3RhdHVzIHJldHVybmVkIGFuZCBoYW5kbGUgZXJyb3JzIHJldHVybmVkIGZyb20gc2VydmVyXG4gIGlmIChyZXN1bHQuc3RhdHVzID09PSB5b3VpRW5naW5lRHJpdmVyUmV0dXJuVmFsdWVzLldFQkRSSVZFUl9VTktOT1dOX0NPTU1BTkQpIHtcbiAgICB0aHJvdyBuZXcgZXJyb3JzLlVua25vd25Db21tYW5kRXJyb3IoKTtcbiAgfSBlbHNlIGlmIChyZXN1bHQuc3RhdHVzID09PSB5b3VpRW5naW5lRHJpdmVyUmV0dXJuVmFsdWVzLldFQkRSSVZFUl9OT19TVUNIX0VMRU1FTlQpIHtcbiAgICB0aHJvdyBuZXcgZXJyb3JzLk5vU3VjaEVsZW1lbnRFcnJvcigpO1xuICB9XG5cbiAgcmV0dXJuIHJlc3VsdC52YWx1ZTtcbn07XG5cbmV4cG9ydCBkZWZhdWx0IGNvbW1hbmRzO1xuIl0sInNvdXJjZVJvb3QiOiIuLi8uLi8uLiJ9
